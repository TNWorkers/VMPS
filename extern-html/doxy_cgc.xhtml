<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>CGC for DMRG</title>
<!--Generated on Sun Feb 10 14:09:06 2019 by LaTeXML (version 0.8.3) http://dlmf.nist.gov/LaTeXML/.-->

<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"/>
<link rel="stylesheet" href="LaTeXML.css" type="text/css"/>
<link rel="stylesheet" href="ltx-article.css" type="text/css"/>
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<div class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">CGC for DMRG</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">MP
</span></span></div>

<div class="ltx_TOC ltx_toc_toc"><h6>Contents</h6>
<ul class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S1" title="1 Definition and notation for CGC ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Definition and notation for CGC</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S2" title="2 ⁢ 6 j , ⁢ 9 j and recoupling symbols ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span><math xmlns="http://www.w3.org/1998/Math/MathML" class="ltx_Math" alttext="6j" display="inline"><mrow><mn>6</mn><mo>⁢</mo><mi>j</mi></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" class="ltx_Math" alttext="9j" display="inline"><mrow><mn>9</mn><mo>⁢</mo><mi>j</mi></mrow></math> and recoupling symbols</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S3" title="3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Wigner-Eckart</span></a>
<ul class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S3.SS1" title="3.1 Product of tensor operators ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Product of tensor operators</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S3.SS2" title="3.2 Adjoint of tensor operators ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Adjoint of tensor operators</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S3.SS3" title="3.3 Spin operator ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Spin operator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S3.SS4" title="3.4 Fermionic operators ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Fermionic operators</span></a></li>
</ul></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S4" title="4 Convention for MPS, MPO and environments ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Convention for MPS, MPO and environments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S5" title="5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Algorithms</span></a>
<ul class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S5.SS1" title="5.1 Sweep and reshape ‣ 5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Sweep and reshape</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S5.SS2" title="5.2 Update L ‣ 5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Update <math xmlns="http://www.w3.org/1998/Math/MathML" class="ltx_Math" alttext="L" display="inline"><mi>L</mi></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S5.SS3" title="5.3 Update R ‣ 5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Update <math xmlns="http://www.w3.org/1998/Math/MathML" class="ltx_Math" alttext="R" display="inline"><mi>R</mi></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S5.SS4" title="5.4 Apply H ⁢ e f f ‣ 5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Apply <math xmlns="http://www.w3.org/1998/Math/MathML" class="ltx_Math" alttext="H_{eff}" display="inline"><msub><mi>H</mi><mrow><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>f</mi></mrow></msub></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S5.SS5" title="5.5 MPS product ‣ 5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>MPS product</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S5.SS6" title="5.6 MPO product ‣ 5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6 </span>MPO product</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S5.SS7" title="5.7 MPO times MPS ‣ 5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.7 </span>MPO times MPS</span></a></li>
</ul></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S6" title="6 Todo ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Todo</span></a></li>
</ul></div>
<div id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">1 </span>Definition and notation for CGC</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">Clebsch-Gordon coefficients describe the coupling of irreps of a group.
For <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m1" class="ltx_Math" alttext="SU(2)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mrow></math> the irreps are labeled by the spin quantum number <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m2" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math>, for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m3" class="ltx_Math" alttext="U(1)" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math>
the irreps are labeled by an integer <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m4" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> for the amount of particles for example.
The CGC depend on three irreps: the two ordered (first <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m5" class="ltx_Math" alttext="j_{1}" display="inline"><msub><mi>j</mi><mn>1</mn></msub></math> and second <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m6" class="ltx_Math" alttext="j_{2}" display="inline"><msub><mi>j</mi><mn>2</mn></msub></math>) irreps to couple and the total irrep <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m7" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math>.</p>
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E1.m1" class="ltx_Math" alttext="C^{j_{1},j_{2}\rightarrow j}_{{m_{1},m_{2}\rightarrow m}}" display="block"><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>m</mi></mrow><mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>j</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td></tr>
</table>
<p class="ltx_p">For <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m8" class="ltx_Math" alttext="U(1)" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math>, this simply requires <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m9" class="ltx_Math" alttext="n_{1}+n_{2}=n" display="inline"><mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><mo>=</mo><mi>n</mi></mrow></math>. Hence the CGc for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m10" class="ltx_Math" alttext="U(1)" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> are symmetric in <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m11" class="ltx_Math" alttext="n_{1}" display="inline"><msub><mi>n</mi><mn>1</mn></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m12" class="ltx_Math" alttext="n_{2}" display="inline"><msub><mi>n</mi><mn>2</mn></msub></math>
but <span class="ltx_text ltx_emph ltx_font_italic">not</span> for other permutations.
For <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m13" class="ltx_Math" alttext="SU(2)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mrow></math> the symmetry relations can be found on wikipedia.</p>
</div>
</div>
<div id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">2 </span><math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.m1" class="ltx_Math" alttext="6j" display="inline"><mrow><mn>6</mn><mo>⁢</mo><mi>j</mi></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.m2" class="ltx_Math" alttext="9j" display="inline"><mrow><mn>9</mn><mo>⁢</mo><mi>j</mi></mrow></math> and recoupling symbols</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p">CGC can be multiplied to give recoupling coefficients which are related to
Wigner <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.m1" class="ltx_Math" alttext="3nj" display="inline"><mrow><mn>3</mn><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>j</mi></mrow></math>-symbols. The <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.m2" class="ltx_Math" alttext="6j" display="inline"><mrow><mn>6</mn><mo>⁢</mo><mi>j</mi></mrow></math>-symbol is related to the recoupling of three irreps:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E2.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\begin{bmatrix}j_{1}&amp;j_{2}&amp;j_{12}\\&#10;j_{3}&amp;j&amp;j_{23}\end{bmatrix}\delta_{jj^{\prime}}&amp;\displaystyle=\sum_{m_{i},m_{%&#10;ik}}\\&#10;&amp;\displaystyle C^{j_{1},j_{2}\rightarrow j_{12}}_{m_{1},m_{2}\rightarrow m_{12%&#10;}}C^{j_{2},j_{3}\rightarrow j_{23}}_{m_{2},m_{3}\rightarrow m_{23}}\\&#10;&amp;\displaystyle C^{j_{1},j_{23}\rightarrow j^{\prime}}_{m_{1},m_{23}\rightarrow&#10;m%&#10;^{\prime}}C^{j_{12}j_{3}\rightarrow j}_{m_{12}m_{3}\rightarrow m}\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd><mtd columnalign="center"><mi>j</mi></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>23</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><msub><mi>δ</mi><mrow><mi>j</mi><mo>⁢</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msub></mrow></mtd><mtd columnalign="left"><mrow><mi/><mo>=</mo><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>⁢</mo><mi>k</mi></mrow></msub></mrow></munder></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>→</mo><msub><mi>m</mi><mn>12</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>j</mi><mn>2</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>12</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>2</mn></msub><mo>,</mo><msub><mi>m</mi><mn>3</mn></msub></mrow><mo>→</mo><msub><mi>m</mi><mn>23</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>,</mo><msub><mi>j</mi><mn>3</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>23</mn></msub></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>23</mn></msub></mrow><mo>→</mo><msup><mi>m</mi><mo>′</mo></msup></mrow><mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>j</mi><mn>23</mn></msub></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>12</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>3</mn></msub></mrow><mo>→</mo><mi>m</mi></mrow><mrow><mrow><msub><mi>j</mi><mn>12</mn></msub><mo>⁢</mo><msub><mi>j</mi><mn>3</mn></msub></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td></tr>
</table>
<p class="ltx_p">In the first column the CGC share the first irrep and in the second column they share the second irrep.
The second and third irrep from the CGC in the first column and first row build the first irrep from the CGC
in the second column.
The second and thir irreps from the CGC from the first column and second row build the third irreps
of the CGC in the second column.
It is worthwhile to have this visual structure to identify if the sum over four CGC forms a recoupling coeff or not.
The <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.m3" class="ltx_Math" alttext="[\dots]" display="inline"><mrow><mo stretchy="false">[</mo><mi mathvariant="normal">…</mi><mo stretchy="false">]</mo></mrow></math>-symbol is the recoupling coeff which is related to the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.m4" class="ltx_Math" alttext="6j" display="inline"><mrow><mn>6</mn><mo>⁢</mo><mi>j</mi></mrow></math>-symbol (curly brackets):</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E3.m1" class="ltx_Math" alttext="\begin{Bmatrix}j_{1}&amp;j_{2}&amp;j_{12}\\&#10;j_{3}&amp;j&amp;j_{23}\end{Bmatrix}=(-1)^{j_{1}+j_{2}+j_{3}+j}\frac{1}{\sqrt{(2j_{12}+%&#10;1)(2j_{23}+1)}}\begin{bmatrix}j_{1}&amp;j_{2}&amp;j_{12}\\&#10;j_{3}&amp;j&amp;j_{23}\end{bmatrix}" display="block"><mrow><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd><mtd columnalign="center"><mi>j</mi></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>23</mn></msub></mtd></mtr></mtable><mo>}</mo></mrow><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>+</mo><msub><mi>j</mi><mn>2</mn></msub><mo>+</mo><msub><mi>j</mi><mn>3</mn></msub><mo>+</mo><mi>j</mi></mrow></msup><mo>⁢</mo><mfrac><mn>1</mn><msqrt><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>12</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>23</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msqrt></mfrac><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd><mtd columnalign="center"><mi>j</mi></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>23</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td></tr>
</table>
<p class="ltx_p">The same quantities exist for four irreps. The recoupling coeff is:</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E4.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\begin{bmatrix}j_{1}&amp;j_{2}&amp;j_{12}\\&#10;j_{3}&amp;j_{4}&amp;j_{34}\\&#10;j_{13}&amp;j_{24}&amp;j\end{bmatrix}=&amp;\displaystyle\sum_{m_{i},m_{ik}}\\&#10;&amp;\displaystyle C^{j_{1},j_{2}\rightarrow j_{12}}_{m_{1},m_{2}\rightarrow m_{12%&#10;}}C^{j_{3},j_{4}\rightarrow j_{34}}_{m_{3},m_{4}\rightarrow m_{34}}C^{j_{12},j%&#10;_{34}\rightarrow j}_{m_{12},m_{34}\rightarrow m}\\&#10;&amp;\displaystyle C^{j_{1},j_{3}\rightarrow j_{13}}_{m_{1},m_{3}\rightarrow m_{13%&#10;}}C^{j_{2},j_{4}\rightarrow j_{24}}_{m_{2},m_{4}\rightarrow m_{24}}C^{j_{13},j%&#10;_{24}\rightarrow j}_{m_{13},m_{24}\rightarrow m}\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>4</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>34</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>13</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>24</mn></msub></mtd><mtd columnalign="center"><mi>j</mi></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mi/></mrow></mtd><mtd columnalign="left"><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>⁢</mo><mi>k</mi></mrow></msub></mrow></munder></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>→</mo><msub><mi>m</mi><mn>12</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>j</mi><mn>2</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>12</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>3</mn></msub><mo>,</mo><msub><mi>m</mi><mn>4</mn></msub></mrow><mo>→</mo><msub><mi>m</mi><mn>34</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>,</mo><msub><mi>j</mi><mn>4</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>34</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>12</mn></msub><mo>,</mo><msub><mi>m</mi><mn>34</mn></msub></mrow><mo>→</mo><mi>m</mi></mrow><mrow><mrow><msub><mi>j</mi><mn>12</mn></msub><mo>,</mo><msub><mi>j</mi><mn>34</mn></msub></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>3</mn></msub></mrow><mo>→</mo><msub><mi>m</mi><mn>13</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>j</mi><mn>3</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>13</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>2</mn></msub><mo>,</mo><msub><mi>m</mi><mn>4</mn></msub></mrow><mo>→</mo><msub><mi>m</mi><mn>24</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>,</mo><msub><mi>j</mi><mn>4</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>24</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>13</mn></msub><mo>,</mo><msub><mi>m</mi><mn>24</mn></msub></mrow><mo>→</mo><mi>m</mi></mrow><mrow><mrow><msub><mi>j</mi><mn>13</mn></msub><mo>,</mo><msub><mi>j</mi><mn>24</mn></msub></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td></tr>
</table>
<p class="ltx_p">Notice, that: in the first column the CGC shares the first irrep, in the second column they share the second irrep
and in the third column they share the third irrep. Between the first and second column
one can draw a cross from <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.m5" class="ltx_Math" alttext="j_{2}&lt;--&gt;j_{2}" display="inline"><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>&lt;</mo><mo>-</mo><mo>-</mo><mo>&gt;</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.m6" class="ltx_Math" alttext="j_{3}&lt;--&gt;j_{3}" display="inline"><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>&lt;</mo><mo>-</mo><mo>-</mo><mo>&gt;</mo><msub><mi>j</mi><mn>3</mn></msub></mrow></math>. In the last column the first and second irrep
of each CGC comes from the third irrep in the CGC in the same row but from the first or second column respectively.
All <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.m7" class="ltx_Math" alttext="m" display="inline"><mi>m</mi></math> are summed beside the last one from the CGC in the third column.
It is worthwhile to have this visual structure to identify if the sum over six CGC forms a recoupling coeff or not.
The <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.m8" class="ltx_Math" alttext="9j" display="inline"><mrow><mn>9</mn><mo>⁢</mo><mi>j</mi></mrow></math>-symbol is defined as:</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E5.m1" class="ltx_Math" alttext="\begin{Bmatrix}j_{1}&amp;j_{2}&amp;j_{12}\\&#10;j_{3}&amp;j_{4}&amp;j_{34}\\&#10;j_{13}&amp;j_{24}&amp;j\end{Bmatrix}=\frac{1}{\sqrt{(2j_{12}+1)(2j_{34}+1)(2j_{13}+1)(%&#10;2j_{24}+1)}}\begin{bmatrix}j_{1}&amp;j_{2}&amp;j_{12}\\&#10;j_{3}&amp;j_{4}&amp;j_{34}\\&#10;j_{13}&amp;j_{24}&amp;j\end{bmatrix}" display="block"><mrow><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>4</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>34</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>13</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>24</mn></msub></mtd><mtd columnalign="center"><mi>j</mi></mtd></mtr></mtable><mo>}</mo></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>12</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>34</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>13</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>24</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msqrt></mfrac><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>4</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>34</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>13</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>24</mn></msub></mtd><mtd columnalign="center"><mi>j</mi></mtd></mtr></mtable><mo>]</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td></tr>
</table>
</div>
</div>
<div id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">3 </span>Wigner-Eckart</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">For a tensor operator <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p1.m1" class="ltx_Math" alttext="O^{[k]}_{m}" display="inline"><msubsup><mi>O</mi><mi>m</mi><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msubsup></math> the following holds:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E6.m1" class="ltx_Math" alttext="\Braket{j_{1},m_{1}}{O^{[k]}_{m}}{j_{2},m_{2}}=C^{j_{2}k\rightarrow j_{1}}_{m_%&#10;{2}m\rightarrow m_{1}}\Braket{j_{1}}{O^{[k]}}{j_{2}}" display="block"><mrow><mrow><mo>⟨</mo><mpadded width="+1.7pt"><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow></mpadded><mo fence="true" rspace="4.2pt">|</mo><mpadded width="+1.7pt"><msubsup><mi>O</mi><mi>m</mi><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msubsup></mpadded><mo fence="true" rspace="4.2pt">|</mo><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>⟩</mo></mrow><mo>=</mo><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>2</mn></msub><mo>⁢</mo><mi>m</mi></mrow><mo>→</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><mrow><mo>⟨</mo><mpadded width="+1.7pt"><msub><mi>j</mi><mn>1</mn></msub></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mpadded width="+1.7pt"><msup><mi>O</mi><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msup></mpadded><mo fence="true" rspace="4.2pt">∥</mo><msub><mi>j</mi><mn>2</mn></msub><mo>⟩</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td></tr>
</table>
<p class="ltx_p">This is convention also used by Mc Culloch. The CGC is build so that the first irrep is the ket, the second irrep is the operator irrep
and the total irrep is the bra. For <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p1.m2" class="ltx_Math" alttext="U(1)" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> this means <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p1.m3" class="ltx_Math" alttext="ket+op=bra" display="inline"><mrow><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>t</mi></mrow><mo>+</mo><mrow><mi>o</mi><mo>⁢</mo><mi>p</mi></mrow></mrow><mo>=</mo><mrow><mi>b</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>a</mi></mrow></mrow></math>.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">For an operator with <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m1" class="ltx_Math" alttext="k=0" display="inline"><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow></math> (scalar operator), the CGC part is <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m2" class="ltx_Math" alttext="\delta_{j_{2}j_{1}}\delta_{m_{2}m_{1}}" display="inline"><mrow><msub><mi>δ</mi><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>1</mn></msub></mrow></msub></mrow></math>,
so that the reduced matrix elements are the same as the normal matrix elements.
If the trace however is calculated from the reduced matrix elements,
one needs to take into account
that <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m3" class="ltx_Math" alttext="2j_{1}+1" display="inline"><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>1</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow></math> copies of the reduced matrix elements appear:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E7.m1" class="ltx_Math" alttext="\text{tr}O=\sum_{j}(2j+1)\Braket{j}{O^{[0]}}{j}" display="block"><mrow><mrow><mtext>tr</mtext><mo>⁢</mo><mi>O</mi></mrow><mo>=</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi>j</mi></munder><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo>⟨</mo><mpadded width="+1.7pt"><mi>j</mi></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mpadded width="+1.7pt"><msup><mi>O</mi><mrow><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></msup></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mi>j</mi><mo>⟩</mo></mrow></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td></tr>
</table>
<p class="ltx_p">This coefficients is called <span class="ltx_text ltx_font_smallcaps">coeff_dot</span> in the implementation.
It appears at every situation, where one obtains a scalar quantity.
E.g. when contracting the left and right environment to obtain an expectation value.</p>
</div>
<div id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">3.1 </span>Product of tensor operators</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p class="ltx_p">The product of two operators <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m1" class="ltx_Math" alttext="O^{[k_{1}]}_{m_{1}}" display="inline"><msubsup><mi>O</mi><msub><mi>m</mi><mn>1</mn></msub><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow></msubsup></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m2" class="ltx_Math" alttext="S^{[k_{2}]}_{m_{2}}" display="inline"><msubsup><mi>S</mi><msub><mi>m</mi><mn>2</mn></msub><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow></msubsup></math>
gives rise to different irreducible tensor operators by the definition:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E8.m1" class="ltx_Math" alttext="\left[O^{[k_{1}]}\times S^{[k_{2}]}\right]^{[k]}_{m}=\sum_{m_{1},m_{2}}C^{k_{1%&#10;}k_{2}\rightarrow k}_{m_{1}m_{2}\rightarrow m}O^{[k_{1}]}_{m_{1}}S^{[k_{2}]}_{%&#10;m_{2}}" display="block"><mrow><msubsup><mrow><mo>[</mo><mrow><msup><mi>O</mi><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow></msup><mo>×</mo><msup><mi>S</mi><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow></msup></mrow><mo>]</mo></mrow><mi>m</mi><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msubsup><mo>=</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></munder><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>m</mi></mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>k</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>O</mi><msub><mi>m</mi><mn>1</mn></msub><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow></msubsup><mo>⁢</mo><msubsup><mi>S</mi><msub><mi>m</mi><mn>2</mn></msub><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow></msubsup></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td></tr>
</table>
<p class="ltx_p">One can obtain the reduced matrix elements of the product directly from the reduced matrix elements
of the individual operators. To see this, one inserts in Eq. (<a href="#S3.E8" title="(8) ‣ 3.1 Product of tensor operators ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>)
the CGC as defined in the Wigner-Eckart theorem for all operators, namely <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m3" class="ltx_Math" alttext="O^{[k_{1}]}_{m_{1}}" display="inline"><msubsup><mi>O</mi><msub><mi>m</mi><mn>1</mn></msub><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow></msubsup></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m4" class="ltx_Math" alttext="S^{[k_{2}]}_{m_{2}}" display="inline"><msubsup><mi>S</mi><msub><mi>m</mi><mn>2</mn></msub><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow></msubsup></math>
and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m5" class="ltx_Math" alttext="\left[O^{[k_{1}]}\times S^{[k_{2}]}\right]^{[k]}_{m}" display="inline"><msubsup><mrow><mo>[</mo><mrow><msup><mi>O</mi><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow></msup><mo>×</mo><msup><mi>S</mi><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow></msup></mrow><mo>]</mo></mrow><mi>m</mi><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msubsup></math>. Therefore, one sandwiches the equation with
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m6" class="ltx_Math" alttext="\Braket{j_{1},m_{j_{1}}}{\dots}{j_{2}m_{j_{2}}}" display="inline"><mrow><mo>⟨</mo><mpadded width="+1.7pt"><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub></mrow></mpadded><mo fence="true" rspace="4.2pt">|</mo><mpadded width="+1.7pt"><mi mathvariant="normal">…</mi></mpadded><mo fence="true" rspace="4.2pt">|</mo><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>j</mi><mn>2</mn></msub></msub></mrow><mo>⟩</mo></mrow></math> and introduces an identity <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m7" class="ltx_Math" alttext="\sum_{j_{3}m_{j_{3}}}\Ket{j_{3}m_{j_{3}}}\Bra{j_{3}m_{j_{3}}}" display="inline"><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub></mrow></msub><mrow><mrow><mo fence="true">|</mo><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub></mrow><mo>⟩</mo></mrow><mo>⁢</mo><mrow><mo>⟨</mo><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub></mrow><mo fence="true">|</mo></mrow></mrow></mrow></math>
for the operator product on the right side of Eq. (<a href="#S3.E8" title="(8) ‣ 3.1 Product of tensor operators ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>).
For clearness it is worthwile to omit the reduced matrix elements because they factor out.
The CGC part reads then:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E9.m1" class="ltx_Math" alttext="C^{j_{2}k\rightarrow j_{1}}_{m_{j_{2}}m_{k}\rightarrow m_{j_{1}}}=\sum_{m_{k_{%&#10;1}},m_{k_{2}},m_{j_{3}}}C^{k_{1}k_{2}\rightarrow k}_{m_{k_{1}}m_{k_{2}}%&#10;\rightarrow m_{k}}C^{j_{3}k_{1}\rightarrow j_{1}}_{m_{j_{3}}m_{k_{1}}%&#10;\rightarrow m_{j_{1}}}C^{j_{2}k_{1}\rightarrow j_{3}}_{m_{j_{2}}m_{k_{1}}%&#10;\rightarrow m_{j_{3}}}" display="block"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msubsup><mo>=</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub></mrow></munder><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>k</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>k</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>⁢</mo><msub><mi>k</mi><mn>1</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>k</mi><mn>1</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>3</mn></msub></mrow></msubsup></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td></tr>
</table>
<p class="ltx_p">The CGC at the left side can be brought to the right side by multiplying
with <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m8" class="ltx_Math" alttext="C^{j_{2}k\rightarrow J_{1}}_{m_{j_{2}}m_{k}\rightarrow m_{J_{1}}}" display="inline"><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>J</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>J</mi><mn>1</mn></msub></mrow></msubsup></math> and summing over <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m9" class="ltx_Math" alttext="m_{j_{2}}" display="inline"><msub><mi>m</mi><msub><mi>j</mi><mn>2</mn></msub></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m10" class="ltx_Math" alttext="m_{k}" display="inline"><msub><mi>m</mi><mi>k</mi></msub></math>.
This gives <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m11" class="ltx_Math" alttext="\delta_{j_{1}J_{1}}\delta_{m_{j_{1}}m_{J_{1}}}" display="inline"><mrow><msub><mi>δ</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>J</mi><mn>1</mn></msub></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>J</mi><mn>1</mn></msub></msub></mrow></msub></mrow></math> for the left side and for right side:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E10.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\delta_{j_{1}J_{1}}\delta_{m_{j_{1}}m_{J_{1}}}&amp;%&#10;\displaystyle=\sum_{m_{k_{1}},m_{k_{2}},m_{j_{3}},m_{j_{2}},m_{k}}\\&#10;&amp;\displaystyle C^{j_{2}k_{1}\rightarrow j_{3}}_{m_{j_{2}}m_{k_{1}}\rightarrow m%&#10;_{j_{3}}}C^{k_{1}k_{2}\rightarrow k}_{m_{k_{1}}m_{k_{2}}\rightarrow m_{k}}\\&#10;&amp;\displaystyle C^{j_{2}k\rightarrow j_{1}}_{m_{j_{2}}m_{k}\rightarrow m_{j_{1}%&#10;}}C^{j_{3}k_{2}\rightarrow j_{1}}_{m_{j_{3}}m_{k_{2}}\rightarrow m_{j_{1}}}%&#10;\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><msub><mi>δ</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>J</mi><mn>1</mn></msub></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>J</mi><mn>1</mn></msub></msub></mrow></msub></mrow></mtd><mtd columnalign="left"><mrow><mi/><mo>=</mo><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></munder></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>k</mi><mn>1</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>3</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>k</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>k</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>3</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>k</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>⁢</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>→</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msubsup></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td></tr>
</table>
<p class="ltx_p">This equation does not fit the definition of the recouple coeff in Eq. (<a href="#S2.E2" title="(2) ‣ 2 ⁢ 6 j , ⁢ 9 j and recoupling symbols ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
To reach this, one has to interchange <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m12" class="ltx_Math" alttext="k_{1}" display="inline"><msub><mi>k</mi><mn>1</mn></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m13" class="ltx_Math" alttext="k_{2}" display="inline"><msub><mi>k</mi><mn>2</mn></msub></math> in the CGC <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m14" class="ltx_Math" alttext="C^{k_{1}k_{2}\rightarrow k}_{m_{k_{1}}m_{k_{2}}\rightarrow m_{k}}" display="inline"><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>k</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>k</mi></mrow></msubsup></math>.
This leads to a an additional phase factor <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m15" class="ltx_Math" alttext="(-1)^{k_{1}+k_{2}-k}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>-</mo><mi>k</mi></mrow></msup></math>.
Afterwards, one can perform the sum over the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m16" class="ltx_Math" alttext="m" display="inline"><mi>m</mi></math> quantum numbers to obtain a recouple coeff as in Eq. (<a href="#S2.E2" title="(2) ‣ 2 ⁢ 6 j , ⁢ 9 j and recoupling symbols ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E11.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\delta_{j_{1}J_{1}}\delta_{m_{j_{1}}m_{J_{1}}}&amp;%&#10;\displaystyle=(-1)^{k_{1}+k_{2}-k}\begin{bmatrix}j_{2}&amp;k_{1}&amp;j_{3}\\&#10;k_{2}&amp;j_{1}&amp;k\end{bmatrix}\delta_{j_{1}J_{1}}\delta_{m_{j_{1}}m_{J_{1}}}\\&#10;&amp;\displaystyle=(-1)^{k_{1}+k_{2}-k}(-1)^{j_{2}+k_{1}+k_{2}+j_{1}}\sqrt{(2j_{3}%&#10;+1)(2k+1)}\begin{Bmatrix}j_{2}&amp;k_{1}&amp;j_{3}\\&#10;k_{2}&amp;j_{1}&amp;k\end{Bmatrix}\delta_{j_{1}J_{1}}\delta_{m_{j_{1}}m_{J_{1}}}\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><msub><mi>δ</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>J</mi><mn>1</mn></msub></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>J</mi><mn>1</mn></msub></msub></mrow></msub></mrow></mtd><mtd columnalign="left"><mrow><mi/><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>-</mo><mi>k</mi></mrow></msup><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>k</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><mi>k</mi></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>J</mi><mn>1</mn></msub></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>J</mi><mn>1</mn></msub></msub></mrow></msub></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mi/><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>-</mo><mi>k</mi></mrow></msup><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msup><mo>⁢</mo><msqrt><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>3</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>k</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msqrt><mo>⁢</mo><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>k</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><mi>k</mi></mtd></mtr></mtable><mo>}</mo></mrow><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>J</mi><mn>1</mn></msub></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>J</mi><mn>1</mn></msub></msub></mrow></msub></mrow></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td></tr>
</table>
<p class="ltx_p">For the sign, one finds:</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E12.m1" class="ltx_Math" alttext="(-1)^{k_{1}+k_{2}-k-k+k+j_{2}+k_{1}+k_{2}+j_{1}}=(-1)^{2(k_{1}+k_{2}-k)}(-1)^{%&#10;k+j_{2}+j_{1}}=(-1)^{k+j_{2}+j_{1}}," display="block"><mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>-</mo><mi>k</mi><mo>-</mo><mi>k</mi></mrow><mo>+</mo><mi>k</mi><mo>+</mo><msub><mi>j</mi><mn>2</mn></msub><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msup><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mo>-</mo><mi>k</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></msup><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><msub><mi>j</mi><mn>2</mn></msub><mo>+</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msup></mrow><mo>=</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><msub><mi>j</mi><mn>2</mn></msub><mo>+</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msup></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td></tr>
</table>
<p class="ltx_p">because <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m17" class="ltx_Math" alttext="k_{1}" display="inline"><msub><mi>k</mi><mn>1</mn></msub></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m18" class="ltx_Math" alttext="k_{2}" display="inline"><msub><mi>k</mi><mn>2</mn></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS1.p1.m19" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math> fulfil the triangle condition.
In summary, the coefficient for the product is:</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E13.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\Braket{j_{1}}{\left[O^{[k_{1}]}\times S^{[k_{2}]}%&#10;\right]^{[k]}_{m}}{j_{2}}=&amp;\displaystyle\sum_{j_{3}}(-1)^{k+j_{2}+j_{1}}\sqrt{%&#10;(2j_{3}+1)(2k+1)}\begin{Bmatrix}j_{2}&amp;k_{1}&amp;j_{3}\\&#10;k_{2}&amp;j_{1}&amp;k\end{Bmatrix}\\&#10;&amp;\displaystyle\Braket{j_{1}}{O^{[k_{1}]}}{j_{3}}\Braket{j_{3}}{S^{[k_{2}]}}{j_%&#10;{2}}\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><mrow><mo>⟨</mo><mpadded width="+1.7pt"><msub><mi>j</mi><mn>1</mn></msub></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mpadded width="+1.7pt"><msubsup><mrow><mo>[</mo><mrow><msup><mi>O</mi><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow></msup><mo>×</mo><msup><mi>S</mi><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow></msup></mrow><mo>]</mo></mrow><mi>m</mi><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msubsup></mpadded><mo fence="true" rspace="4.2pt">∥</mo><msub><mi>j</mi><mn>2</mn></msub><mo>⟩</mo></mrow><mo>=</mo><mi/></mrow></mtd><mtd columnalign="left"><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><msub><mi>j</mi><mn>3</mn></msub></munder><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><msub><mi>j</mi><mn>2</mn></msub><mo>+</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msup><mo>⁢</mo><msqrt><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>3</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>k</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msqrt><mo>⁢</mo><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msub><mi>j</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>k</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msub><mi>j</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><mi>k</mi></mtd></mtr></mtable><mo>}</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mrow><mo>⟨</mo><mpadded width="+1.7pt"><msub><mi>j</mi><mn>1</mn></msub></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mpadded width="+1.7pt"><msup><mi>O</mi><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow></msup></mpadded><mo fence="true" rspace="4.2pt">∥</mo><msub><mi>j</mi><mn>3</mn></msub><mo>⟩</mo></mrow><mo>⁢</mo><mrow><mo>⟨</mo><mpadded width="+1.7pt"><msub><mi>j</mi><mn>3</mn></msub></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mpadded width="+1.7pt"><msup><mi>S</mi><mrow><mo stretchy="false">[</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow></msup></mpadded><mo fence="true" rspace="4.2pt">∥</mo><msub><mi>j</mi><mn>2</mn></msub><mo>⟩</mo></mrow></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td></tr>
</table>
<p class="ltx_p">The corresponding coefficient is called <span class="ltx_text ltx_font_smallcaps">coeff_prod</span>.</p>
</div>
</div>
<div id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">3.2 </span>Adjoint of tensor operators</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p class="ltx_p">The adjoint of tensor operators can be defined with respect to the metric defined in
Eq. (<a href="#S3.E8" title="(8) ‣ 3.1 Product of tensor operators ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) when coupling two operators of rank <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m1" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math> to
a singlet operator (<math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m2" class="ltx_Math" alttext="k=0" display="inline"><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow></math>). The corresponding CGC is
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m3" class="ltx_Math" alttext="C^{kk\rightarrow 0}_{m_{1}m_{2}\rightarrow 0}=\frac{(-1)^{k-m_{1}}}{\sqrt{2k+1%&#10;}}\delta_{m_{1},-m_{2}}" display="inline"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>→</mo><mn>0</mn></mrow><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><mn>0</mn></mrow></msubsup><mo>=</mo><mrow><mfrac><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>-</mo><msub><mi>m</mi><mn>1</mn></msub></mrow></msup><msqrt><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>k</mi></mrow><mo>+</mo><mn>1</mn></mrow></msqrt></mfrac><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><mrow><mo>-</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow></msub></mrow></mrow></math>.
The adjoint tensor operator is therefore:</p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E14.m1" class="ltx_Math" alttext="O^{\dagger[k]}_{m}=(-1)^{k-m}\left(O^{[k]}_{-m}\right)^{\dagger}" display="block"><mrow><msubsup><mi>O</mi><mi>m</mi><mrow><mi/><mo>†</mo><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow></msubsup><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>-</mo><mi>m</mi></mrow></msup><mo>⁢</mo><msup><mrow><mo>(</mo><msubsup><mi>O</mi><mrow><mo>-</mo><mi>m</mi></mrow><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msubsup><mo>)</mo></mrow><mo>†</mo></msup></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td></tr>
</table>
<p class="ltx_p">The Wigner Eckart theorem gives:</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E15.m1" class="ltx_Math" alttext="\Braket{j_{1}m_{1}}{O^{\dagger[k]}_{m}}{j_{2}m_{2}}=C^{j_{2}k\rightarrow j_{1}%&#10;}_{m_{2}m\rightarrow m_{1}}\Braket{j_{1}}{O^{\dagger[k]}}{j_{2}}" display="block"><mrow><mrow><mo>⟨</mo><mpadded width="+1.7pt"><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>1</mn></msub></mrow></mpadded><mo fence="true" rspace="4.2pt">|</mo><mpadded width="+1.7pt"><msubsup><mi>O</mi><mi>m</mi><mrow><mi/><mo>†</mo><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow></msubsup></mpadded><mo fence="true" rspace="4.2pt">|</mo><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>⟩</mo></mrow><mo>=</mo><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>2</mn></msub><mo>⁢</mo><mi>m</mi></mrow><mo>→</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><mrow><mo>⟨</mo><mpadded width="+1.7pt"><msub><mi>j</mi><mn>1</mn></msub></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mpadded width="+1.7pt"><msup><mi>O</mi><mrow><mi/><mo>†</mo><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow></msup></mpadded><mo fence="true" rspace="4.2pt">∥</mo><msub><mi>j</mi><mn>2</mn></msub><mo>⟩</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td></tr>
</table>
<p class="ltx_p">The reduced matrix elements of the adjoint are related to the original one.
The factor is obtained when applying the Wigner Eckart theorem for Eq. (<a href="#S3.E14" title="(14) ‣ 3.2 Adjoint of tensor operators ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>):</p>
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E16.m1" class="ltx_Math" alttext="C^{j_{2}k\rightarrow j_{1}}_{m_{2}m\rightarrow m_{1}}=(-1)^{k-m}C^{j_{1}k%&#10;\rightarrow j_{2}}_{m_{1},-m\rightarrow m_{2}}" display="block"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>2</mn></msub><mo>⁢</mo><mi>m</mi></mrow><mo>→</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>j</mi><mn>1</mn></msub></mrow></msubsup><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>-</mo><mi>m</mi></mrow></msup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><mrow><mo>-</mo><mi>m</mi></mrow></mrow><mo>→</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msubsup></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td></tr>
</table>
<p class="ltx_p">Interchanging <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m4" class="ltx_Math" alttext="j_{1}" display="inline"><msub><mi>j</mi><mn>1</mn></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m5" class="ltx_Math" alttext="j_{2}" display="inline"><msub><mi>j</mi><mn>2</mn></msub></math> at the right side leads to the factor <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m6" class="ltx_Math" alttext="\sqrt{\frac{2j_{2}+1}{2j_{1}+1}}(-1)^{k-m}" display="inline"><mrow><msqrt><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>2</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>1</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>-</mo><mi>m</mi></mrow></msup></mrow></math>
and to the subtitution <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m7" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi>m</mi><mn>1</mn></msub></math> to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m8" class="ltx_Math" alttext="-m_{1}" display="inline"><mrow><mo>-</mo><msub><mi>m</mi><mn>1</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m9" class="ltx_Math" alttext="m_{2}" display="inline"><msub><mi>m</mi><mn>2</mn></msub></math> to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m10" class="ltx_Math" alttext="-m_{2}" display="inline"><mrow><mo>-</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></math> in the CGC at the right.
The sign <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m11" class="ltx_Math" alttext="(-1)^{k-m}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>-</mo><mi>m</mi></mrow></msup></math> cancels and after reverting all signs of the CGC at the right, the two
CGC are identical. Reverting all signs give another sign <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m12" class="ltx_Math" alttext="(-1)^{j_{1}+k-j_{2}}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>+</mo><mi>k</mi></mrow><mo>-</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msup></math> so that the corresponding coeff reads:</p>
<table id="S3.E17" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.E17.m1" class="ltx_Math" alttext="\Braket{j_{1}}{O^{\dagger[k]}}{j_{2}}=(-1)^{j_{1}+k-j_{2}}\sqrt{\frac{2j_{2}+1%&#10;}{2j_{1}+1}}(-1)^{k-m}\Braket{j_{2}}{O^{[k]}}{j_{1}}^{*}" display="block"><mrow><mrow><mo>⟨</mo><mpadded width="+1.7pt"><msub><mi>j</mi><mn>1</mn></msub></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mpadded width="+1.7pt"><msup><mi>O</mi><mrow><mi/><mo>†</mo><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow></msup></mpadded><mo fence="true" rspace="4.2pt">∥</mo><msub><mi>j</mi><mn>2</mn></msub><mo>⟩</mo></mrow><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>+</mo><mi>k</mi></mrow><mo>-</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msup><mo>⁢</mo><msqrt><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>2</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>j</mi><mn>1</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>-</mo><mi>m</mi></mrow></msup><mo>⁢</mo><msup><mrow><mo>⟨</mo><mpadded width="+1.7pt"><msub><mi>j</mi><mn>2</mn></msub></mpadded><mo fence="true" rspace="4.2pt">∥</mo><mpadded width="+1.7pt"><msup><mi>O</mi><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msup></mpadded><mo fence="true" rspace="4.2pt">∥</mo><msub><mi>j</mi><mn>1</mn></msub><mo>⟩</mo></mrow><mo>*</mo></msup></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td></tr>
</table>
<p class="ltx_p">The corresponding coefficient is called <span class="ltx_text ltx_font_smallcaps">coeff_adjoint</span> in the implementation.
Notice that <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.SS2.p1.m13" class="ltx_Math" alttext="O^{\dagger^{\dagger}[k]}=(-1)^{2k}O^{[k]}" display="inline"><mrow><msup><mi>O</mi><mrow><mi/><msup><mo>†</mo><mo>†</mo></msup><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow></msup><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>k</mi></mrow></msup><mo>⁢</mo><msup><mi>O</mi><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></msup></mrow></mrow></math>.</p>
</div>
</div>
<div id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">3.3 </span>Spin operator</h3>

</div>
<div id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">3.4 </span>Fermionic operators</h3>

</div>
</div>
<div id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">4 </span>Convention for MPS, MPO and environments</h2>

<div id="S4.p1" class="ltx_para">
<p class="ltx_p">For an MPS, we choose the following convention for the CGC:</p>
<table id="S4.E18" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.E18.m1" class="ltx_Math" alttext="A^{\sigma}_{ij}=A^{\sigma}_{ij}C^{i\sigma\rightarrow j}_{m_{i}m_{\sigma}%&#10;\rightarrow m_{j}}" display="block"><mrow><msubsup><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>σ</mi></msubsup><mo>=</mo><mrow><msubsup><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>σ</mi></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>σ</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td></tr>
</table>
<p class="ltx_p">This is different from the convention by Mc Culloch. For <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p1.m1" class="ltx_Math" alttext="U(1)" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> it corresponds to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p1.m2" class="ltx_Math" alttext="i+\sigma=j" display="inline"><mrow><mrow><mi>i</mi><mo>+</mo><mi>σ</mi></mrow><mo>=</mo><mi>j</mi></mrow></math>.
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p1.m3" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> is the left index from <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p1.m4" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p1.m5" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math> the right index.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p class="ltx_p">For an MPO, we choose the following convention for the CGC:</p>
<table id="S4.E19" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.E19.m1" class="ltx_Math" alttext="W^{[k]\sigma_{1}\sigma_{2}}_{ab}=W^{[k]\sigma_{1}\sigma_{2}}_{ab}C^{\sigma_{2}%&#10;k\rightarrow\sigma_{1}}_{m_{\sigma_{2}}m_{k}\rightarrow m_{\sigma_{1}}}C^{ak%&#10;\rightarrow b}_{m_{a}m_{k}\rightarrow m_{b}}" display="block"><mrow><msubsup><mi>W</mi><mrow><mi>a</mi><mo>⁢</mo><mi>b</mi></mrow><mrow><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><mo>⁢</mo><msub><mi>σ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow></msubsup><mo>=</mo><mrow><msubsup><mi>W</mi><mrow><mi>a</mi><mo>⁢</mo><mi>b</mi></mrow><mrow><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><mo>⁢</mo><msub><mi>σ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>a</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>b</mi></msub></mrow><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>k</mi></mrow><mo>→</mo><mi>b</mi></mrow></msubsup></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td></tr>
</table>
<p class="ltx_p">For <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.m1" class="ltx_Math" alttext="U(1)" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> it corresponds to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.m2" class="ltx_Math" alttext="a+b=j" display="inline"><mrow><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mo>=</mo><mi>j</mi></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.m3" class="ltx_Math" alttext="\sigma_{2}+k=\sigma_{1}" display="inline"><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>+</mo><mi>k</mi></mrow><mo>=</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></math>.
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.m4" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> is the left index from <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.m5" class="ltx_Math" alttext="W" display="inline"><mi>W</mi></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.m6" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> the right index.
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.m7" class="ltx_Math" alttext="\sigma_{2}" display="inline"><msub><mi>σ</mi><mn>2</mn></msub></math> points in the direction of the ket MPS while <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.m8" class="ltx_Math" alttext="\sigma_{1}" display="inline"><msub><mi>σ</mi><mn>1</mn></msub></math> into the direction of the bra.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p class="ltx_p">For the left environment we have:</p>
<table id="S4.E20" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.E20.m1" class="ltx_Math" alttext="L^{a}_{ij}=L^{a}_{ij}C^{ia\rightarrow j}_{m_{i}m_{a}\rightarrow m_{j}}" display="block"><mrow><msubsup><mi>L</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>a</mi></msubsup><mo>=</mo><mrow><msubsup><mi>L</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>a</mi></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td></tr>
</table>
<p class="ltx_p">For <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p3.m1" class="ltx_Math" alttext="U(1)" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> it corresponds to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p3.m2" class="ltx_Math" alttext="i+a=j" display="inline"><mrow><mrow><mi>i</mi><mo>+</mo><mi>a</mi></mrow><mo>=</mo><mi>j</mi></mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p3.m3" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> is pointing to the ket layer, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p3.m4" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math>
is pointing to the bra layer.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p class="ltx_p">For the right environment we have:</p>
<table id="S4.E21" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.E21.m1" class="ltx_Math" alttext="R^{a}_{ij}=R^{a}_{ij}C^{ia\rightarrow j}_{m_{i}m_{a}\rightarrow m_{j}}" display="block"><mrow><msubsup><mi>R</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>a</mi></msubsup><mo>=</mo><mrow><msubsup><mi>R</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>a</mi></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td></tr>
</table>
<p class="ltx_p">For <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p4.m1" class="ltx_Math" alttext="U(1)" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> it corresponds to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p4.m2" class="ltx_Math" alttext="i+a=j" display="inline"><mrow><mrow><mi>i</mi><mo>+</mo><mi>a</mi></mrow><mo>=</mo><mi>j</mi></mrow></math>. <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p4.m3" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> is pointing to the ket layer, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p4.m4" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math>
is pointing to the bra layer.</p>
</div>
</div>
<div id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">5 </span>Algorithms</h2>

<div id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">5.1 </span>Sweep and reshape</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p class="ltx_p">]
Reshaping is is the combination of two indices into a super index.
This is essentially an isometry which maps the basis states from the
two indices into one. The reshaping process is not unique and a convention is neccesary.
E.g. without any symmetries a isometry <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p1.m1" class="ltx_Math" alttext="\Pi_{i\sigma}^{k}" display="inline"><msubsup><mi mathvariant="normal">Π</mi><mrow><mi>i</mi><mo>⁢</mo><mi>σ</mi></mrow><mi>k</mi></msubsup></math> could be chosen as
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p1.m2" class="ltx_Math" alttext="\Pi_{i\sigma}^{k}=1" display="inline"><mrow><msubsup><mi mathvariant="normal">Π</mi><mrow><mi>i</mi><mo>⁢</mo><mi>σ</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mn>1</mn></mrow></math> if <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p1.m3" class="ltx_Math" alttext="k=i+\text{dim}(i)\sigma" display="inline"><mrow><mi>k</mi><mo>=</mo><mrow><mi>i</mi><mo>+</mo><mrow><mtext>dim</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>σ</mi></mrow></mrow></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p1.m4" class="ltx_Math" alttext="\Pi_{i\sigma}^{k}=0" display="inline"><mrow><msubsup><mi mathvariant="normal">Π</mi><mrow><mi>i</mi><mo>⁢</mo><mi>σ</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mn>0</mn></mrow></math> otherwise.
For symmetric tensors, the isometry should map on proper irreps of the syymetry.
The combination of two irreps into the tensor product is exactly the definition
for the CGC, so that the isometry <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p1.m5" class="ltx_Math" alttext="\Pi" display="inline"><mi mathvariant="normal">Π</mi></math> needs to be proportional to the CGC.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p class="ltx_p">For a right sweep, we want to left-normalize the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p2.m1" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>-tensor.
Hence the incoming index <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p2.m2" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> get combined with the physical index <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p2.m3" class="ltx_Math" alttext="\sigma" display="inline"><mi>σ</mi></math>.
The symmetry part of isometry <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p2.m4" class="ltx_Math" alttext="\Pi" display="inline"><mi mathvariant="normal">Π</mi></math> is chosen as <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p2.m5" class="ltx_Math" alttext="\Pi=C^{i\sigma\rightarrow k}_{m_{i}m_{\sigma}\rightarrow m_{k}}" display="inline"><mrow><mi mathvariant="normal">Π</mi><mo>=</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>σ</mi></mrow><mo>→</mo><mi>k</mi></mrow></msubsup></mrow></math>.
We have <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p2.m6" class="ltx_Math" alttext="\Pi\cdot\Pi^{\dagger}=1" display="inline"><mrow><mrow><mi mathvariant="normal">Π</mi><mo>⋅</mo><msup><mi mathvariant="normal">Π</mi><mo>†</mo></msup></mrow><mo>=</mo><mn>1</mn></mrow></math> since:</p>
<table id="S5.E22" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E22.m1" class="ltx_Math" alttext="\sum_{m_{i}m_{\sigma}}C^{i\sigma\rightarrow k}_{m_{i}m_{\sigma}\rightarrow m_{%&#10;k}}C^{i\sigma\rightarrow k}_{m_{i}m_{\sigma}\rightarrow m_{k}}=1" display="block"><mrow><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow></munder><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>σ</mi></mrow><mo>→</mo><mi>k</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>σ</mi></mrow><mo>→</mo><mi>k</mi></mrow></msubsup></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td></tr>
</table>
<p class="ltx_p">is a orthonormality condition for the CGC.
Furthermore in the calculation <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p2.m7" class="ltx_Math" alttext="\Pi\cdot A" display="inline"><mrow><mi mathvariant="normal">Π</mi><mo>⋅</mo><mi>A</mi></mrow></math>, the CGC drop out for the same reason.
Hence there is no extra factor for a right sweep step (left-normalization step).</p>
<table id="S5.E23" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E23.m1" class="ltx_Math" alttext="A^{\sigma}_{ij}=\tilde{A}^{(i\sigma)}_{j}" display="block"><mrow><msubsup><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>σ</mi></msubsup><mo>=</mo><msubsup><mover accent="true"><mi>A</mi><mo stretchy="false">~</mo></mover><mi>j</mi><mrow><mo stretchy="false">(</mo><mrow><mi>i</mi><mo>⁢</mo><mi>σ</mi></mrow><mo stretchy="false">)</mo></mrow></msubsup></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td></tr>
</table>
<p class="ltx_p">There is also no extra factor when checking for the left-nomalize condition.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p class="ltx_p">For a left sweep, we want to right-normalize the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m1" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>-tensor.
Hence the outgoing index <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m2" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math> get combined with the physical index <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m3" class="ltx_Math" alttext="\sigma" display="inline"><mi>σ</mi></math>.
The symmetry part of isometry <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m4" class="ltx_Math" alttext="\Pi" display="inline"><mi mathvariant="normal">Π</mi></math> is chosen as <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m5" class="ltx_Math" alttext="\Pi\sim C^{k\sigma\rightarrow j}_{m_{k}m_{\sigma}\rightarrow m_{j}}" display="inline"><mrow><mi mathvariant="normal">Π</mi><mo>∼</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>σ</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></math>.
We have <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m6" class="ltx_Math" alttext="\Pi\cdot\Pi^{\dagger}\neq 1" display="inline"><mrow><mrow><mi mathvariant="normal">Π</mi><mo>⋅</mo><msup><mi mathvariant="normal">Π</mi><mo>†</mo></msup></mrow><mo>≠</mo><mn>1</mn></mrow></math> but:</p>
<table id="S5.E24" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E24.m1" class="ltx_Math" alttext="\sum_{m_{j}m_{\sigma}}C^{k\sigma\rightarrow j}_{m_{k}m_{\sigma}\rightarrow m_{%&#10;j}}C^{k\sigma\rightarrow j}_{m_{k}m_{\sigma}\rightarrow m_{j}}=\frac{2j+1}{2k+1}" display="block"><mrow><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow></munder><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>σ</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>σ</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mrow><mo>=</mo><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>k</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td></tr>
</table>
<p class="ltx_p">This can be seen when changing the indices <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m7" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m8" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math> in both CGC which leads to the factor <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m9" class="ltx_Math" alttext="\sqrt{\frac{2j+1}{2k+1}}(-1)^{\sigma-m_{\sigma}}" display="inline"><mrow><msqrt><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>k</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>σ</mi><mo>-</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow></msup></mrow></math>.
The phase factor drops out because it appears twice. The CGC after the interchange multiply to one.
A proper normalized <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m10" class="ltx_Math" alttext="\Pi" display="inline"><mi mathvariant="normal">Π</mi></math> is in fact an isometry: <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m11" class="ltx_Math" alttext="\Pi=\sqrt{\frac{2k+1}{2j+1}}C^{k\sigma\rightarrow j}_{m_{k}m_{\sigma}%&#10;\rightarrow m_{j}}" display="inline"><mrow><mi mathvariant="normal">Π</mi><mo>=</mo><mrow><msqrt><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>k</mi></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>σ</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mrow></math>.
When calculating <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS1.p3.m12" class="ltx_Math" alttext="\Pi\cdot A" display="inline"><mrow><mi mathvariant="normal">Π</mi><mo>⋅</mo><mi>A</mi></mrow></math>, one encounters the same equation as above so there is a factor for the left sweep:</p>
<table id="S5.E25" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E25.m1" class="ltx_Math" alttext="A^{\sigma}_{ij}=\sqrt{\frac{2j+1}{2i+1}}\tilde{A}^{(\sigma j)}_{i}" display="block"><mrow><msubsup><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>σ</mi></msubsup><mo>=</mo><mrow><msqrt><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt><mo>⁢</mo><msubsup><mover accent="true"><mi>A</mi><mo stretchy="false">~</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mrow><mi>σ</mi><mo>⁢</mo><mi>j</mi></mrow><mo stretchy="false">)</mo></mrow></msubsup></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td></tr>
</table>
<p class="ltx_p">This factor is called <span class="ltx_text ltx_font_smallcaps">coeff_leftSweep</span> in the implementation.
Notice that for the inverse reshaping process, one needs the inverse of this factor.
This factor has no different name but simply <span class="ltx_text ltx_font_smallcaps">coeff_leftSweep</span> is called with reversed quantum numbers.
When checking for the right-normalize condition one encounters also Eq. (<a href="#S5.E24" title="(24) ‣ 5.1 Sweep and reshape ‣ 5 Algorithms ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">24</span></a>).
Hence one has to encounter the factor from the CGC when checking the right-normalize condition:</p>
<table id="S5.E26" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E26.m1" class="ltx_Math" alttext="\sum_{\sigma j}A^{\sigma}_{ij}A^{\dagger\sigma}_{ij}\frac{2j+1}{2i+1}" display="block"><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>σ</mi><mo>⁢</mo><mi>j</mi></mrow></munder><mrow><msubsup><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mi>σ</mi></msubsup><mo>⁢</mo><msubsup><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow><mrow><mi/><mo>†</mo><mi>σ</mi></mrow></msubsup><mo>⁢</mo><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td></tr>
</table>
<p class="ltx_p">This factor is called <span class="ltx_text ltx_font_smallcaps">coeff_rightOrtho</span> in the implementation.</p>
</div>
</div>
<div id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">5.2 </span>Update <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS2.m1" class="ltx_Math" alttext="L" display="inline"><mi>L</mi></math></h3>

<div id="S5.SS2.p1" class="ltx_para">
<p class="ltx_p">For updating the left environment, we have the following equation:</p>
<table id="S5.E27" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E27.m1" class="ltx_Math" alttext="\boldsymbol{L}_{b_{l}}(l+1)=\sum_{\sigma_{l},\sigma_{l}^{\prime},a_{l}}%&#10;\boldsymbol{B}^{\sigma_{l}\dagger}(l)\boldsymbol{L}_{a_{l}}(l)\boldsymbol{A}^{%&#10;\sigma_{l}^{\prime}}(l)W^{\sigma_{l}\sigma_{l}^{\prime}}_{a_{l}b_{l}}(l)" display="block"><mrow><mrow><msub><mi>𝑳</mi><msub><mi>b</mi><mi>l</mi></msub></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>σ</mi><mi>l</mi></msub><mo>,</mo><msubsup><mi>σ</mi><mi>l</mi><mo>′</mo></msubsup><mo>,</mo><msub><mi>a</mi><mi>l</mi></msub></mrow></munder><mrow><msup><mi>𝑩</mi><mrow><msub><mi>σ</mi><mi>l</mi></msub><mo>⁣</mo><mo>†</mo></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>𝑳</mi><msub><mi>a</mi><mi>l</mi></msub></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msup><mi>𝑨</mi><msubsup><mi>σ</mi><mi>l</mi><mo>′</mo></msubsup></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msubsup><mi>W</mi><mrow><msub><mi>a</mi><mi>l</mi></msub><mo>⁢</mo><msub><mi>b</mi><mi>l</mi></msub></mrow><mrow><msub><mi>σ</mi><mi>l</mi></msub><mo>⁢</mo><msubsup><mi>σ</mi><mi>l</mi><mo>′</mo></msubsup></mrow></msubsup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td></tr>
</table>
<p class="ltx_p">Inserting all the CGC for the tensors, the CGC part of this equation reads:
</p>
<table id="S5.E28" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E28.m1" class="ltx_Math" alttext="C^{i^{\prime}a^{\prime}\rightarrow j^{\prime}}_{m_{i^{\prime}},m_{a^{\prime}}%&#10;\rightarrow m_{j^{\prime}}}=\sum_{m_{\sigma_{1}},m_{\sigma_{2}},m_{i},m_{a},m_%&#10;{j},m_{k}}C^{j,\sigma_{1}\rightarrow j^{\prime}}_{m_{j},m_{\sigma_{1}}%&#10;\rightarrow m_{j^{\prime}}}C^{ia\rightarrow j}_{m_{i},m_{a}\rightarrow m_{j}}C%&#10;^{i,\sigma_{2}\rightarrow i^{\prime}}_{m_{i},m_{\sigma_{2}}\rightarrow m_{i^{%&#10;\prime}}}C^{\sigma_{2},k\rightarrow\sigma_{1}}_{m_{\sigma_{2}},m_{k}%&#10;\rightarrow m_{\sigma_{1}}}C^{a,k\rightarrow a^{\prime}}_{m_{a},m_{k}%&#10;\rightarrow m_{a^{\prime}}}" display="block"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup><mo>=</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></munder><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>j</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><msup><mi>i</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>a</mi><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msup><mi>a</mi><mo>′</mo></msup></mrow></msubsup></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td></tr>
</table>
<p class="ltx_p">We can multiply this equation with <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS2.p1.m1" class="ltx_Math" alttext="C^{i^{\prime}a^{\prime}\rightarrow J^{\prime}}_{m_{i^{\prime}},m_{a^{\prime}}%&#10;\rightarrow m_{J^{\prime}}}" display="inline"><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>→</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msubsup></math>
and sum over <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS2.p1.m2" class="ltx_Math" alttext="m_{i^{\prime}}" display="inline"><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS2.p1.m3" class="ltx_Math" alttext="m_{a^{\prime}}" display="inline"><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></math>. The left hand side is then <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS2.p1.m4" class="ltx_Math" alttext="\delta_{j^{\prime}J^{\prime}}\delta_{m_{j^{\prime}}m_{J^{\prime}}}" display="inline"><mrow><msub><mi>δ</mi><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub><mo>⁢</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow></msub></mrow></math>
and the right side becomes:</p>
<table id="S5.E29" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E29.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\delta_{j^{\prime}J^{\prime}}\delta_{m_{j^{\prime}}m%&#10;_{J^{\prime}}}&amp;\displaystyle=\sum_{m_{\sigma_{1}},m_{\sigma_{2}},m_{i},m_{a},m%&#10;_{j},m_{k},m_{i^{\prime}},m_{a^{\prime}}}\\&#10;&amp;\displaystyle C^{i,\sigma_{2}\rightarrow i^{\prime}}_{m_{i},m_{\sigma_{2}}%&#10;\rightarrow m_{i^{\prime}}}C^{a,k\rightarrow a^{\prime}}_{m_{a},m_{k}%&#10;\rightarrow m_{a^{\prime}}}C^{i^{\prime}a^{\prime}\rightarrow j^{\prime}}_{m_{%&#10;i^{\prime}},m_{a^{\prime}}\rightarrow m_{j^{\prime}}}\\&#10;&amp;\displaystyle C^{ia\rightarrow j}_{m_{i},m_{a}\rightarrow m_{j}}C^{\sigma_{2}%&#10;,k\rightarrow\sigma_{1}}_{m_{\sigma_{2}},m_{k}\rightarrow m_{\sigma_{1}}}C^{j,%&#10;\sigma_{1}\rightarrow J^{\prime}}_{m_{j},m_{\sigma_{1}}\rightarrow m_{J^{%&#10;\prime}}}\\&#10;&amp;\displaystyle=\begin{bmatrix}i&amp;\sigma_{2}&amp;i^{\prime}\\&#10;a&amp;k&amp;a^{\prime}\\&#10;j&amp;\sigma_{1}&amp;j^{\prime}\end{bmatrix}\delta_{j^{\prime}J^{\prime}}\delta_{m_{j^%&#10;{\prime}}m_{J^{\prime}}}\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><msub><mi>δ</mi><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub><mo>⁢</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow></msub></mrow></mtd><mtd columnalign="left"><mrow><mi/><mo>=</mo><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub><mo>,</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow></munder></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><msup><mi>i</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>a</mi><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msup><mi>a</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>j</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mi/><mo>=</mo><mrow><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><mi>i</mi></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msup><mi>i</mi><mo>′</mo></msup></mtd></mtr><mtr><mtd columnalign="center"><mi>a</mi></mtd><mtd columnalign="center"><mi>k</mi></mtd><mtd columnalign="center"><msup><mi>a</mi><mo>′</mo></msup></mtd></mtr><mtr><mtd columnalign="center"><mi>j</mi></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msup><mi>j</mi><mo>′</mo></msup></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><msub><mi>δ</mi><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub><mo>⁢</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow></msub></mrow></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(29)</span></td></tr>
</table>
<p class="ltx_p">Which is easily obtained when analysing that the visual structure fits the requirements for the recoupling coeff in Eq. (<a href="#S2.E4" title="(4) ‣ 2 ⁢ 6 j , ⁢ 9 j and recoupling symbols ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
This coeffecient is called <span class="ltx_text ltx_font_smallcaps">coeff_buildL</span>.</p>
</div>
</div>
<div id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">5.3 </span>Update <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS3.m1" class="ltx_Math" alttext="R" display="inline"><mi>R</mi></math></h3>

<div id="S5.SS3.p1" class="ltx_para">
<p class="ltx_p">The update of the right environment is similar.
Collecting all the CGC for the tensors, the CGC part reads:</p>
<table id="S5.E30" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E30.m1" class="ltx_Math" alttext="C^{ia\rightarrow j}_{m_{i},m_{a}\rightarrow m_{j}}=\sum_{m_{\sigma_{1}},m_{%&#10;\sigma_{2}},m_{j},m_{k},m_{i^{\prime}},m_{a^{\prime}}}C^{j,\sigma_{1}%&#10;\rightarrow j^{\prime}}_{m_{j},m_{\sigma_{1}}\rightarrow m_{j^{\prime}}}C^{i^{%&#10;\prime}a^{\prime}\rightarrow j^{\prime}}_{m_{i^{\prime}},m_{a^{\prime}}%&#10;\rightarrow m_{j^{\prime}}}C^{i,\sigma_{2}\rightarrow i^{\prime}}_{m_{i},m_{%&#10;\sigma_{2}}\rightarrow m_{i^{\prime}}}C^{\sigma_{2},k\rightarrow\sigma_{1}}_{m%&#10;_{\sigma_{2}},m_{k}\rightarrow m_{\sigma_{1}}}C^{a,k\rightarrow a^{\prime}}_{m%&#10;_{a},m_{k}\rightarrow m_{a^{\prime}}}" display="block"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup><mo>=</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub><mo>,</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow></munder><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>j</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><msup><mi>i</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>a</mi><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msup><mi>a</mi><mo>′</mo></msup></mrow></msubsup></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td></tr>
</table>
<p class="ltx_p">We can multiply this equation with <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS3.p1.m1" class="ltx_Math" alttext="C^{ia\rightarrow J}_{m_{i},m_{a}\rightarrow m_{J}}" display="inline"><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>J</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>J</mi></mrow></msubsup></math>
and sum over <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS3.p1.m2" class="ltx_Math" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS3.p1.m3" class="ltx_Math" alttext="m_{a}" display="inline"><msub><mi>m</mi><mi>a</mi></msub></math>. The left hand side is then <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS3.p1.m4" class="ltx_Math" alttext="\delta_{jJ}\delta_{m_{j}m_{J}}" display="inline"><mrow><msub><mi>δ</mi><mrow><mi>j</mi><mo>⁢</mo><mi>J</mi></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>J</mi></msub></mrow></msub></mrow></math>
and the right side becomes:</p>
<table id="S5.E31" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E31.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\delta_{j^{\prime}J^{\prime}}\delta_{m_{j^{\prime}}m%&#10;_{J^{\prime}}}&amp;\displaystyle=\sum_{m_{\sigma_{1}},m_{\sigma_{2}},m_{i},m_{a},m%&#10;_{j},m_{k},m_{i^{\prime}},m_{a^{\prime}}}\\&#10;&amp;\displaystyle C^{i,\sigma_{2}\rightarrow i^{\prime}}_{m_{i},m_{\sigma_{2}}%&#10;\rightarrow m_{i^{\prime}}}C^{a,k\rightarrow a^{\prime}}_{m_{a},m_{k}%&#10;\rightarrow m_{a^{\prime}}}C^{ia\rightarrow J}_{m_{i},m_{a}\rightarrow m_{J}}%&#10;\\&#10;&amp;\displaystyle C^{i^{\prime}a^{\prime}\rightarrow j^{\prime}}_{m_{i^{\prime}},%&#10;m_{a^{\prime}}\rightarrow m_{j^{\prime}}}C^{\sigma_{2},k\rightarrow\sigma_{1}}%&#10;_{m_{\sigma_{2}},m_{k}\rightarrow m_{\sigma_{1}}}C^{j,\sigma_{1}\rightarrow j^%&#10;{\prime}}_{m_{j},m_{\sigma_{1}}\rightarrow m_{j^{\prime}}}\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><msub><mi>δ</mi><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub><mo>⁢</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow></msub></mrow></mtd><mtd columnalign="left"><mrow><mi/><mo>=</mo><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub><mo>,</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow></munder></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><msup><mi>i</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>a</mi><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msup><mi>a</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>J</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>J</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>j</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td></tr>
</table>
<p class="ltx_p">This is not the correct structure for a recoupling coeff.
But the following steps will convert this into the form of Eq. (<a href="#S2.E4" title="(4) ‣ 2 ⁢ 6 j , ⁢ 9 j and recoupling symbols ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
Notice, that I will use <span class="ltx_text ltx_emph ltx_font_italic">coordinates</span> <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS3.p1.m5" class="ltx_Math" alttext="(i,j)" display="inline"><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></math> to refer to the CGC in this equation
where <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS3.p1.m6" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> is the row and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS3.p1.m7" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math> is the column.</p>
<ol id="S5.I1" class="ltx_enumerate">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p class="ltx_p">interchange <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i1.p1.m1" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i1.p1.m2" class="ltx_Math" alttext="i^{\prime}" display="inline"><msup><mi>i</mi><mo>′</mo></msup></math> for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i1.p1.m3" class="ltx_Math" alttext="(0,0)" display="inline"><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></math>. This gives a factor
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i1.p1.m4" class="ltx_Math" alttext="(-1)^{\sigma_{2}+m_{\sigma_{2}}}\sqrt{\frac{2i^{\prime}+1}{2i+1}}" display="inline"><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>+</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow></msup><mo>⁢</mo><msqrt><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><msup><mi>i</mi><mo>′</mo></msup></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt></mrow></math>.
Furthermore <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i1.p1.m5" class="ltx_Math" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i1.p1.m6" class="ltx_Math" alttext="m_{i^{\prime}}" display="inline"><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></math> goes into <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i1.p1.m7" class="ltx_Math" alttext="-m_{i}" display="inline"><mrow><mo>-</mo><msub><mi>m</mi><mi>i</mi></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i1.p1.m8" class="ltx_Math" alttext="-m_{i^{\prime}}" display="inline"><mrow><mo>-</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow></math>.</p>
</div></li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p class="ltx_p">interchange <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i2.p1.m1" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i2.p1.m2" class="ltx_Math" alttext="j^{\prime}" display="inline"><msup><mi>j</mi><mo>′</mo></msup></math> for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i2.p1.m3" class="ltx_Math" alttext="(1,2)" display="inline"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></math>. This gives a factor
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i2.p1.m4" class="ltx_Math" alttext="(-1)^{\sigma_{1}+m_{\sigma_{1}}}\sqrt{\frac{2j^{\prime}+1}{2j+1}}" display="inline"><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><msub><mi>σ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow></msup><mo>⁢</mo><msqrt><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><msup><mi>j</mi><mo>′</mo></msup></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt></mrow></math>.
Furthermore <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i2.p1.m5" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi>m</mi><mi>j</mi></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i2.p1.m6" class="ltx_Math" alttext="m_{j^{\prime}}" display="inline"><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></math> goes into <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i2.p1.m7" class="ltx_Math" alttext="-m_{j}" display="inline"><mrow><mo>-</mo><msub><mi>m</mi><mi>j</mi></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i2.p1.m8" class="ltx_Math" alttext="-m_{j^{\prime}}" display="inline"><mrow><mo>-</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow></math>.</p>
</div></li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p class="ltx_p">interchange <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i3.p1.m1" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i3.p1.m2" class="ltx_Math" alttext="a^{\prime}" display="inline"><msup><mi>a</mi><mo>′</mo></msup></math> for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i3.p1.m3" class="ltx_Math" alttext="(0,1)" display="inline"><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math>. This gives a factor
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i3.p1.m4" class="ltx_Math" alttext="(-1)^{k+m_{k}}\sqrt{\frac{2a^{\prime}+1}{2a+1}}" display="inline"><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></msup><mo>⁢</mo><msqrt><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>a</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></msqrt></mrow></math>.
Furthermore <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i3.p1.m5" class="ltx_Math" alttext="m_{a}" display="inline"><msub><mi>m</mi><mi>a</mi></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i3.p1.m6" class="ltx_Math" alttext="m_{a^{\prime}}" display="inline"><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></math> goes into <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i3.p1.m7" class="ltx_Math" alttext="-m_{a}" display="inline"><mrow><mo>-</mo><msub><mi>m</mi><mi>a</mi></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i3.p1.m8" class="ltx_Math" alttext="-m_{a^{\prime}}" display="inline"><mrow><mo>-</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow></math>.</p>
</div></li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p class="ltx_p">Flip all signs of the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m1" class="ltx_Math" alttext="m" display="inline"><mi>m</mi></math> quantum numbers for the CGC in <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m2" class="ltx_Math" alttext="(0,0)" display="inline"><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m3" class="ltx_Math" alttext="(1,1)" display="inline"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m4" class="ltx_Math" alttext="(1,2)" display="inline"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m5" class="ltx_Math" alttext="(0,1)" display="inline"><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math>.
This gives four phase factors: <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m6" class="ltx_Math" alttext="(-1)^{i^{\prime}+\sigma_{2}-i}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>+</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>-</mo><mi>i</mi></mrow></msup></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m7" class="ltx_Math" alttext="(-1)^{\sigma_{2}+k-\sigma_{1}}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>+</mo><mi>k</mi></mrow><mo>-</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msup></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m8" class="ltx_Math" alttext="(-1)^{j^{\prime}+\sigma_{1}-j}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>+</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>-</mo><mi>j</mi></mrow></msup></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i4.p1.m9" class="ltx_Math" alttext="(-1)^{a^{\prime}+k-a}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msup><mi>a</mi><mo>′</mo></msup><mo>+</mo><mi>k</mi></mrow><mo>-</mo><mi>a</mi></mrow></msup></math>.</p>
</div></li>
<li id="S5.I1.i5" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">5.</span> 
<div id="S5.I1.i5.p1" class="ltx_para">
<p class="ltx_p">The signs <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m1" class="ltx_Math" alttext="(-1)^{\sigma_{2}+m_{\sigma_{2}}}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>+</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow></msup></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m2" class="ltx_Math" alttext="(-1)^{\sigma_{1}+m_{\sigma_{1}}}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><msub><mi>σ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow></msup></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m3" class="ltx_Math" alttext="(-1)^{k+m_{k}}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></msup></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m4" class="ltx_Math" alttext="(-1)^{\sigma_{2}+k-\sigma_{1}}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>+</mo><mi>k</mi></mrow><mo>-</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msup></math>
gives in total <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m5" class="ltx_Math" alttext="+1" display="inline"><mrow><mo>+</mo><mn>1</mn></mrow></math>. This can be seen when noting that <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m6" class="ltx_Math" alttext="m_{\sigma_{1}}=m_{\sigma_{2}}+m_{k}" display="inline"><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>=</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>+</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></mrow></math> (because of the corresponding CGC) and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m7" class="ltx_Math" alttext="(-1)^{2(j+m_{j})}=1" display="inline"><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>j</mi><mo>+</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></msup><mo>=</mo><mn>1</mn></mrow></math>
for any <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m8" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i5.p1.m9" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi>m</mi><mi>j</mi></msub></math> which belong together.</p>
</div></li>
<li id="S5.I1.i6" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">6.</span> 
<div id="S5.I1.i6.p1" class="ltx_para">
<p class="ltx_p">All <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i6.p1.m1" class="ltx_Math" alttext="m" display="inline"><mi>m</mi></math>-dependent factors disappear and the sum over the resulting CGC give a recoupling coeff:</p>
<table id="S5.E32" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E32.m1" class="ltx_Math" alttext="\begin{bmatrix}i^{\prime}&amp;\sigma_{2}&amp;i\\&#10;a^{\prime}&amp;k&amp;a\\&#10;j^{\prime}&amp;\sigma_{1}&amp;j\end{bmatrix}" display="block"><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><msup><mi>i</mi><mo>′</mo></msup></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><mi>i</mi></mtd></mtr><mtr><mtd columnalign="center"><msup><mi>a</mi><mo>′</mo></msup></mtd><mtd columnalign="center"><mi>k</mi></mtd><mtd columnalign="center"><mi>a</mi></mtd></mtr><mtr><mtd columnalign="center"><msup><mi>j</mi><mo>′</mo></msup></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><mi>j</mi></mtd></mtr></mtable><mo>]</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(32)</span></td></tr>
</table>
<p class="ltx_p">together with the factor:</p>
<table id="S5.E33" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E33.m1" class="ltx_Math" alttext="(-1)^{i^{\prime}+\sigma_{2}-i}(-1)^{j^{\prime}+\sigma_{1}-j}(-1)^{a^{\prime}+k%&#10;-a}\sqrt{\frac{(2i^{\prime}+1)(2j^{\prime}+1)(2a^{\prime}+1)}{(2i+1)(2j+1)(2a+%&#10;1)}}" display="block"><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>+</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>-</mo><mi>i</mi></mrow></msup><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>+</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>-</mo><mi>j</mi></mrow></msup><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msup><mi>a</mi><mo>′</mo></msup><mo>+</mo><mi>k</mi></mrow><mo>-</mo><mi>a</mi></mrow></msup><mo>⁢</mo><msqrt><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msup><mi>i</mi><mo>′</mo></msup></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msup><mi>j</mi><mo>′</mo></msup></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>a</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></msqrt></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(33)</span></td></tr>
</table>
</div></li>
<li id="S5.I1.i7" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">7.</span> 
<div id="S5.I1.i7.p1" class="ltx_para">
<p class="ltx_p">Convert the recoupling coeff to a <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i7.p1.m1" class="ltx_Math" alttext="9j" display="inline"><mrow><mn>9</mn><mo>⁢</mo><mi>j</mi></mrow></math>-symbol by Eq. (<a href="#S2.E5" title="(5) ‣ 2 ⁢ 6 j , ⁢ 9 j and recoupling symbols ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).
Interchange the first and the last column of the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i7.p1.m2" class="ltx_Math" alttext="9j" display="inline"><mrow><mn>9</mn><mo>⁢</mo><mi>j</mi></mrow></math>-symbol. This gives a phase factor given by the sum af all
quantum numbers in the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.I1.i7.p1.m3" class="ltx_Math" alttext="9j" display="inline"><mrow><mn>9</mn><mo>⁢</mo><mi>j</mi></mrow></math>-symbol. Converting back to a recoupl coeff giv the final coefficient used for
the update of the right environment:</p>
<table id="S5.E34" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E34.m1" class="ltx_Math" alttext="\frac{2j^{\prime}+1}{2j+1}\begin{bmatrix}i&amp;\sigma_{2}&amp;i^{\prime}\\&#10;a&amp;k&amp;a^{\prime}\\&#10;j&amp;\sigma_{1}&amp;j^{\prime}\end{bmatrix}" display="block"><mrow><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><msup><mi>j</mi><mo>′</mo></msup></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><mi>i</mi></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msup><mi>i</mi><mo>′</mo></msup></mtd></mtr><mtr><mtd columnalign="center"><mi>a</mi></mtd><mtd columnalign="center"><mi>k</mi></mtd><mtd columnalign="center"><msup><mi>a</mi><mo>′</mo></msup></mtd></mtr><mtr><mtd columnalign="center"><mi>j</mi></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msup><mi>j</mi><mo>′</mo></msup></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(34)</span></td></tr>
</table>
<p class="ltx_p">This coefficient is called <span class="ltx_text ltx_font_smallcaps">coeff_buildR</span> in the implementation.</p>
</div></li>
</ol>
</div>
</div>
<div id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">5.4 </span>Apply <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS4.m1" class="ltx_Math" alttext="H_{eff}" display="inline"><msub><mi>H</mi><mrow><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>f</mi></mrow></msub></math></h3>

<div id="S5.SS4.p1" class="ltx_para">
<p class="ltx_p">For the effective Hamiltonian the CGC part reads:</p>
<table id="S5.E35" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E35.m1" class="ltx_Math" alttext="C^{j,\sigma_{1}\rightarrow j^{\prime}}_{m_{j},m_{\sigma_{1}}\rightarrow m_{j^{%&#10;\prime}}}=\sum_{m_{\sigma_{1}},m_{\sigma_{2}},m_{i},m_{a},m_{j},m_{k}}C^{i^{%&#10;\prime}a^{\prime}\rightarrow j^{\prime}}_{m_{i^{\prime}},m_{a^{\prime}}%&#10;\rightarrow m_{j^{\prime}}}C^{ia\rightarrow j}_{m_{i},m_{a}\rightarrow m_{j}}C%&#10;^{i,\sigma_{2}\rightarrow i^{\prime}}_{m_{i},m_{\sigma_{2}}\rightarrow m_{i^{%&#10;\prime}}}C^{\sigma_{2},k\rightarrow\sigma_{1}}_{m_{\sigma_{2}},m_{k}%&#10;\rightarrow m_{\sigma_{1}}}C^{a,k\rightarrow a^{\prime}}_{m_{a},m_{k}%&#10;\rightarrow m_{a^{\prime}}}" display="block"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>j</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup><mo>=</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></munder><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><msup><mi>i</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>a</mi><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msup><mi>a</mi><mo>′</mo></msup></mrow></msubsup></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(35)</span></td></tr>
</table>
<p class="ltx_p">We can multiply this equation with <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS4.p1.m1" class="ltx_Math" alttext="C^{j,\sigma_{1}\rightarrow J^{\prime}}_{m_{j},m_{\sigma_{1}}\rightarrow m_{J^{%&#10;\prime}}}" display="inline"><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>j</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msubsup></math>
and sum over <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS4.p1.m2" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi>m</mi><mi>j</mi></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS4.p1.m3" class="ltx_Math" alttext="m_{\sigma_{1}}" display="inline"><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></math>. The left hand side is then <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS4.p1.m4" class="ltx_Math" alttext="\delta_{j^{\prime}J^{\prime}}\delta_{m_{j^{\prime}}m_{J^{\prime}}}" display="inline"><mrow><msub><mi>δ</mi><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub><mo>⁢</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow></msub></mrow></math>
and the right side becomes:</p>
<table id="S5.E36" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E36.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\delta_{j^{\prime}J^{\prime}}\delta_{m_{j^{\prime}}m%&#10;_{J^{\prime}}}&amp;\displaystyle=\sum_{m_{\sigma_{1}},m_{\sigma_{2}},m_{i},m_{a},m%&#10;_{j},m_{k},m_{i^{\prime}},m_{a^{\prime}}}\\&#10;&amp;\displaystyle C^{i,\sigma_{2}\rightarrow i^{\prime}}_{m_{i},m_{\sigma_{2}}%&#10;\rightarrow m_{i^{\prime}}}C^{a,k\rightarrow a^{\prime}}_{m_{a},m_{k}%&#10;\rightarrow m_{a^{\prime}}}C^{i^{\prime}a^{\prime}\rightarrow j^{\prime}}_{m_{%&#10;i^{\prime}},m_{a^{\prime}}\rightarrow m_{j^{\prime}}}\\&#10;&amp;\displaystyle C^{ia\rightarrow j}_{m_{i},m_{a}\rightarrow m_{j}}C^{\sigma_{2}%&#10;,k\rightarrow\sigma_{1}}_{m_{\sigma_{2}},m_{k}\rightarrow m_{\sigma_{1}}}C^{j,%&#10;\sigma_{1}\rightarrow J^{\prime}}_{m_{j},m_{\sigma_{1}}\rightarrow m_{J^{%&#10;\prime}}}\\&#10;&amp;\displaystyle=\begin{bmatrix}i&amp;\sigma_{2}&amp;i^{\prime}\\&#10;a&amp;k&amp;a^{\prime}\\&#10;j&amp;\sigma_{1}&amp;j^{\prime}\end{bmatrix}\delta_{j^{\prime}J^{\prime}}\delta_{m_{j^%&#10;{\prime}}m_{J^{\prime}}}\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><msub><mi>δ</mi><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub><mo>⁢</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow></msub></mrow></mtd><mtd columnalign="left"><mrow><mi/><mo>=</mo><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub><mo>,</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow></munder></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><msup><mi>i</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>a</mi></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>a</mi><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msup><mi>a</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msup><mi>a</mi><mo>′</mo></msup></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>a</mi><mo>′</mo></msup></mrow><mo>→</mo><msup><mi>j</mi><mo>′</mo></msup></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>a</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>⁢</mo><mi>a</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>j</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mi/><mo>=</mo><mrow><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><mi>i</mi></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><msup><mi>i</mi><mo>′</mo></msup></mtd></mtr><mtr><mtd columnalign="center"><mi>a</mi></mtd><mtd columnalign="center"><mi>k</mi></mtd><mtd columnalign="center"><msup><mi>a</mi><mo>′</mo></msup></mtd></mtr><mtr><mtd columnalign="center"><mi>j</mi></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msup><mi>j</mi><mo>′</mo></msup></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><msub><mi>δ</mi><mrow><msup><mi>j</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>J</mi><mo>′</mo></msup></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><msup><mi>j</mi><mo>′</mo></msup></msub><mo>⁢</mo><msub><mi>m</mi><msup><mi>J</mi><mo>′</mo></msup></msub></mrow></msub></mrow></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(36)</span></td></tr>
</table>
<p class="ltx_p">Which is easily obtained when analysing that the visual structure fits the requirements for the recoupling coeff in Eq. (<a href="#S2.E4" title="(4) ‣ 2 ⁢ 6 j , ⁢ 9 j and recoupling symbols ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
This coeffecient is called <span class="ltx_text ltx_font_smallcaps">coeff_HPsi</span>. It is identical to <span class="ltx_text ltx_font_smallcaps">coeff_buildL</span>.</p>
</div>
</div>
<div id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">5.5 </span>MPS product</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p class="ltx_p">The product of two MPS is obtained by the product over the auxiliary space and the combination
of <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS5.p1.m1" class="ltx_Math" alttext="\sigma_{1}" display="inline"><msub><mi>σ</mi><mn>1</mn></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS5.p1.m2" class="ltx_Math" alttext="\sigma_{2}" display="inline"><msub><mi>σ</mi><mn>2</mn></msub></math> to a combined index <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS5.p1.m3" class="ltx_Math" alttext="\sigma" display="inline"><mi>σ</mi></math>.
The CGC part of this operation reads:</p>
<table id="S5.E37" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E37.m1" class="ltx_Math" alttext="C^{i,\sigma\rightarrow j}_{m_{i},m_{\sigma}\rightarrow m_{j}}=\sum_{m_{\sigma_%&#10;{1}},m_{\sigma_{2}},m_{i^{\prime}}}C^{i,\sigma_{1}\rightarrow i^{\prime}}_{m_{%&#10;i},m_{\sigma_{1}}\rightarrow m_{i^{\prime}}}C^{i^{\prime},\sigma_{2}%&#10;\rightarrow j}_{m_{i^{\prime}},m_{\sigma_{2}}\rightarrow m_{j}}C^{\sigma_{1}%&#10;\sigma_{2}\rightarrow\sigma}_{m_{\sigma_{1}}m_{\sigma_{2}}\rightarrow m_{%&#10;\sigma}}" display="block"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><mi>σ</mi></mrow><mo>→</mo><mi>j</mi></mrow></msubsup><mo>=</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow></munder><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>i</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>j</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>σ</mi></mrow></msubsup></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(37)</span></td></tr>
</table>
<p class="ltx_p">Again we bring the CGC from the left side to the right side by using a orthonormality equation for the CGC
and obtain:</p>
<table id="S5.E38" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.E38.m1" class="ltx_Math" alttext="\begin{split}\displaystyle\delta_{jJ}\delta_{m_{j}m_{J}}&amp;\displaystyle=\sum_{m%&#10;_{\sigma_{1}},m_{\sigma_{2}},m_{i^{\prime}},m_{i},m_{\sigma}}\\&#10;&amp;\displaystyle C^{i,\sigma_{1}\rightarrow i^{\prime}}_{m_{i},m_{\sigma_{1}}%&#10;\rightarrow m_{i^{\prime}}}C^{i^{\prime},\sigma_{2}\rightarrow j}_{m_{i^{%&#10;\prime}},m_{\sigma_{2}}\rightarrow m_{j}}\\&#10;&amp;\displaystyle C^{i,\sigma\rightarrow J}_{m_{i},m_{\sigma}\rightarrow m_{J}}C^%&#10;{\sigma_{1}\sigma_{2}\rightarrow\sigma}_{m_{\sigma_{1}}m_{\sigma_{2}}%&#10;\rightarrow m_{\sigma}}\\&#10;&amp;\displaystyle=\begin{bmatrix}i&amp;\sigma_{1}&amp;i^{\prime}\\&#10;\sigma_{2}&amp;j&amp;\sigma\end{bmatrix}\delta_{jJ}\delta_{m_{j}m_{J}}\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="right"><mrow><msub><mi>δ</mi><mrow><mi>j</mi><mo>⁢</mo><mi>J</mi></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>J</mi></msub></mrow></msub></mrow></mtd><mtd columnalign="left"><mrow><mi/><mo>=</mo><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow></munder></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow><mo>→</mo><msup><mi>i</mi><mo>′</mo></msup></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msup><mi>i</mi><mo>′</mo></msup></msub><mo>,</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>j</mi></msub></mrow><mrow><mrow><msup><mi>i</mi><mo>′</mo></msup><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>j</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>,</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>J</mi></msub></mrow><mrow><mrow><mi>i</mi><mo>,</mo><mi>σ</mi></mrow><mo>→</mo><mi>J</mi></mrow></msubsup><mo>⁢</mo><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub><mo>⁢</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub></mrow><mo>→</mo><msub><mi>m</mi><mi>σ</mi></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>σ</mi><mn>2</mn></msub></mrow><mo>→</mo><mi>σ</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mi/><mo>=</mo><mrow><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><mi>i</mi></mtd><mtd columnalign="center"><msub><mi>σ</mi><mn>1</mn></msub></mtd><mtd columnalign="center"><msup><mi>i</mi><mo>′</mo></msup></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>σ</mi><mn>2</mn></msub></mtd><mtd columnalign="center"><mi>j</mi></mtd><mtd columnalign="center"><mi>σ</mi></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><msub><mi>δ</mi><mrow><mi>j</mi><mo>⁢</mo><mi>J</mi></mrow></msub><mo>⁢</mo><msub><mi>δ</mi><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>⁢</mo><msub><mi>m</mi><mi>J</mi></msub></mrow></msub></mrow></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(38)</span></td></tr>
</table>
<p class="ltx_p">The recoupl coeff is related to the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS5.p1.m4" class="ltx_Math" alttext="6j" display="inline"><mrow><mn>6</mn><mo>⁢</mo><mi>j</mi></mrow></math>-symbol and this coefficient
for the product of two <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS5.p1.m5" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>-tensors is called <span class="ltx_text ltx_font_smallcaps">coeff_Apair</span>
in the implementation. Notice, that this is different to <span class="ltx_text ltx_font_smallcaps">coeff_prod</span> (Eq. (<a href="#S3.E13" title="(13) ‣ 3.1 Product of tensor operators ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>)).
This is because of our convention for the <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS5.p1.m6" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>-tensors.</p>
</div>
</div>
<div id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">5.6 </span>MPO product</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p class="ltx_p">Multiplying two MPOs means the product in the auxiliary space and the tensor product in the
physical space. Since our convention for the auxiliary indices is the same as for the MPS,
the coefficient for the product in the auxiliary space is exactly <span class="ltx_text ltx_font_smallcaps">coeff_Apair</span>.
The tensor product in the physical space is identical to <span class="ltx_text ltx_font_smallcaps">coeff_tensorProd</span>
(which is not included in the doc yet)
since the convention for the physical part of the MPO is <math xmlns="http://www.w3.org/1998/Math/MathML" id="S5.SS6.p1.m1" class="ltx_Math" alttext="C^{\sigma_{2},k\rightarrow\sigma_{1}}_{m_{\sigma_{2}},m_{k}\rightarrow m_{%&#10;\sigma_{1}}}" display="inline"><msubsup><mi>C</mi><mrow><mrow><msub><mi>m</mi><msub><mi>σ</mi><mn>2</mn></msub></msub><mo>,</mo><msub><mi>m</mi><mi>k</mi></msub></mrow><mo>→</mo><msub><mi>m</mi><msub><mi>σ</mi><mn>1</mn></msub></msub></mrow><mrow><mrow><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>k</mi></mrow><mo>→</mo><msub><mi>σ</mi><mn>1</mn></msub></mrow></msubsup></math>
which is as for normal tensor operators (Eq. (<a href="#S3.E6" title="(6) ‣ 3 Wigner-Eckart ‣ CGC for DMRG" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>)).
The total coefficient is simply the product of both.</p>
</div>
</div>
<div id="S5.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">5.7 </span>MPO times MPS</h3>

<div id="S5.SS7.p1" class="ltx_para">
<p class="ltx_p">For this operation, the structure is completely identical to the action of the effective Hamiltonian.
This is due to our definition of the CGC structure of the environment.
The coefficient is therefore identical to <span class="ltx_text ltx_font_smallcaps">coeff_HPsi</span>.
In the implementation, it has an extra name: <span class="ltx_text ltx_font_smallcaps">coeff_AW</span>.</p>
</div>
</div>
</div>
<div id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">6 </span>Todo</h2>

<div id="S6.p1" class="ltx_para">
<ol id="S6.I1" class="ltx_enumerate">
<li id="S6.I1.i1" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S6.I1.i1.p1" class="ltx_para">
<p class="ltx_p">Add graphical visualizations of the different contractions.</p>
</div></li>
<li id="S6.I1.i2" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S6.I1.i2.p1" class="ltx_para">
<p class="ltx_p">Describe the local operators and their reduced matrix elements.</p>
</div></li>
<li id="S6.I1.i3" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S6.I1.i3.p1" class="ltx_para">
<p class="ltx_p">Describe the tensor product of tensor operators for the coefficient <span class="ltx_text ltx_font_smallcaps">coeff_tensorProd</span>.</p>
</div></li>
<li id="S6.I1.i4" class="ltx_item" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S6.I1.i4.p1" class="ltx_para">
<p class="ltx_p">Think about recoupling of five irreps and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S6.I1.i4.p1.m1" class="ltx_Math" alttext="12j" display="inline"><mrow><mn>12</mn><mo>⁢</mo><mi>j</mi></mrow></math>-symbols. What is problem here?</p>
</div></li>
</ol>
</div>
</div>
</div>
</div>
<div class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Feb 10 14:09:06 2019 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"/></a></div></div>
</div>
</body>
</html>
