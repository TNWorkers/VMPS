<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VMPS++: MpoTerms.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
$darkmode
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.lightModeIcon = '🌞'
// icon from https://fonts.google.com/icons
  DoxygenAwesomeDarkModeToggle.darkModeIcon = `<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#009793"><g><rect fill="none" height="24" width="24"/></g><g><g><path d="M8.1,14.15C9.77,14.63,11,16.17,11,18c0,0.68-0.19,1.31-0.48,1.87c0.48,0.09,0.97,0.14,1.48,0.14 c1.48,0,2.9-0.41,4.13-1.15c-2.62-0.92-5.23-2.82-6.8-5.86C7.74,9.94,7.78,7.09,8.29,4.9c-2.57,1.33-4.3,4.01-4.3,7.1c0,0,0,0,0,0 c0.01,0,0.01,0,0.02,0C5.66,12,7.18,12.83,8.1,14.15z" opacity=".3"/><path d="M19.78,17.51c-2.47,0-6.57-1.33-8.68-5.43C8.77,7.57,10.6,3.6,11.63,2.01C6.27,2.2,1.98,6.59,1.98,12 c0,0.14,0.02,0.28,0.02,0.42C2.61,12.16,3.28,12,3.98,12c0,0,0,0,0,0c0-3.09,1.73-5.77,4.3-7.1C7.78,7.09,7.74,9.94,9.32,13 c1.57,3.04,4.18,4.95,6.8,5.86c-1.23,0.74-2.65,1.15-4.13,1.15c-0.5,0-1-0.05-1.48-0.14c-0.37,0.7-0.94,1.27-1.64,1.64 c0.98,0.32,2.03,0.5,3.11,0.5c3.5,0,6.58-1.8,8.37-4.52C20.18,17.5,19.98,17.51,19.78,17.51z"/><path d="M7,16l-0.18,0C6.4,14.84,5.3,14,4,14c-1.66,0-3,1.34-3,3s1.34,3,3,3c0.62,0,2.49,0,3,0c1.1,0,2-0.9,2-2 C9,16.9,8.1,16,7,16z"/></g></g></svg>`
  DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/tnworkers/VMPS" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VMPS++
   </div>
  </td>
 </tr>
   <!--BEGIN FULL_SIDEBAR-->
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
   <!--END FULL_SIDEBAR-->
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.html','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('MpoTerms_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MpoTerms.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="MpoTerms_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef DMRG_HAMILTONIAN_TERMS</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define DMRG_HAMILTONIAN_TERMS</span></div>
<div class="line"><a name="l00003"></a><span class="lineno"><a class="line" href="MpoTerms_8h.html#a4962bceade5775b0464f7b604f886cd4">    3</a></span>&#160;<span class="preprocessor">#define EIGEN_DONT_VECTORIZE</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#ifndef DEBUG_VERBOSITY</span></div>
<div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="MpoTerms_8h.html#a2756127335810471fc2ea8b84538f693">    5</a></span>&#160;<span class="preprocessor">#define DEBUG_VERBOSITY 0</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#ifndef MAX_SUMPROD_STRINGLENGTH</span></div>
<div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="MpoTerms_8h.html#a5b138ca20fd685462fbb27038ee41fd2">    9</a></span>&#160;<span class="preprocessor">#define MAX_SUMPROD_STRINGLENGTH 700</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;boost/multi_array.hpp&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;numeric_limits.h&quot;</span> <span class="comment">// from TOOLS</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;Stopwatch.h&quot;</span> <span class="comment">// from TOOLS</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SiteOperator_8h.html">tensors/SiteOperator.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="qarray_8h.html">symmetry/qarray.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Qbasis_8h.html">tensors/Qbasis.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Biped_8h.html">tensors/Biped.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;MemCalc.h&quot;</span> <span class="comment">// from TOOLS</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifdef USE_HDF5_STORAGE</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">    #include &lt;HDF5Interface.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="namespaceMPO__STATUS.html">   29</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceMPO__STATUS.html">MPO_STATUS</a></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">   31</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1a">OPTION</a> {<a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">ALTERABLE</a>=0, <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">FINALIZED</a>=1};</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classMpoTerms.html">   34</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keyword">class </span><a class="code" href="classMpoTerms.html">MpoTerms</a></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classMpoTerms.html#acb033ecc518224cc12a53b9db315a823">   37</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structSiteOperator.html">SiteOperator&lt;Symmetry,Scalar&gt;</a> <a class="code" href="classMpoTerms.html#acb033ecc518224cc12a53b9db315a823">OperatorType</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">   38</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> Symmetry::qType <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ab7be76c72cfd76e91404ffd0b0563a76">   39</a></span>&#160;    <span class="keyword">typedef</span> Eigen::SparseMatrix&lt;Scalar,Eigen::ColMajor,EIGEN_DEFAULT_SPARSE_INDEX_TYPE&gt; <a class="code" href="classMpoTerms.html#ab7be76c72cfd76e91404ffd0b0563a76">MatrixType</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a252f0e3ea06be953db7c3d2c7e7bfd91">   47</a></span>&#160;    std::vector&lt;std::map&lt;std::array&lt;qType, 2&gt;,std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#a252f0e3ea06be953db7c3d2c7e7bfd91">O</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a72acc8fe854f6a6d3c07c0ca5cd954d1">   55</a></span>&#160;    std::vector&lt;std::map&lt;qType, std::size_t&gt;&gt; <a class="code" href="classMpoTerms.html#a72acc8fe854f6a6d3c07c0ca5cd954d1">auxdim</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">   60</a></span>&#160;    <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> <a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a48be912d55d82e2e076d0dfacce41e8a">   65</a></span>&#160;    <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> <a class="code" href="classMpoTerms.html#a48be912d55d82e2e076d0dfacce41e8a">qVac</a> = Symmetry::qvacuum();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a666f0aa6a2f44a1343f3ab2311f752e0">   70</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#a666f0aa6a2f44a1343f3ab2311f752e0">pos_qTot</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    </div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a49308f057c4dc419d4c0301be82e5e70">   75</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#a49308f057c4dc419d4c0301be82e5e70">pos_qVac</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    </div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aed405248ce8b76b63451b039f9d812c7">   80</a></span>&#160;    <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> <a class="code" href="classMpoTerms.html#aed405248ce8b76b63451b039f9d812c7">boundary_condition</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    </div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a0f625a2568ae261d1e4e81579b046181">   86</a></span>&#160;    std::vector&lt;std::vector&lt;std::string&gt;&gt; <a class="code" href="classMpoTerms.html#a0f625a2568ae261d1e4e81579b046181">info</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a065ff86f35239f072106349fe9135923">   92</a></span>&#160;    std::vector&lt;int&gt; <a class="code" href="classMpoTerms.html#a065ff86f35239f072106349fe9135923">hilbert_dimension</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a52f993c8c9004988c5b50b21955b4d26">   97</a></span>&#160;    <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1a">MPO_STATUS::OPTION</a> <a class="code" href="classMpoTerms.html#a52f993c8c9004988c5b50b21955b4d26">status</a> = <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">MPO_STATUS::ALTERABLE</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">  102</a></span>&#160;    <a class="code" href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a> <a class="code" href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">VERB</a> = DMRG::VERBOSITY::OPTION::SILENT;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    </div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ab272bda05dff2faf3fe1be9a276eefd3">  107</a></span>&#160;    std::string <a class="code" href="classMpoTerms.html#ab272bda05dff2faf3fe1be9a276eefd3">before_verb_set</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a80e4efbe7d2892340b6531e508a34bc0">  112</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#a80e4efbe7d2892340b6531e508a34bc0">current_power</a> = 1;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    </div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a180a7c6214981fdabc5336bba164d1e2">  117</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a180a7c6214981fdabc5336bba164d1e2">GOT_QOP</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    </div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classMpoTerms.html#abb789c2353b3afb0bc86c9c84a7580e3">  122</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#abb789c2353b3afb0bc86c9c84a7580e3">GOT_QAUX</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    </div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a4c7aa950b1c1be6f9b7db8f933c86c7f">  127</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a4c7aa950b1c1be6f9b7db8f933c86c7f">GOT_W</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a0ab89f88f49f0d527f0fad63909d774d">  133</a></span>&#160;    std::vector&lt;bool&gt; <a class="code" href="classMpoTerms.html#a0ab89f88f49f0d527f0fad63909d774d">GOT_QPHYS</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    </div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classMpoTerms.html#acf9fa7121f8720860d44179a898be76d">  141</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#acf9fa7121f8720860d44179a898be76d">increment_auxdim</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;q);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    </div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ad4af68f18ba1cd31be54f7a456c78286">  147</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ad4af68f18ba1cd31be54f7a456c78286">increment_first_auxdim_OBC</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    </div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ac77ed69cd6d0b71193358faba4ce23e9">  153</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ac77ed69cd6d0b71193358faba4ce23e9">increment_last_auxdim_OBC</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    </div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a037a5789f20cfbb4e76fa33d62529269">  161</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a037a5789f20cfbb4e76fa33d62529269">decrement_auxdim</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;q);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    </div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a50686e5f9fb163156350c4804cc3f630">  167</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a50686e5f9fb163156350c4804cc3f630">decrement_first_auxdim_OBC</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    </div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a81f461a56543a78c0a8f03fcca9b5de9">  173</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a81f461a56543a78c0a8f03fcca9b5de9">decrement_last_auxdim_OBC</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    </div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ada00ad294f429b62b093ea45c6ea62d2">  184</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ada00ad294f429b62b093ea45c6ea62d2">add</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="structSiteOperator.html">OperatorType</a> &amp;op, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut, <span class="keyword">const</span> std::size_t IndexIn, <span class="keyword">const</span> std::size_t IndexOut);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a944d0323c6ad445cdf217445b86a9216">  193</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#a944d0323c6ad445cdf217445b86a9216">get_auxdim</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;q) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    </div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a36e9956082a09f9fb2d56120de38be16">  200</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a36e9956082a09f9fb2d56120de38be16">assert_hilbert</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> std::size_t <a class="code" href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    </div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a503fd03635ba7f298c3e5f04a04ee7dd">  207</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a503fd03635ba7f298c3e5f04a04ee7dd">eliminate_linearlyDependent_rows</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    </div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a59899fcbfc527f4491651b5220b59916">  215</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a59899fcbfc527f4491651b5220b59916">eliminate_linearlyDependent_cols</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    </div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1">  225</a></span>&#160;    std::map&lt;qType, std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1">delete_row</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn, <span class="keyword">const</span> std::size_t row_to_delete, <span class="keyword">const</span> <span class="keywordtype">bool</span> SAMESITE);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    </div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45">  235</a></span>&#160;    std::map&lt;qType, std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45">delete_col</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut, <span class="keyword">const</span> std::size_t col_to_delete, <span class="keyword">const</span> <span class="keywordtype">bool</span> SAMESITE);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    </div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a540eb7909387ae88971a5d0dda1032be">  245</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a540eb7909387ae88971a5d0dda1032be">add_to_row</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn, <span class="keyword">const</span> std::size_t row, <span class="keyword">const</span> std::map&lt;<a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a>,std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; &amp;ops, <span class="keyword">const</span> Scalar factor);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    </div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="classMpoTerms.html#af017aefebdff6bd775d6f12109233144">  255</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#af017aefebdff6bd775d6f12109233144">add_to_col</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut, <span class="keyword">const</span> std::size_t col, <span class="keyword">const</span> std::map&lt;<a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a>,std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; &amp;ops, <span class="keyword">const</span> Scalar factor);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    </div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aa5bc766ce63a2bb0d672ccaf189970a1">  260</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#aa5bc766ce63a2bb0d672ccaf189970a1">calc_qOp</a> ();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    </div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5a81f45495e41845da352d1985f05400">  265</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a5a81f45495e41845da352d1985f05400">calc_qAux</a> ();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    </div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a00badfef5e19dbd049ec106dabfe5690">  270</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a00badfef5e19dbd049ec106dabfe5690">calc_W</a> ();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    </div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a2fdc3c86a0ca19b84275cb722c25b7d5">  275</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a2fdc3c86a0ca19b84275cb722c25b7d5">got_update</a> ();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    </div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">  280</a></span>&#160;     <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">initialize</a> ();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    </div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">  286</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">compress</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> tolerance);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a08d290a1f3029772b6b38dc559558099">  291</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a08d290a1f3029772b6b38dc559558099">renormalize</a> ();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a6cde3a3f485a4f4300c7b54b6674efc4">  296</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a6cde3a3f485a4f4300c7b54b6674efc4">clear_opLabels</a> ();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    </div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classMpoTerms.html#acd023265ae6218668c30d75e6ba2cdc3">  302</a></span>&#160;    <span class="keyword">inline</span> std::tuple&lt;std::size_t,std::size_t,std::size_t,std::size_t&gt; <a class="code" href="classMpoTerms.html#acd023265ae6218668c30d75e6ba2cdc3">auxdim_infos</a> () <span class="keyword">const</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    </div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5859cf057a9ecec4f6a758e6a63d6ee6">  312</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a5859cf057a9ecec4f6a758e6a63d6ee6">prod_swap_IBC</a> (std::vector&lt;std::map&lt;std::array&lt;qType,2&gt;,std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; &amp;O_out, std::vector&lt;std::size_t&gt; &amp;row_qVac, std::vector&lt;std::size_t&gt; &amp;col_qVac, std::vector&lt;std::size_t&gt; &amp;row_qTot, std::vector&lt;std::size_t&gt; &amp;col_qTot);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    </div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a8b7aab9c8f59a6e6c9144e41e89da921">  322</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a8b7aab9c8f59a6e6c9144e41e89da921">prod_delZeroCols_OBC</a> (std::map&lt;std::array&lt;qType, 2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt; &amp;O_last, <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> &amp;qAux_last, <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> &amp;qAux_prev, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;<a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a>, <span class="keyword">const</span> std::size_t col_qTot);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a86c195dde004a0acd459408dbac1d64f">  329</a></span>&#160;    <span class="keyword">static</span> std::string <a class="code" href="classMpoTerms.html#a86c195dde004a0acd459408dbac1d64f">power_to_string</a> (std::size_t power);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a833ba2c8a6a46bb177a72a2a9e828efc">  336</a></span>&#160;    <span class="keyword">static</span> std::pair&lt;std::string,std::size_t&gt; <a class="code" href="classMpoTerms.html#a833ba2c8a6a46bb177a72a2a9e828efc">detect_and_remove_power</a> (<span class="keyword">const</span> std::string &amp;name_w_power);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    </div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classMpoTerms.html#acee3fb16d4a6c8fbf825221c6d049c08">  344</a></span>&#160;    std::vector&lt;qType&gt; <a class="code" href="classMpoTerms.html#acee3fb16d4a6c8fbf825221c6d049c08">calc_qList</a> (<span class="keyword">const</span> std::vector&lt;OperatorType&gt; &amp;opList);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    </div>
<div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a0e72f5a682eff4715e74e192733743c5">  346</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a0e72f5a682eff4715e74e192733743c5">fill_O_from_W</a> ();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    </div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a55d4a727504ca0b6304f75b6620d4cdf">  354</a></span>&#160;    std::vector&lt;std::vector&lt;qType&gt;&gt; <a class="code" href="classMpoTerms.html#a55d4a727504ca0b6304f75b6620d4cdf">qOp</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    </div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a429582958c5afc31bdd51abac890785c">  360</a></span>&#160;    std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; <a class="code" href="classMpoTerms.html#a429582958c5afc31bdd51abac890785c">qAux</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    </div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a28235dd806b9a3c110477f756cb08cbe">  366</a></span>&#160;    std::vector&lt;std::vector&lt;qType&gt;&gt; <a class="code" href="classMpoTerms.html#a28235dd806b9a3c110477f756cb08cbe">qPhys</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    </div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a794ee8e64c1f477b6e8768b55fdbdf98">  372</a></span>&#160;    std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, MatrixType&gt;&gt;&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#a794ee8e64c1f477b6e8768b55fdbdf98">W</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    </div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a667998716a1b7e21e0234d4fde7157cc">  378</a></span>&#160;    std::vector&lt;std::vector&lt;std::vector&lt;qType&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#a667998716a1b7e21e0234d4fde7157cc">qOp_powers</a>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    </div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a8b4e0db8ee01609d13a7e1666fc7bcfa">  384</a></span>&#160;    std::vector&lt;std::vector&lt;Qbasis&lt;Symmetry&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#a8b4e0db8ee01609d13a7e1666fc7bcfa">qAux_powers</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    </div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="classMpoTerms.html#add854992d23948930619568033a7c150">  390</a></span>&#160;    std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, MatrixType&gt;&gt;&gt;&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#add854992d23948930619568033a7c150">W_powers</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    </div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a208e6a069fa706142dcc5a9784f03a44">  395</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#a208e6a069fa706142dcc5a9784f03a44">N_sites</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    </div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a178a1447995cfdc9d86dc62514630af5">  400</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#a178a1447995cfdc9d86dc62514630af5">N_phys</a> = 0ul;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    </div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="structMpoTerms_1_1reversedData.html">  402</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structMpoTerms_1_1reversedData.html">reversedData</a></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    {</div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="structMpoTerms_1_1reversedData.html#ac45b5a25c9d0ed175fb16c941fc49cd2">  404</a></span>&#160;        std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, MatrixType&gt;&gt;&gt;&gt;&gt; <a class="code" href="structMpoTerms_1_1reversedData.html#ac45b5a25c9d0ed175fb16c941fc49cd2">W</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="structMpoTerms_1_1reversedData.html#a9fa81f6dfa8a350b62cccf5931dcd403">  405</a></span>&#160;        std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; <a class="code" href="structMpoTerms_1_1reversedData.html#a9fa81f6dfa8a350b62cccf5931dcd403">qAux</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="structMpoTerms_1_1reversedData.html#a1c688e402d0fdca9d3e3773fac34c113">  406</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="structMpoTerms_1_1reversedData.html#a1c688e402d0fdca9d3e3773fac34c113">SET</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    };</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    </div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aceccbf3195f9b4298c0b02ab4ca7e73d">  409</a></span>&#160;    <a class="code" href="structMpoTerms_1_1reversedData.html">reversedData</a> <a class="code" href="classMpoTerms.html#aceccbf3195f9b4298c0b02ab4ca7e73d">reversed</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    </div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ada165954c8f586180a7e259d9cf535b3">  419</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ada165954c8f586180a7e259d9cf535b3">reconstruct</a> (<span class="keyword">const</span> std::vector&lt;std::map&lt;std::array&lt;qType,2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; &amp;O_in, <span class="keyword">const</span> std::vector&lt;<a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a>&gt; &amp;qAux_in, <span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;qPhys_in, <span class="keyword">const</span> <span class="keywordtype">bool</span> FINALIZED_IN, <span class="keyword">const</span> <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> boundary_condition_in, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qTot_in = Symmetry::qvacuum());</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a04ecb67148ea52990e63db37c2256d99">  429</a></span>&#160;    <a class="code" href="classMpoTerms.html#a04ecb67148ea52990e63db37c2256d99">MpoTerms</a> (<span class="keyword">const</span> std::size_t L=0, <span class="keyword">const</span> <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> boundary_condition_in=<a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qTot_in=Symmetry::qvacuum(), <span class="keyword">const</span> <a class="code" href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a> &amp;VERB_in = DMRG::VERBOSITY::OPTION::SILENT);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    </div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a895a038b7849a71e8b067a1405c8d83b">  437</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a895a038b7849a71e8b067a1405c8d83b">initialize</a> (<span class="keyword">const</span> std::size_t L, <span class="keyword">const</span> <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> boundary_condition_in, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qTot_in);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    </div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a3fa0beed5916fb8a2e89567405f72d92">  446</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a3fa0beed5916fb8a2e89567405f72d92">push</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> std::vector&lt;OperatorType&gt; &amp;opList, <span class="keyword">const</span> std::vector&lt;qType&gt; &amp;qList, <span class="keyword">const</span> Scalar lambda = 1.0);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    </div>
<div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a651fdcd8a197db16ef17c0908e43de0a">  455</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a651fdcd8a197db16ef17c0908e43de0a">push</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> std::vector&lt;OperatorType&gt; &amp;opList, <span class="keyword">const</span> Scalar lambda = 1.0) {<a class="code" href="classMpoTerms.html#a651fdcd8a197db16ef17c0908e43de0a">push</a>(loc, opList, <a class="code" href="classMpoTerms.html#acee3fb16d4a6c8fbf825221c6d049c08">calc_qList</a>(opList), lambda);}</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    </div>
<div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a0bce043e816b8f72b464bc0a0c5fd094">  460</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a0bce043e816b8f72b464bc0a0c5fd094">show</a> () <span class="keyword">const</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    </div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="classMpoTerms.html#adb2a09be541f434ab3cb0f2d64f5efc0">  466</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#adb2a09be541f434ab3cb0f2d64f5efc0">save_label</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> std::string &amp;info_label);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    </div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">  471</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a> (<span class="keyword">const</span> std::string &amp;label_in) {<a class="code" href="classMpoTerms.html#af455c480190a643faa584ad8509452e0">label</a> = label_in;}</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    </div>
<div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">  476</a></span>&#160;    <span class="keyword">const</span> std::string <a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#af455c480190a643faa584ad8509452e0">label</a>;}</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    </div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a22d6f4fe971d81465f2dc32b95ec0e4c">  481</a></span>&#160;    std::vector&lt;std::string&gt; <a class="code" href="classMpoTerms.html#a22d6f4fe971d81465f2dc32b95ec0e4c">get_info</a> () <span class="keyword">const</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a240574966a2d46584d23e3e4da2ec8e0">  488</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a240574966a2d46584d23e3e4da2ec8e0">scale</a> (<span class="keyword">const</span> Scalar factor, <span class="keyword">const</span> Scalar offset=0., <span class="keyword">const</span> std::size_t power=0ul, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance=1.e-14);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    </div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5def179250b990da0d480300e771571e">  493</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> OtherScalar&gt; <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry, OtherScalar&gt;</a> <a class="code" href="classMpoTerms.html#a5def179250b990da0d480300e771571e">cast</a> ();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    </div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a7c33ddf3be037c23bfec8176ab739c58">  500</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a7c33ddf3be037c23bfec8176ab739c58">set_qPhys</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> std::vector&lt;qType&gt; &amp;qPhys_in){<a class="code" href="classMpoTerms.html#a36e9956082a09f9fb2d56120de38be16">assert_hilbert</a>(loc, qPhys_in.size()); <a class="code" href="classMpoTerms.html#a0ab89f88f49f0d527f0fad63909d774d">GOT_QPHYS</a>[loc] = <span class="keyword">true</span>; <a class="code" href="classMpoTerms.html#a28235dd806b9a3c110477f756cb08cbe">qPhys</a>[loc] = qPhys_in;}</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    </div>
<div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a189b70d9830c29164b4c3299a78e33b2">  510</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a189b70d9830c29164b4c3299a78e33b2">finalize</a> (<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacePROP.html#a0b137b212cc14cfd6de6339c67ff4df6">COMPRESS</a>=<span class="keyword">true</span>, <span class="keyword">const</span> std::size_t power=1, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance=::mynumeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        </div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a7732332da5839d9c1aa15d02f436c1d8">  516</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a7732332da5839d9c1aa15d02f436c1d8">calc</a> (<span class="keyword">const</span> std::size_t power);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    </div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aa68f98dab48c889cdb823956f77b6805">  521</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#aa68f98dab48c889cdb823956f77b6805">is_finalized</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> (<a class="code" href="classMpoTerms.html#a52f993c8c9004988c5b50b21955b4d26">status</a> == <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a>);}</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    </div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a1ed760f886a0cfe1399b7cda6a0f6507">  526</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::map&lt;std::array&lt;qType, 2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a1ed760f886a0cfe1399b7cda6a0f6507">get_O</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a252f0e3ea06be953db7c3d2c7e7bfd91">O</a>;}</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    </div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a645187bf0bc3264e628ce5cc91c010bc">  531</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, MatrixType&gt;&gt;&gt;&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a645187bf0bc3264e628ce5cc91c010bc">get_W</a> ()<span class="keyword"> const </span>{assert(<a class="code" href="classMpoTerms.html#a4c7aa950b1c1be6f9b7db8f933c86c7f">GOT_W</a> and <span class="stringliteral">&quot;W has not been calculated!&quot;</span>); <span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a794ee8e64c1f477b6e8768b55fdbdf98">W</a>;}</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="classMpoTerms.html#af9467e059bedd0b94cf403dc7aaf9ee2">  536</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#af9467e059bedd0b94cf403dc7aaf9ee2">get_qAux</a> ()<span class="keyword"> const </span>{assert(<a class="code" href="classMpoTerms.html#abb789c2353b3afb0bc86c9c84a7580e3">GOT_QAUX</a> and <span class="stringliteral">&quot;qAux has not been calculated!&quot;</span>); <span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a429582958c5afc31bdd51abac890785c">qAux</a>;}</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    </div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a205386f3179d65eb729b47d18a2d3e1a">  541</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a205386f3179d65eb729b47d18a2d3e1a">get_qOp</a> ()<span class="keyword"> const </span>{assert(<a class="code" href="classMpoTerms.html#a180a7c6214981fdabc5336bba164d1e2">GOT_QOP</a> and <span class="stringliteral">&quot;qOp has not been calculated!&quot;</span>); <span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a55d4a727504ca0b6304f75b6620d4cdf">qOp</a>;}</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    </div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ab2cbbcb24ec78394626aeb1a5e38e466">  546</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#ab2cbbcb24ec78394626aeb1a5e38e466">get_qPhys</a> ()<span class="keyword"> const </span>{assert(<a class="code" href="classMpoTerms.html#a2ae5c2f5b161751796f20ee3eb56c95d">check_qPhys</a>() and <span class="stringliteral">&quot;qPhys has not been set!&quot;</span>); <span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a28235dd806b9a3c110477f756cb08cbe">qPhys</a>;}</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   </div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a82c026d1a3a6c4e42e59320a76bb9f44">  552</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, MatrixType&gt;&gt;&gt;&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a82c026d1a3a6c4e42e59320a76bb9f44">get_W_power</a> (std::size_t power) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    </div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a056cc8e2dd6c915ca6112b9eab5eb73e">  558</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a056cc8e2dd6c915ca6112b9eab5eb73e">get_qAux_power</a> (std::size_t power) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    </div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a89d4a7d72e78c0e62b2c26fc154b91eb">  564</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a89d4a7d72e78c0e62b2c26fc154b91eb">get_qOp_power</a> (std::size_t power) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    </div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="classMpoTerms.html#afb40c100052ed367f53ac2d5b5cf13c5">  569</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#afb40c100052ed367f53ac2d5b5cf13c5">get_hilbert_dimension</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a065ff86f35239f072106349fe9135923">hilbert_dimension</a>[loc];}</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    </div>
<div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">  574</a></span>&#160;    <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> <a class="code" href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">get_boundary_condition</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#aed405248ce8b76b63451b039f9d812c7">boundary_condition</a>;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    </div>
<div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aaa75b0496265c0f41405a8656ca10d8c">  579</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;<a class="code" href="classMpoTerms.html#aaa75b0496265c0f41405a8656ca10d8c">get_qVac</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a48be912d55d82e2e076d0dfacce41e8a">qVac</a>;}</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    </div>
<div class="line"><a name="l00584"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">  584</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;<a class="code" href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">get_qTot</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a>;}</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    </div>
<div class="line"><a name="l00589"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a1c9edb59beb0e03483cc8865ab648b92">  589</a></span>&#160;    <span class="keyword">const</span> std::size_t <a class="code" href="classMpoTerms.html#a1c9edb59beb0e03483cc8865ab648b92">get_pos_qTot</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a666f0aa6a2f44a1343f3ab2311f752e0">pos_qTot</a>;}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a2ae5c2f5b161751796f20ee3eb56c95d">  594</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a2ae5c2f5b161751796f20ee3eb56c95d">check_qPhys</a> () <span class="keyword">const</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    </div>
<div class="line"><a name="l00600"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ab0190ae4ed852060d798cad92fa5d9df">  600</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#ab0190ae4ed852060d798cad92fa5d9df">check_power</a> (std::size_t power)<span class="keyword"> const </span>{<span class="keywordflow">return</span> (power &lt;= <a class="code" href="classMpoTerms.html#a80e4efbe7d2892340b6531e508a34bc0">current_power</a>);}</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ab86cc4389a72e7493e9c97a3099a105a">  605</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#ab86cc4389a72e7493e9c97a3099a105a">maxPower</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a80e4efbe7d2892340b6531e508a34bc0">current_power</a>;}</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    </div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">  610</a></span>&#160;    std::size_t <a class="code" href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">size</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a208e6a069fa706142dcc5a9784f03a44">N_sites</a>;}</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    </div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classMpoTerms.html#af455c480190a643faa584ad8509452e0">  615</a></span>&#160;    std::string <a class="code" href="classMpoTerms.html#af455c480190a643faa584ad8509452e0">label</a> = <span class="stringliteral">&quot;MPO&quot;</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    </div>
<div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a8fb6d1b6202c928edf48a9c507334c68">  628</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a8fb6d1b6202c928edf48a9c507334c68">transform_base</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qShift, <span class="keyword">const</span> <span class="keywordtype">bool</span> PRINT=<span class="keyword">false</span>, <span class="keyword">const</span> <span class="keywordtype">int</span> factor=-1, <span class="keyword">const</span> std::size_t powre=0ul);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    </div>
<div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a6b5bb8791d64458c41be2650e28a5e3f">  633</a></span>&#160;    std::vector&lt;std::vector&lt;TwoSiteData&lt;Symmetry,Scalar&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#a6b5bb8791d64458c41be2650e28a5e3f">calc_TwoSiteData</a> () <span class="keyword">const</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    </div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ac7a18a0e931b11eb5bd258665a1dc29a">  638</a></span>&#160;    std::vector&lt;std::pair&lt;qType,std::size_t&gt;&gt; <a class="code" href="classMpoTerms.html#ac7a18a0e931b11eb5bd258665a1dc29a">base_order_IBC</a> (<span class="keyword">const</span> std::size_t power=1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    </div>
<div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a444847ac22aff7cca40686ff04d96160">  645</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classMpoTerms.html#a444847ac22aff7cca40686ff04d96160">memory</a> (MEMUNIT memunit=kB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    </div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aff82dccf68884809ab15105b8a835f00">  653</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classMpoTerms.html#aff82dccf68884809ab15105b8a835f00">sparsity</a> (<span class="keyword">const</span> std::size_t power=1, <span class="keyword">const</span> <span class="keywordtype">bool</span> PER_MATRIX=<span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a01cd59d39dd7afefbd450c1a34072080">  663</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> <a class="code" href="classMpoTerms.html#a01cd59d39dd7afefbd450c1a34072080">prod</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> &amp;top, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> &amp;bottom, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;<a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance=::mynumeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    </div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a3daa5410ec1ecda6e1acaecc8042bac7">  672</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> <a class="code" href="classMpoTerms.html#a3daa5410ec1ecda6e1acaecc8042bac7">sum</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> &amp;top, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> &amp;bottom, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance=::mynumeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aba05431e89e486dbc4c57592ed0bc715">  677</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#aba05431e89e486dbc4c57592ed0bc715">set_Identity</a> (<span class="keyword">const</span> <span class="keyword">typename</span> Symmetry::qType &amp;Q=Symmetry::qvacuum());</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    </div>
<div class="line"><a name="l00682"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a18385263bb36606962eff5cf32648fc1">  682</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a18385263bb36606962eff5cf32648fc1">set_Zero</a> ();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    </div>
<div class="line"><a name="l00688"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a1c78886865dac407c7520d8da860b1c5">  688</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a1c78886865dac407c7520d8da860b1c5">set_verbosity</a> (<span class="keyword">const</span> <a class="code" href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a> VERB_in);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    </div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a528fcd33e93b7ed7e6042ed9f93bd52d">  693</a></span>&#160;    <a class="code" href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a> <a class="code" href="classMpoTerms.html#a528fcd33e93b7ed7e6042ed9f93bd52d">get_verbosity</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">VERB</a>;}</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    </div>
<div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a32621141cb84e784d538736646f1ed0a">  695</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a32621141cb84e784d538736646f1ed0a">save</a> (std::string filename);</div>
<div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a9807df589a9e1d516e51af88fd25c2e5">  696</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a9807df589a9e1d516e51af88fd25c2e5">load</a> (std::string filename);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    </div>
<div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aa82d1c4d3b8494ccbc28dcd89c730aeb">  699</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, MatrixType&gt;&gt;&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#aa82d1c4d3b8494ccbc28dcd89c730aeb">W_at</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a794ee8e64c1f477b6e8768b55fdbdf98">W</a>[loc];}</div>
<div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a36b1b28b4959923dc6a376466d145fb8">  700</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, MatrixType&gt;&gt;&gt;&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a36b1b28b4959923dc6a376466d145fb8">W_full</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a794ee8e64c1f477b6e8768b55fdbdf98">W</a>;}</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    </div>
<div class="line"><a name="l00702"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a3409266b67e4c85251ce814fd035627e">  702</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a3409266b67e4c85251ce814fd035627e">locBasis</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a28235dd806b9a3c110477f756cb08cbe">qPhys</a>;}</div>
<div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a3668d13dd1ce3b725b8ba006bb5e11fa">  703</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;qType&gt; &amp;<a class="code" href="classMpoTerms.html#a3668d13dd1ce3b725b8ba006bb5e11fa">locBasis</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a28235dd806b9a3c110477f756cb08cbe">qPhys</a>[loc];}</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    </div>
<div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a57f642700bd2019c1af509fb7aa23295">  705</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a57f642700bd2019c1af509fb7aa23295">auxBasis</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a429582958c5afc31bdd51abac890785c">qAux</a>;}</div>
<div class="line"><a name="l00706"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5748dfe248c279695d8757de3e789f13">  706</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> &amp;<a class="code" href="classMpoTerms.html#a5748dfe248c279695d8757de3e789f13">auxBasis</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a429582958c5afc31bdd51abac890785c">qAux</a>[loc];}</div>
<div class="line"><a name="l00707"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a7a0082821841c3ced7eb87042e34b8a2">  707</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> &amp;<a class="code" href="classMpoTerms.html#a7a0082821841c3ced7eb87042e34b8a2">inBasis</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a429582958c5afc31bdd51abac890785c">qAux</a>[loc];}</div>
<div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a200f69501503c2c27655acc1d2757179">  708</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> &amp;<a class="code" href="classMpoTerms.html#a200f69501503c2c27655acc1d2757179">outBasis</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a429582958c5afc31bdd51abac890785c">qAux</a>[loc+1];}</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a577476278e71c7940de0d52a0f1c3bec">  710</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a577476278e71c7940de0d52a0f1c3bec">opBasis</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a55d4a727504ca0b6304f75b6620d4cdf">qOp</a>;}</div>
<div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ac5809d1b22b1f8f5ad1e222a80de9cdb">  711</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;qType&gt; &amp;<a class="code" href="classMpoTerms.html#ac5809d1b22b1f8f5ad1e222a80de9cdb">opBasis</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a55d4a727504ca0b6304f75b6620d4cdf">qOp</a>[loc];}</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    </div>
<div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a6c56def08f549bc74c30cdbe0a6402f4">  713</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;<a class="code" href="classMpoTerms.html#a6c56def08f549bc74c30cdbe0a6402f4">Qtarget</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a>;}</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    </div>
<div class="line"><a name="l00715"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a55f9d59da99162840fae7c9d8f14e345">  715</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a55f9d59da99162840fae7c9d8f14e345">setLocBasis</a> (<span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;q) {<span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;q.size(); ++loc) <a class="code" href="classMpoTerms.html#a7c33ddf3be037c23bfec8176ab739c58">set_qPhys</a>(loc, q[loc]);}</div>
<div class="line"><a name="l00716"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ae07da19132e5cd2a583ecd43f6e3457a">  716</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ae07da19132e5cd2a583ecd43f6e3457a">setLocBasis</a> (<span class="keyword">const</span> std::vector&lt;qType&gt; &amp;q, std::size_t loc) {<a class="code" href="classMpoTerms.html#a7c33ddf3be037c23bfec8176ab739c58">set_qPhys</a>(loc, q);}</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    </div>
<div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a911e788216f70effdc742fedf110fbb8">  718</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, MatrixType&gt;&gt;&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a911e788216f70effdc742fedf110fbb8">Wsq_at</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">if</span>(<a class="code" href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">VERB</a> != DMRG::VERBOSITY::OPTION::SILENT) lout &lt;&lt; <span class="stringliteral">&quot;Warning: method Wsq_at(loc) is deprecated&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#add854992d23948930619568033a7c150">W_powers</a>[0][loc];}</div>
<div class="line"><a name="l00719"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aa59b26f9503f57f2301d553890408bba">  719</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;qType&gt; &amp;<a class="code" href="classMpoTerms.html#aa59b26f9503f57f2301d553890408bba">opBasisSq</a> (<span class="keyword">const</span> std::size_t loc)<span class="keyword"> const </span>{<span class="keywordflow">if</span>(<a class="code" href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">VERB</a> != DMRG::VERBOSITY::OPTION::SILENT) lout &lt;&lt; <span class="stringliteral">&quot;Warning: method opBasisSq(loc) is deprecated&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a667998716a1b7e21e0234d4fde7157cc">qOp_powers</a>[0][loc];}</div>
<div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="classMpoTerms.html#af0b4b67186dc1b45be38db47d61c5160">  720</a></span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#af0b4b67186dc1b45be38db47d61c5160">opBasisSq</a> ()<span class="keyword"> const </span>{<span class="keywordflow">if</span>(<a class="code" href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">VERB</a> != DMRG::VERBOSITY::OPTION::SILENT) lout &lt;&lt; <span class="stringliteral">&quot;Warning: method opBasisSq() is deprecated&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a667998716a1b7e21e0234d4fde7157cc">qOp_powers</a>[0];}</div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a240777a5c1097a3f8f047614c9e6f8e0">  721</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a240777a5c1097a3f8f047614c9e6f8e0">check_SQUARE</a> ()<span class="keyword"> const </span>{<span class="keywordflow">if</span>(<a class="code" href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">VERB</a> != DMRG::VERBOSITY::OPTION::SILENT) lout &lt;&lt; <span class="stringliteral">&quot;Warning: method check_SQUARE() is deprecated&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">return</span> (<a class="code" href="classMpoTerms.html#a80e4efbe7d2892340b6531e508a34bc0">current_power</a>&gt;=2);}</div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a23510dbe37f8461238e022c7fac76997">  722</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classMpoTerms.html#a23510dbe37f8461238e022c7fac76997">sparsity</a> (<span class="keywordtype">bool</span> USE_SQUARE, <span class="keywordtype">bool</span> PER_MATRIX)<span class="keyword"> const </span>{<span class="keywordflow">if</span>(<a class="code" href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">VERB</a> != DMRG::VERBOSITY::OPTION::SILENT) lout &lt;&lt; <span class="stringliteral">&quot;Warning: method sparsity(bool,bool) is deprecated&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">return</span> <a class="code" href="classMpoTerms.html#a23510dbe37f8461238e022c7fac76997">sparsity</a>(2,PER_MATRIX);}</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5d2fc99aa633ae6ae176d8ea01eadaac">  725</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a5d2fc99aa633ae6ae176d8ea01eadaac">setQtarget</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;q) {assert(<span class="keyword">false</span> and <span class="stringliteral">&quot;setQtarget should not be called after the MPO has been initialized.&quot;</span>);}</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;};</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno"><a class="line" href="MpoTerms_8h.html#a2f51b653cd0d2d8cf566cf637fba30a7">  728</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry&gt; <span class="keyword">using</span> <a class="code" href="classMpoTerms.html">MpoTermsXd</a>  = <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,double&gt;</a>;</div>
<div class="line"><a name="l00729"></a><span class="lineno"><a class="line" href="MpoTerms_8h.html#ae6684543c3ec313513d0626a20c9432e">  729</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry&gt; <span class="keyword">using</span> <a class="code" href="classMpoTerms.html">MpoTermsXcd</a> = <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,std::complex&lt;double&gt;</a>&gt;;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a04ecb67148ea52990e63db37c2256d99">  731</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <a class="code" href="classMpoTerms.html#a04ecb67148ea52990e63db37c2256d99">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<a class="code" href="classMpoTerms.html#a04ecb67148ea52990e63db37c2256d99">MpoTerms</a> (<span class="keyword">const</span> std::size_t L, <span class="keyword">const</span> <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> boundary_condition_in, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qTot_in, <span class="keyword">const</span> <a class="code" href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a> &amp;VERB_in)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;: N_sites(L), boundary_condition(boundary_condition_in), qTot(qTot_in), VERB(VERB_in)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;{</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMpoTerms.html#a208e6a069fa706142dcc5a9784f03a44">N_sites</a>&gt;0)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <a class="code" href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">initialize</a>();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">  741</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<a class="code" href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">initialize</a> ()</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;{</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;Initializing an MPO with L=&quot;</span> &lt;&lt; N_sites &lt;&lt; <span class="stringliteral">&quot;, Boundary condition=&quot;</span> &lt;&lt; boundary_condition &lt;&lt; <span class="stringliteral">&quot; and qTot={&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qTot) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        ss &lt;&lt; before_verb_set &lt;&lt; <span class="stringliteral">&quot;Initializing an MPO with L=&quot;</span> &lt;&lt; N_sites &lt;&lt; <span class="stringliteral">&quot;, Boundary condition=&quot;</span> &lt;&lt; boundary_condition &lt;&lt; <span class="stringliteral">&quot; and qTot={&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qTot) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        before_verb_set = ss.str();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a> or qTot == qVac);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    current_power = 1;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">if</span>(qTot == qVac)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        pos_qVac = 0;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        pos_qTot = 1;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        pos_qVac = 0;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        pos_qTot = 0;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    hilbert_dimension.clear();</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    hilbert_dimension.resize(N_sites, 0);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    O.clear();</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    O.resize(N_sites);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    qAux.clear();</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    auxdim.clear();</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    auxdim.resize(N_sites+1);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    qPhys.clear();</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    qPhys.resize(N_sites);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    GOT_QPHYS.clear();</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    GOT_QPHYS.resize(N_sites, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    info.clear();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    info.resize(N_sites);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        increment_first_auxdim_OBC(qVac);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        increment_first_auxdim_OBC(qTot);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        increment_last_auxdim_OBC(qVac);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        increment_last_auxdim_OBC(qTot);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        increment_auxdim(0,qVac);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        increment_auxdim(0,qTot);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=1; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        increment_auxdim(loc,qVac);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        increment_auxdim(loc,qTot);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a895a038b7849a71e8b067a1405c8d83b">  801</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<a class="code" href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">initialize</a> (<span class="keyword">const</span> std::size_t L, <span class="keyword">const</span> <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> boundary_condition_in, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qTot_in)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;{</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    N_sites = L;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    boundary_condition = boundary_condition_in;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    qTot = qTot_in;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="namespaceSym.html#abcb3d8e8d7c7b79db78814d5b71d6163">initialize</a>();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;}</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ada165954c8f586180a7e259d9cf535b3">  810</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ada165954c8f586180a7e259d9cf535b3">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<a class="code" href="classMpoTerms.html#ada165954c8f586180a7e259d9cf535b3">reconstruct</a> (<span class="keyword">const</span> std::vector&lt;std::map&lt;std::array&lt;qType,2&gt;,std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; &amp;O_in, <span class="keyword">const</span> std::vector&lt;<a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a>&gt; &amp;qAux_in, <span class="keyword">const</span> std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;qPhys_in, <span class="keyword">const</span> <span class="keywordtype">bool</span> FINALIZED_IN, <span class="keyword">const</span> <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> boundary_condition_in, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qTot_in)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;{</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;Reconstructing an MPO with L=&quot;</span> &lt;&lt; O_in.size() &lt;&lt; <span class="stringliteral">&quot;, Boundary condition=&quot;</span> &lt;&lt; boundary_condition_in &lt;&lt; <span class="stringliteral">&quot; and qTot={&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qTot_in) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        ss &lt;&lt; before_verb_set &lt;&lt; <span class="stringliteral">&quot;Reconstructing an MPO with L=&quot;</span> &lt;&lt; O_in.size() &lt;&lt; <span class="stringliteral">&quot;, Boundary condition=&quot;</span> &lt;&lt; boundary_condition_in &lt;&lt; <span class="stringliteral">&quot; and qTot={&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qTot_in) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        before_verb_set = ss.str();</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    N_sites = O_in.size();</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    boundary_condition = boundary_condition_in;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    qTot = qTot_in;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    qPhys.clear();</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    qPhys = qPhys_in;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">if</span>(FINALIZED_IN)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        status = <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        status = <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">MPO_STATUS::ALTERABLE</a>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a> or qTot == qVac);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span>(qTot == qVac)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        pos_qVac = 0;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        pos_qTot = 1;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        pos_qVac = 0;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        pos_qTot = 0;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    hilbert_dimension.clear();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    hilbert_dimension.resize(N_sites,0);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    auxdim.clear();</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    qAux.clear();</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    auxdim.resize(N_sites+1);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    GOT_QPHYS.clear();</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    GOT_QPHYS.resize(N_sites,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    info.clear();</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    info.resize(N_sites);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        hilbert_dimension[loc] = qPhys[loc].size();</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        GOT_QPHYS[loc] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites+1; ++loc)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        std::vector&lt;qType&gt; qs = qAux_in[loc].qs();</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        auxdim[loc].clear();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;q : qs)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            std::size_t deg = qAux_in[loc].inner_dim(q);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            auxdim[loc].insert({q,deg});</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    O.clear();</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    O = O_in;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    calc(1);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;}</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a1c78886865dac407c7520d8da860b1c5">  880</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a1c78886865dac407c7520d8da860b1c5">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<a class="code" href="classMpoTerms.html#a1c78886865dac407c7520d8da860b1c5">set_verbosity</a> (<span class="keyword">const</span> <a class="code" href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a> VERB_in)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;{</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">if</span>(VERB == DMRG::VERBOSITY::OPTION::SILENT and VERB_in != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        lout &lt;&lt; before_verb_set;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    VERB = VERB_in;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a3fa0beed5916fb8a2e89567405f72d92">  892</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a3fa0beed5916fb8a2e89567405f72d92">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<a class="code" href="classMpoTerms.html#a3fa0beed5916fb8a2e89567405f72d92">push</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> std::vector&lt;OperatorType&gt; &amp;opList, <span class="keyword">const</span> std::vector&lt;qType&gt; &amp;qList, <span class="keyword">const</span> Scalar lambda)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;{</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    assert(loc &lt; N_sites and <span class="stringliteral">&quot;Chosen lattice site out of bounds&quot;</span>);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    assert((loc+opList.size() &lt;= N_sites or boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>) and <span class="stringliteral">&quot;For finite lattices operators must not exceed lattice size&quot;</span>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    assert(status == <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">MPO_STATUS::ALTERABLE</a> and <span class="stringliteral">&quot;Terms have already been finalized or have been loaded&quot;</span>);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    std::size_t range = opList.size();</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    assert(qList.size() == range+1 and <span class="stringliteral">&quot;Amount of quantum numbers does not match amount of operators!&quot;</span>);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    assert(qList[0] == qVac and qList[range] == qTot and <span class="stringliteral">&quot;Quantum number list does not match the total MPO quantum number!&quot;</span>);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span>(std::abs(lambda) &lt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">for</span>(std::size_t i=0; i&lt;range; ++i)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        assert_hilbert((loc+i)%N_sites, opList[i].data.rows());</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordflow">if</span>(opList[i].data.norm() &lt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span>(range == 1)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Local interaction at site &quot;</span> &lt;&lt; loc;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="preprocessor">            #ifdef OPLABELS</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; lambda &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; opList[0].label;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            lout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        assert(opList[0].Q == qTot and <span class="stringliteral">&quot;Local operator does not match the total MPO quantum number!&quot;</span>);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        add(loc, lambda*opList[0], qVac, qTot, pos_qVac, pos_qTot);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            lout &lt;&lt; range-1 &lt;&lt; <span class="stringliteral">&quot;.-neighbour interaction between the sites &quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; (loc+range-1)%N_sites;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="preprocessor">            #ifdef OPLABELS</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; lambda &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; opList[0].label &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <span class="keywordflow">for</span>(std::size_t n=1; n&lt;range; ++n)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; opList[n].label;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            lout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        std::size_t row = pos_qVac;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        std::size_t col = get_auxdim(loc+1, qList[1]);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        increment_auxdim((loc+1)%N_sites, qList[1]);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        add(loc, lambda*opList[0], qVac, qList[1], row, col);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;range-1; ++i)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            row = col;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            col = get_auxdim(loc+1+i, qList[i+1]);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            increment_auxdim((loc+1+i)%N_sites, qList[i+1]);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            add((loc+i)%N_sites, opList[i], qList[i], qList[i+1], row, col);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        row = col;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        col = pos_qTot;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        add((loc+range-1)%N_sites, opList[range-1], qList[range-1], qTot, row, col);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;}</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno"><a class="line" href="classMpoTerms.html#acee3fb16d4a6c8fbf825221c6d049c08">  961</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::vector&lt;typename Symmetry::qType&gt; <a class="code" href="classMpoTerms.html#acee3fb16d4a6c8fbf825221c6d049c08">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<a class="code" href="classMpoTerms.html#acee3fb16d4a6c8fbf825221c6d049c08">calc_qList</a> (<span class="keyword">const</span> std::vector&lt;OperatorType&gt; &amp;opList)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;{</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keyword">struct </span>qBranch</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> current;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        std::vector&lt;qType&gt; history;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        qBranch() {}</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        qBranch(<a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> current_in, std::vector&lt;qType&gt; history_in)</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        : current{current_in}, history{history_in}{}</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        std::string info()</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            std::stringstream sout;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;history.size(); ++i)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                sout &lt;&lt; <span class="stringliteral">&quot;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(history[i]) &lt;&lt; <span class="stringliteral">&quot;} -&gt; &quot;</span>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            sout &lt;&lt; <span class="stringliteral">&quot;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(current) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="keywordflow">return</span> sout.str();</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    };</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    std::size_t range = opList.size();</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    std::vector&lt;std::vector&lt;qBranch&gt;&gt; Qtree(range);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    qBranch temp{opList[0].Q, {}};</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    Qtree[0].push_back(temp);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">for</span>(std::size_t m=1; m&lt;range; ++m)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;Qtree[m-1].size(); ++i)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            std::vector&lt;qType&gt; qs = Symmetry::reduceSilent(opList[m].Q, Qtree[m-1][i].current);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;qs.size(); ++j)</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                qBranch temp{qs[j], Qtree[m-1][i].history};</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                temp.history.push_back(Qtree[m-1][i].current);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                Qtree[m].push_back(temp);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    std::vector&lt;qType&gt; qList(range+1);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    qList[0] = qVac;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Qtree[range-1].size(); ++i)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">if</span> (Qtree[range-1][i].current == qTot)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            ++count;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;range-1; ++j)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                qList[j+1] = Qtree[range-1][i].history[j];</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            qList[range] = qTot;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keywordflow">if</span> (VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;This branch of quantum numbers leads to the total MPO quantum number: {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qList[0]) &lt;&lt; <span class="stringliteral">&quot;} -&gt; &quot;</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;range-1; ++j)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qList[j+1]) &lt;&lt; <span class="stringliteral">&quot;} -&gt; &quot;</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qList[range]) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">if</span> (count &gt; 1) {lout  &lt;&lt; termcolor::red &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot; quantum number branches lead to the total MPO quantum number&quot;</span> &lt;&lt; termcolor::reset &lt;&lt; endl;}</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (count == 0) {lout &lt;&lt; termcolor::red &lt;&lt; <span class="stringliteral">&quot;No quantum number branch leads to the total MPO quantum number&quot;</span> &lt;&lt; termcolor::reset &lt;&lt; endl;}</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    assert(count == 1);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">return</span> qList;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a0bce043e816b8f72b464bc0a0c5fd094"> 1033</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a0bce043e816b8f72b464bc0a0c5fd094">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<a class="code" href="classMpoTerms.html#a0bce043e816b8f72b464bc0a0c5fd094">show</a> ()<span class="keyword"> const</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    lout &lt;&lt; <span class="stringliteral">&quot;####################################################################################################&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    lout &lt;&lt; <span class="stringliteral">&quot;Name: &quot;</span> &lt;&lt; label &lt;&lt; std::endl;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    lout &lt;&lt; <span class="stringliteral">&quot;System with &quot;</span> &lt;&lt; N_sites &lt;&lt; <span class="stringliteral">&quot; lattice sites and &quot;</span> &lt;&lt; boundary_condition &lt;&lt; <span class="stringliteral">&quot; boundary condition, target quantum number {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qTot) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">switch</span>(status)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">MPO_STATUS::ALTERABLE</a>:</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;, alterable and not finalized yet.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a>:</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;, already finalized.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;, ill-defined state!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    lout &lt;&lt; <span class="stringliteral">&quot;Approximate memory usage: &quot;</span> &lt;&lt; round(memory(kB),1) &lt;&lt; <span class="stringliteral">&quot; kB&quot;</span>;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">if</span>(GOT_W and GOT_QOP)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;, sparsity: &quot;</span> &lt;&lt; round(sparsity()*100,1) &lt;&lt; <span class="stringliteral">&quot;%&quot;</span>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    lout &lt;&lt; std::endl;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keyword">auto</span> [total_auxdim, maximum_local_auxdim, total_full_auxdim, maximum_local_full_auxdim] = auxdim_infos();</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    lout &lt;&lt; <span class="stringliteral">&quot;Calculated bases and data:\n&quot;</span>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">if</span>(GOT_QAUX)</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;• MPO auxiliar bases (Average bond dimension: &quot;</span> &lt;&lt; (total_auxdim*1.0)/N_sites &lt;&lt; <span class="stringliteral">&quot; (max. &quot;</span> &lt;&lt; maximum_local_auxdim &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span>(Symmetry::NON_ABELIAN)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;, average full bond dimension: &quot;</span> &lt;&lt; (total_full_auxdim*1.0)/N_sites &lt;&lt; <span class="stringliteral">&quot; (max. &quot;</span> &lt;&lt; maximum_local_full_auxdim &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">if</span>(check_qPhys()) lout &lt;&lt; <span class="stringliteral">&quot;• Physical bases of local Hilbert spaces&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">if</span>(GOT_QOP) lout &lt;&lt; <span class="stringliteral">&quot;• Local operator bases&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">if</span>(GOT_W) lout &lt;&lt; <span class="stringliteral">&quot;• W matrix&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">if</span>(current_power &gt; 1) lout &lt;&lt; <span class="stringliteral">&quot;• All of the previous up to &quot;</span> &lt;&lt; current_power &lt;&lt; <span class="stringliteral">&quot;. power of the MPO&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span>(reversed.<a class="code" href="structMpoTerms_1_1reversedData.html#a1c688e402d0fdca9d3e3773fac34c113">SET</a>) lout &lt;&lt; <span class="stringliteral">&quot;• Reversed W matrix and auxiliar bases&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;Lattice site: &quot;</span> &lt;&lt; loc &lt;&lt; std::endl;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tPhysical basis of local Hilbert space (&quot;</span> &lt;&lt; hilbert_dimension[loc] &lt;&lt; <span class="stringliteral">&quot; dim):\t&quot;</span>;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordflow">if</span>(GOT_QPHYS[loc])</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <span class="keywordflow">for</span>(std::size_t n=0; n&lt;qPhys[loc].size(); ++n)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPhys[loc][n]) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\n\tIncoming quantum numbers:\t&quot;</span>;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn, deg] : auxdim[loc])</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;\t({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;} [#=&quot;</span> &lt;&lt; deg &lt;&lt; <span class="stringliteral">&quot;])&quot;</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\n\tOutgoing quantum numbers:\t&quot;</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut, deg] : auxdim[loc+1])</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;\t({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;} [#=&quot;</span> &lt;&lt; deg &lt;&lt; <span class="stringliteral">&quot;])&quot;</span>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        lout &lt;&lt; std::endl;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tOperators:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qs, ops] : O[loc])</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            std::size_t rows = get_auxdim(loc, std::get&lt;0&gt;(qs));</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            std::size_t cols = get_auxdim(loc+1, std::get&lt;1&gt;(qs));</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="keywordtype">bool</span> any_nonzero = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                    <span class="keywordflow">if</span>(ops[row][col].size() &gt; 0)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                    {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                        <span class="keywordflow">if</span>(!any_nonzero)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                        {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                            any_nonzero = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                            lout &lt;&lt; <span class="stringliteral">&quot;\t\t{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(std::get&lt;0&gt;(qs)) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(std::get&lt;1&gt;(qs)) &lt;&lt; <span class="stringliteral">&quot;}:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                        }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                        lout &lt;&lt; <span class="stringliteral">&quot;\t\t\tPosition [&quot;</span> &lt;&lt; row &lt;&lt; <span class="stringliteral">&quot;|&quot;</span> &lt;&lt; col &lt;&lt; <span class="stringliteral">&quot;]:&quot;</span>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q,op] : ops[row][col])</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                        {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor">                            #ifdef OPLABELS</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                            lout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; op.label &lt;&lt; <span class="stringliteral">&quot; ({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Q) &lt;&lt; <span class="stringliteral">&quot;}) norm=&quot;</span> &lt;&lt; op.data.norm();</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="preprocessor">                            #else</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                            lout &lt;&lt; <span class="stringliteral">&quot;\t ({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Q) &lt;&lt; <span class="stringliteral">&quot;}) norm=&quot;</span> &lt;&lt; op.data.norm();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor">                            #endif</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                        }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                        lout &lt;&lt; std::endl;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                    }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    lout &lt;&lt; <span class="stringliteral">&quot;####################################################################################################&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;}</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a7732332da5839d9c1aa15d02f436c1d8"> 1134</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a7732332da5839d9c1aa15d02f436c1d8">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<a class="code" href="classMpoTerms.html#a7732332da5839d9c1aa15d02f436c1d8">calc</a> (<span class="keyword">const</span> std::size_t power)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;{</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordflow">if</span>(!GOT_QAUX)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        calc_qAux();</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordflow">if</span>(!GOT_QOP)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        calc_qOp();</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span>(!GOT_W)</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        calc_W();</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    W_powers.clear();</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    qAux_powers.clear();</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    qOp_powers.clear();</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    W_powers.resize(power-1);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    qAux_powers.resize(power-1);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    qOp_powers.resize(power-1);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> current = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">for</span>(std::size_t n=2; n&lt;=power; ++n)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        std::vector&lt;qType&gt; qTots = Symmetry::reduceSilent(current.<a class="code" href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">get_qTot</a>(),qTot);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        assert(qTots.size() == 1 and <span class="stringliteral">&quot;Target quantum number has to be unique for computing higher powers of the MPO.&quot;</span>);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        current = <a class="code" href="classMpoTerms.html#a01cd59d39dd7afefbd450c1a34072080">MpoTerms&lt;Symmetry,Scalar&gt;::prod</a>(current,*<span class="keyword">this</span>,qTots[0]);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        W_powers[n-2] = current.<a class="code" href="classMpoTerms.html#a645187bf0bc3264e628ce5cc91c010bc">get_W</a>();</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        qAux_powers[n-2] = current.<a class="code" href="classMpoTerms.html#af9467e059bedd0b94cf403dc7aaf9ee2">get_qAux</a>();</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        qOp_powers[n-2] = current.<a class="code" href="classMpoTerms.html#a205386f3179d65eb729b47d18a2d3e1a">get_qOp</a>();</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            lout &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;. power of the MPO:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            current.<a class="code" href="classMpoTerms.html#a0bce043e816b8f72b464bc0a0c5fd094">show</a>();</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    current_power = power;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;}</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a00badfef5e19dbd049ec106dabfe5690"> 1175</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a00badfef5e19dbd049ec106dabfe5690">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<a class="code" href="classMpoTerms.html#a00badfef5e19dbd049ec106dabfe5690">calc_W</a> ()</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;{</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    assert(GOT_QOP and <span class="stringliteral">&quot;qOp is needed for calculation of W matrix!&quot;</span>);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    W.resize(N_sites);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        std::size_t hdim = hilbert_dimension[loc];</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        std::size_t odim = qOp[loc].size();</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        W[loc].resize(hdim);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">for</span>(std::size_t m=0; m&lt;hdim; ++m)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            W[loc][m].resize(hdim);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <span class="keywordflow">for</span>(std::size_t n=0; n&lt;hdim; ++n)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                W[loc][m][n].resize(odim);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                <span class="keywordflow">for</span>(std::size_t t=0; t&lt;odim; ++t)</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                    <a class="code" href="structBiped.html">Biped&lt;Symmetry, MatrixType&gt;</a> bip;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn, rows] : auxdim[loc])</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                    {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut, cols] : auxdim[loc+1])</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                            <span class="keyword">auto</span> it = O[loc].find({qIn, qOut});</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                            assert(it != O[loc].end());</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                            <span class="keywordtype">bool</span> found_match = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                            <a class="code" href="classMpoTerms.html#ab7be76c72cfd76e91404ffd0b0563a76">MatrixType</a> mat(rows, cols);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                            mat.setZero();</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                            {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q,op] : (it-&gt;second)[row][col])</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                    {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                        <span class="keywordflow">if</span>(Q == qOp[loc][t])</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                        {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                            mat.coeffRef(row, col) = op.data.coeff(m,n);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                            <span class="keywordflow">if</span>(std::abs(mat.coeffRef(row, col)) &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                            {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                                found_match = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                            }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                        }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                                    }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                            }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                            <span class="keywordflow">if</span>(found_match and mat.norm() &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                            {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                bip.<a class="code" href="structBiped.html#a65bd241c1bb94f08f116f2975c8c891e">push_back</a>(qIn, qOut, mat);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                            }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                        }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                    }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    W[loc][m][n][t] = bip;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    GOT_W = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;}</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aa5bc766ce63a2bb0d672ccaf189970a1"> 1235</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#aa5bc766ce63a2bb0d672ccaf189970a1">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<a class="code" href="classMpoTerms.html#aa5bc766ce63a2bb0d672ccaf189970a1">calc_qOp</a> ()</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;{</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    qOp.resize(N_sites);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        std::set&lt;typename Symmetry::qType&gt; qOp_set;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qs, ops] : O[loc])</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            std::size_t rows = get_auxdim(loc, std::get&lt;0&gt;(qs));</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            std::size_t cols = get_auxdim(loc+1, std::get&lt;1&gt;(qs));</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q,op] : ops[row][col])</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                    {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                        qOp_set.insert(Q);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                    }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                }</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        qOp[loc].resize(qOp_set.size());</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        copy(qOp_set.begin(), qOp_set.end(), qOp[loc].begin());</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    GOT_QOP = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;}</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5a81f45495e41845da352d1985f05400"> 1264</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a5a81f45495e41845da352d1985f05400">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<a class="code" href="classMpoTerms.html#a5a81f45495e41845da352d1985f05400">calc_qAux</a> ()</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;{</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    qAux.resize(N_sites+1);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites+1; ++loc)</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        qAux[loc].clear();</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[q,deg] : auxdim[loc])</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            qAux[loc].push_back(q,deg);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    GOT_QAUX = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a189b70d9830c29164b4c3299a78e33b2"> 1280</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a189b70d9830c29164b4c3299a78e33b2">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<a class="code" href="classMpoTerms.html#a189b70d9830c29164b4c3299a78e33b2">finalize</a> (<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacePROP.html#a0b137b212cc14cfd6de6339c67ff4df6">COMPRESS</a>, <span class="keyword">const</span> std::size_t power, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;{</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    assert(status == <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">MPO_STATUS::ALTERABLE</a>);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    status = <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <span class="keywordflow">if</span>(hilbert_dimension[loc] == 0) hilbert_dimension[loc] = 1;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <a class="code" href="structSiteOperator.html">OperatorType</a> Id(Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;::Identity(hilbert_dimension[loc], hilbert_dimension[loc]).sparseView(),qVac);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="preprocessor">        #ifdef OPLABELS</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        Id.<a class="code" href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">label</a> = <span class="stringliteral">&quot;id&quot;</span>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        add(loc, Id, qVac, qVac, pos_qVac, pos_qVac);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        add(loc, Id, qTot, qTot, pos_qTot, pos_qTot);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        delete_row(0, qTot, pos_qTot,<span class="keyword">false</span>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordtype">bool</span> SAMESITE = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordflow">if</span>(N_sites == 1)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        {</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            SAMESITE = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        delete_col(N_sites-1, qVac, pos_qVac,SAMESITE);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        decrement_first_auxdim_OBC(qTot);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        decrement_last_auxdim_OBC(qVac);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="preprocessor">    #ifndef OPLABELS</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    clear_opLabels();</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacePROP.html#a0b137b212cc14cfd6de6339c67ff4df6">COMPRESS</a>)</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        compress(tolerance);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    }</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    calc(power);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;}</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor">#ifdef USE_OLD_COMPRESSION</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<a class="code" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">compress</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> tolerance)</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;{</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    std::size_t lindep_checks=0;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    assert(status == <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a> and <span class="stringliteral">&quot;Terms need to be finalized before compression.&quot;</span>);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;Starting compression of the MPO&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    Stopwatch&lt;&gt; watch;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keyword">auto</span> [total_auxdim_initial, maximum_local_auxdim_initial, total_full_auxdim_initial, maximum_local_full_auxdim_initial] = auxdim_infos();</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    std::vector&lt;bool&gt; updated_bond(N_sites,<span class="keyword">true</span>);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    std::size_t minimum_bond = 0;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>)</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        minimum_bond = 1;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        updated_bond[0] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keyword">auto</span> any_update = [minimum_bond](<span class="keyword">const</span> std::vector&lt;bool&gt; &amp;bonds)-&gt;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=minimum_bond; loc&lt;bonds.size(); ++loc)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <span class="keywordflow">if</span>(bonds[loc])</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        }</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    };</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    std::size_t counter = 0;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">while</span>(any_update(updated_bond))</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="keywordtype">bool</span> change = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=minimum_bond; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="keywordflow">if</span>(updated_bond[(loc+N_sites-1)%N_sites] or updated_bond[loc])</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[q,deg] : auxdim[loc])</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                    lindep_checks++;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                    <span class="keywordflow">if</span>(eliminate_linearlyDependent_cols((loc+N_sites-1)%N_sites,q,tolerance))</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                    {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                        counter++;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                        updated_bond[loc] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                        change = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="preprocessor">                        #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                        {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                            lout &lt;&lt; <span class="stringliteral">&quot;Current MPO:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                            show();</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                        }</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="preprocessor">                        #endif</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            <span class="keywordflow">if</span>(!change and (updated_bond[loc] or updated_bond[(loc+1)%N_sites]))</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[q,deg] : auxdim[loc])</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                    lindep_checks++;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                    <span class="keywordflow">if</span>(eliminate_linearlyDependent_rows(loc,q,tolerance))</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                        counter++;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                        updated_bond[loc] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                        change = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="preprocessor">                        #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                        {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                            lout &lt;&lt; <span class="stringliteral">&quot;Current MPO:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                            show();</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                        }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="preprocessor">                        #endif</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                    }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="keywordflow">if</span>(change)</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;            }</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(updated_bond[loc])</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;Bond connecting lattice sites &quot;</span> &lt;&lt; (loc+N_sites-1)%N_sites &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;: No linear dependence detected&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                updated_bond[loc] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    }</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keyword">auto</span> [total_auxdim_final, maximum_local_auxdim_final, total_full_auxdim_final, maximum_local_full_auxdim_final] = auxdim_infos();</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordtype">int</span> compr_rate = (int)std::round(100.-(100.*total_auxdim_final)/(1.0*total_auxdim_initial));</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keyword">auto</span> curr_prec = std::cout.precision();</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    ss &lt;&lt; this-&gt;get_name() &lt;&lt; <span class="stringliteral">&quot; - Compression (Old alg.) | &quot;</span> &lt;&lt; watch.info(<span class="stringliteral">&quot;Time&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; | Steps: &quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot; | Rate: &quot;</span> &lt;&lt; compr_rate &lt;&lt; <span class="stringliteral">&quot;% (&quot;</span> &lt;&lt; std::setprecision(1) </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;       &lt;&lt; std::fixed &lt;&lt; (total_auxdim_initial*1.0)/N_sites &lt;&lt; <span class="stringliteral">&quot;(max=&quot;</span> &lt;&lt; maximum_local_auxdim_initial &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <span class="stringliteral">&quot; ⇒ &quot;</span> &lt;&lt; (total_auxdim_final*1.0)/N_sites &lt;&lt; <span class="stringliteral">&quot;(max=&quot;</span> &lt;&lt; maximum_local_auxdim_final &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;) | Linear dependence checks: &quot;</span> &lt;&lt; lindep_checks &lt;&lt; std::defaultfloat &lt;&lt; std::endl;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    std::cout.precision(curr_prec);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        lout &lt;&lt; ss.str();</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;Compressed MPO:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        show();</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        before_verb_set += ss.str();</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;}</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04"> 1437</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<a class="code" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">compress</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> tolerance)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;{</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    std::size_t lindep_checks = 0;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    assert(status == <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a> and <span class="stringliteral">&quot;Terms need to be finalized before compression.&quot;</span>);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;Starting compression of the MPO&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    Stopwatch&lt;&gt; watch;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keyword">auto</span> [total_auxdim_initial, maximum_local_auxdim_initial, total_full_auxdim_initial, maximum_local_full_auxdim_initial] = auxdim_infos();</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    std::vector&lt;std::size_t&gt; bonds_to_check;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">for</span>(std::size_t bond=1; bond&lt;N_sites; bond+=2ul)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        bonds_to_check.push_back(bond);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and N_sites%2 == 1)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        bonds_to_check.push_back(N_sites);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    std::size_t counter = 0;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    std::size_t threads = 1;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="preprocessor">    #ifdef _OPENMP</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    threads = omp_get_max_threads();</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordflow">while</span>(!bonds_to_check.empty())</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        counter++;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        std::vector&lt;std::vector&lt;std::size_t&gt;&gt; next_bonds_to_check(threads);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        std::size_t lindep_checks_temp = 0ul;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor">        #pragma omp parallel for shared(next_bonds_to_check) reduction(+ : lindep_checks_temp)</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordflow">for</span>(std::size_t i=0; i&lt;bonds_to_check.size(); ++i)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            std::size_t thread_id = 0;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="preprocessor">            #ifdef _OPENMP</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            thread_id = omp_get_thread_num();</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            std::size_t loc = bonds_to_check[i];</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            std::vector&lt;qType&gt; qs;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[q,deg] : auxdim[loc])</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                qs.push_back(q);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            <span class="keywordflow">for</span>(std::size_t j=0; j&lt;qs.size(); ++j)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a>&amp; q = qs[j];</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                lindep_checks_temp++;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                <span class="keywordflow">if</span>(eliminate_linearlyDependent_cols(loc-1,q,tolerance))</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                    <span class="keywordflow">if</span>(loc != 1ul)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                    {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                        next_bonds_to_check[thread_id].push_back(loc-1);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                    }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                    <span class="keywordflow">if</span>(loc &lt; N_sites-1)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                    {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                        next_bonds_to_check[thread_id].push_back(loc+1);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                    }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and (loc &lt;= 1ul or loc &gt;= N_sites-1))</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                    {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                        next_bonds_to_check[thread_id].push_back(N_sites);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                    }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                    lindep_checks_temp++;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                    <span class="keywordflow">while</span>(eliminate_linearlyDependent_cols(loc-1,q,tolerance)) {lindep_checks_temp++;}</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc-1 &lt;&lt; <span class="stringliteral">&quot;](...-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): No linear dependent columns detected!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                lindep_checks_temp++;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                <span class="keywordflow">if</span>(eliminate_linearlyDependent_rows(loc%N_sites,q,tolerance))</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                    <span class="keywordflow">if</span>(loc != 1ul)</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                        next_bonds_to_check[thread_id].push_back(loc-1);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                    }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                    <span class="keywordflow">if</span>(loc &lt; N_sites-1)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                    {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                        next_bonds_to_check[thread_id].push_back(loc+1);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                    }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and (loc &lt;= 1ul or loc &gt;= N_sites-1))</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                    {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                        next_bonds_to_check[thread_id].push_back(N_sites);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                    }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                    lindep_checks_temp++;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                    <span class="keywordflow">while</span>(eliminate_linearlyDependent_rows(loc%N_sites,q,tolerance)) {lindep_checks_temp++;}</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                }</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc%N_sites &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;...): No linear dependent rows detected!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        lindep_checks += lindep_checks_temp;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Current MPO:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            show();</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        std::set&lt;std::size_t&gt; unique_control;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keywordflow">if</span>(counter == 1)</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <span class="keywordflow">for</span>(std::size_t bond=2; bond&lt;N_sites; bond+=2ul)</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                unique_control.insert(bond);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            }</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and N_sites%2 == 0)</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                unique_control.insert(N_sites);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="keywordflow">for</span>(std::size_t thread_id=0; thread_id&lt;threads; ++thread_id)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            <span class="keywordflow">for</span>(std::size_t i=0; i&lt;next_bonds_to_check[thread_id].size(); ++i)</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                unique_control.insert(next_bonds_to_check[thread_id][i] != 0 ? next_bonds_to_check[thread_id][i] : N_sites);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        bonds_to_check.resize(0);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <span class="keywordflow">for</span>(std::set&lt;std::size_t&gt;::iterator it = unique_control.begin(); it != unique_control.end(); ++it)</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;            bonds_to_check.push_back(*it);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keyword">auto</span> [total_auxdim_final, maximum_local_auxdim_final, total_full_auxdim_final, maximum_local_full_auxdim_final] = auxdim_infos();</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordtype">int</span> compr_rate = (int)std::round(100.-(100.*total_auxdim_final)/(1.0*total_auxdim_initial));</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keyword">auto</span> curr_prec = std::cout.precision();</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    ss &lt;&lt; this-&gt;get_name() &lt;&lt; <span class="stringliteral">&quot; - Compression (New alg., threads: &quot;</span> &lt;&lt; threads &lt;&lt; <span class="stringliteral">&quot;) | &quot;</span> &lt;&lt; watch.info(<span class="stringliteral">&quot;Time&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; | Steps: &quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot; | Rate: &quot;</span> &lt;&lt; compr_rate &lt;&lt; <span class="stringliteral">&quot;% (&quot;</span> &lt;&lt; std::setprecision(1) &lt;&lt; std::fixed &lt;&lt; (total_auxdim_initial*1.0)/N_sites &lt;&lt; <span class="stringliteral">&quot; ⇒ &quot;</span> &lt;&lt; (total_auxdim_final*1.0)/N_sites &lt;&lt; <span class="stringliteral">&quot;) | Linear dependence checks: &quot;</span> &lt;&lt; lindep_checks &lt;&lt; std::defaultfloat &lt;&lt; std::endl;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    std::cout.precision(curr_prec);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        lout &lt;&lt; ss.str();</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;Compressed MPO:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        show();</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        before_verb_set += ss.str();</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;}</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a503fd03635ba7f298c3e5f04a04ee7dd"> 1592</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a503fd03635ba7f298c3e5f04a04ee7dd">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<a class="code" href="classMpoTerms.html#a503fd03635ba7f298c3e5f04a04ee7dd">eliminate_linearlyDependent_rows</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance)</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;{</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    std::size_t rows = get_auxdim(loc, qIn);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">if</span>(rows == 0)</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordtype">bool</span> SAMESITE = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">if</span>(N_sites == 1 and boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>)</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        SAMESITE = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    assert(hilbert_dimension[loc] &gt; 0);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    std::size_t cols_eff = 0;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    std::size_t hd = hilbert_dimension[loc];</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    std::map&lt;qType,std::vector&lt;std::vector&lt;qType&gt;&gt;&gt; opQs;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qs,ops] : O[loc])</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <span class="keywordflow">if</span>(std::get&lt;0&gt;(qs) != qIn)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        std::vector&lt;std::vector&lt;qType&gt;&gt; opQs_fixed_qOut(ops[0].size());</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <span class="keywordflow">for</span>(std::size_t col=0; col&lt;ops[0].size(); ++col)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            std::unordered_set&lt;qType&gt; unique_control;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;ops.size(); ++row)</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q,op] : ops[row][col])</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                {</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                    unique_control.insert(Q);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                }</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;            cols_eff += (unique_control.size() * hd * hd);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            opQs_fixed_qOut[col].resize(unique_control.size());</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            std::copy(unique_control.begin(), unique_control.end(), opQs_fixed_qOut[col].begin());</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        opQs.insert({std::get&lt;1&gt;(qs), opQs_fixed_qOut});</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    std::size_t rows_eff = rows;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    std::size_t skipcount = 0;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and qIn == qVac)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        rows_eff = rows_eff-2;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    }</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    Eigen::Matrix&lt;Scalar, Eigen::Dynamic, Eigen::Dynamic&gt; mat = Eigen::Matrix&lt;Scalar, Eigen::Dynamic, Eigen::Dynamic&gt;::Zero(rows_eff, cols_eff);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        std::size_t count = 0;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        <span class="keywordflow">if</span>((boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and qIn == qVac and (row == pos_qVac or row == pos_qTot)))</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            skipcount++;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <span class="keywordtype">bool</span> zero_row = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut, deg] : auxdim[loc+1])</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            <span class="keyword">auto</span> it_ops = O[loc].find({qIn,qOut});</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            assert(it_ops != O[loc].end());</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            <span class="keyword">auto</span> it_qs = opQs.find(qOut);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            assert(it_qs != opQs.end());</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            <span class="keywordflow">for</span>(std::size_t col=0; col&lt;deg; ++col)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;            {</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                std::map&lt;qType,OperatorType&gt; &amp;ops = (it_ops-&gt;second)[row][col];</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;(it_qs-&gt;second)[col].size(); ++n)</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                    <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;opQ = (it_qs-&gt;second)[col][n];</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                    <span class="keyword">auto</span> it_op = ops.find(opQ);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                    <span class="keywordflow">if</span>(it_op != ops.end() and (it_op-&gt;second).data.norm() &gt; tolerance)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                    {</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                        zero_row = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                        Eigen::Matrix&lt;Scalar, Eigen::Dynamic, Eigen::Dynamic&gt; opmat((it_op-&gt;second).data);</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                        mat.block(row-skipcount, hd*hd*count, 1, hd*hd) = Eigen::Map&lt;Eigen::Matrix&lt;Scalar, 1, Eigen::Dynamic&gt;&gt;(opmat.data(), hd*hd);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                    }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                    count++;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <span class="keywordflow">if</span>(zero_row)</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            <span class="keywordflow">if</span>(rows &gt; 1)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                {</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;...): Row &quot;</span> &lt;&lt; row &lt;&lt; <span class="stringliteral">&quot; is a zero row, but not the last row in these blocks. Thus it is deleted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                delete_row(loc, qIn, row, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                delete_col((loc+N_sites-1)%N_sites, qIn, row, SAMESITE);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            }</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;...): Row &quot;</span> &lt;&lt; row &lt;&lt; <span class="stringliteral">&quot; is a zero row and the last row in this block. Thus the quantum number is removed from the auxiliar basis to delete the row and the corresponding column at the previous lattice site.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            decrement_auxdim(loc,qIn);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">if</span>(rows &gt; 3 or (rows &gt; 1 and (boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a> or qIn != qVac)))</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    {</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        std::size_t rowskipcount = 0;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="keywordflow">for</span>(std::size_t row_to_delete=0; row_to_delete&lt;rows; ++row_to_delete)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            <span class="keywordflow">if</span>((boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and qIn == qVac and (row_to_delete == pos_qVac or row_to_delete == pos_qTot)))</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                rowskipcount++;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            std::size_t row_to_delete_eff = row_to_delete - rowskipcount;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            Eigen::Matrix&lt;Scalar, Eigen::Dynamic, Eigen::Dynamic&gt; tempmat(cols_eff, rows_eff-1);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            Eigen::Matrix&lt;Scalar, Eigen::Dynamic, 1&gt; tempvec(cols_eff);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            tempvec = mat.block(row_to_delete_eff, 0, 1, cols_eff).transpose();</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            tempmat.block(0,0, cols_eff, row_to_delete_eff) = mat.block(0,0,row_to_delete_eff,cols_eff).transpose();</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            tempmat.block(0,row_to_delete_eff, cols_eff, rows_eff-row_to_delete_eff-1) = mat.block(row_to_delete_eff+1,0,rows_eff-row_to_delete_eff-1,cols_eff).transpose();</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            Eigen::Matrix&lt;Scalar, Eigen::Dynamic, 1&gt; vec = tempmat.colPivHouseholderQr().solve(tempvec);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            <span class="keywordflow">if</span>((tempmat*vec - tempvec).<a class="code" href="DmrgPivotMatrix0_8h.html#a0c09fc9551162052524fc669ea7364a2">norm</a>() &lt; tolerance)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;...): Row &quot;</span> &lt;&lt; row_to_delete &lt;&lt; <span class="stringliteral">&quot; can be written as linear combination of other rows&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                delete_row(loc, qIn, row_to_delete, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                std::map&lt;qType, std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; deleted_col = delete_col((loc+N_sites-1)%N_sites, qIn, row_to_delete, SAMESITE);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                decrement_auxdim(loc,qIn);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                std::size_t cols = get_auxdim(loc,qIn);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                std::size_t colskipcount = 0;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                    <span class="keywordflow">if</span>((boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and qIn == qVac and (col == pos_qVac or col == pos_qTot)))</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                    {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                        colskipcount++;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                    }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                    <span class="keywordflow">if</span>(std::abs(vec(col-colskipcount)) &gt; tolerance)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                    {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                        add_to_col((loc+N_sites-1)%N_sites, qIn, col, deleted_col, vec(col-colskipcount));</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                    }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            }</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;}</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160; </div>
<div class="line"><a name="l01751"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a59899fcbfc527f4491651b5220b59916"> 1751</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a59899fcbfc527f4491651b5220b59916">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<a class="code" href="classMpoTerms.html#a59899fcbfc527f4491651b5220b59916">eliminate_linearlyDependent_cols</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;{</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    std::size_t cols = get_auxdim(loc+1, qOut);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">if</span>(cols == 0)</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    {</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordtype">bool</span> SAMESITE = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">if</span>(N_sites == 1 and boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        SAMESITE = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    assert(hilbert_dimension[loc] &gt; 0);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    std::size_t rows_eff = 0;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    std::size_t hd = hilbert_dimension[loc];</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    std::map&lt;qType,std::vector&lt;std::vector&lt;qType&gt;&gt;&gt; opQs;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qs,ops] : O[loc])</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keywordflow">if</span>(std::get&lt;1&gt;(qs) != qOut)</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        }</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        std::vector&lt;std::vector&lt;qType&gt;&gt; opQs_fixed_qIn(ops.size());</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="keywordflow">for</span>(std::size_t row=0; row&lt;ops.size(); ++row)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            std::unordered_set&lt;qType&gt; unique_control;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            <span class="keywordflow">for</span>(std::size_t col=0; col&lt;ops[row].size(); ++col)</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q,op] : ops[row][col])</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                    unique_control.insert(Q);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                }</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            }</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            rows_eff += (unique_control.size() * hd * hd);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            opQs_fixed_qIn[row].resize(unique_control.size());</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            std::copy(unique_control.begin(), unique_control.end(), opQs_fixed_qIn[row].begin());</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        opQs.insert({std::get&lt;0&gt;(qs), opQs_fixed_qIn});</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    }</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    </div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    std::size_t cols_eff = cols;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    std::size_t skipcount = 0;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and qOut == qVac)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    {</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        cols_eff = cols_eff-2;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    Eigen::Matrix&lt;Scalar, Eigen::Dynamic, Eigen::Dynamic&gt; mat = Eigen::Matrix&lt;Scalar, Eigen::Dynamic, Eigen::Dynamic&gt;::Zero(rows_eff, cols_eff);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        std::size_t count = 0;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordflow">if</span>((boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and qOut == qVac and (col == pos_qVac or col == pos_qTot)))</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        {</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            skipcount++;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        <span class="keywordtype">bool</span> zero_col = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn, deg] : auxdim[loc])</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            <span class="keyword">auto</span> it_ops = O[loc].find({qIn,qOut});</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            assert(it_ops != O[loc].end());</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            <span class="keyword">auto</span> it_qs = opQs.find(qIn);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            assert(it_qs != opQs.end());</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;deg; ++row)</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                std::map&lt;qType,OperatorType&gt; &amp;ops = (it_ops-&gt;second)[row][col];</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;(it_qs-&gt;second)[row].size(); ++n)</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                    <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;opQ = (it_qs-&gt;second)[row][n];</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                    <span class="keyword">auto</span> it_op = ops.find(opQ);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                    <span class="keywordflow">if</span>(it_op != ops.end() and (it_op-&gt;second).data.norm() &gt; tolerance)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                    {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                        zero_col = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                        Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt; opmat((it_op-&gt;second).data);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                        mat.block(hd*hd*count, col-skipcount, hd*hd, 1) = Eigen::Map&lt;Eigen::Matrix&lt;Scalar, Eigen::Dynamic,1&gt;&gt;(opmat.data(), hd*hd);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                    }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                    count++;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                }</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            }</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <span class="keywordflow">if</span>(zero_col)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <span class="keywordflow">if</span>(cols &gt; 1)</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                {</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;](...-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Column &quot;</span> &lt;&lt; col &lt;&lt; <span class="stringliteral">&quot; is a zero column, but not the last column in these blocks. Thus it is deleted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                delete_col(loc, qOut, col, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                delete_row((loc+1)%N_sites, qOut, col, SAMESITE);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            {</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;](...-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Column &quot;</span> &lt;&lt; col &lt;&lt; <span class="stringliteral">&quot; is a zero column and the last column in this block. Thus the quantum number is removed from the auxiliar basis to delete the column and the corresponding row at the next lattice site.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                }</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            decrement_auxdim((loc+1)%N_sites,qOut);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    }</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">if</span>(cols &gt; 3 or ((boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a> or qOut != qVac) and cols&gt;1))</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        std::size_t colskipcount = 0;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        <span class="keywordflow">for</span>(std::size_t col_to_delete=0; col_to_delete&lt;cols; ++col_to_delete)</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            <span class="keywordflow">if</span>((boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and qOut == qVac and (col_to_delete == pos_qVac or col_to_delete == pos_qTot)))</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160; </div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                colskipcount++;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;            std::size_t col_to_delete_eff = col_to_delete - colskipcount;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            Eigen::Matrix&lt;Scalar, Eigen::Dynamic, Eigen::Dynamic&gt; tempmat(rows_eff, cols_eff-1);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;            Eigen::Matrix&lt;Scalar, Eigen::Dynamic, 1&gt; tempvec(rows_eff);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            tempvec = mat.block(0, col_to_delete_eff, rows_eff, 1);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            tempmat.block(0,0, rows_eff, col_to_delete_eff) = mat.block(0, 0, rows_eff, col_to_delete_eff);</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            tempmat.block(0, col_to_delete_eff, rows_eff, cols_eff-col_to_delete_eff-1) = mat.block(0, col_to_delete_eff+1, rows_eff, cols_eff-col_to_delete_eff-1);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160; </div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            Eigen::Matrix&lt;Scalar, Eigen::Dynamic, 1&gt; vec = tempmat.colPivHouseholderQr().solve(tempvec);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            </div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <span class="keywordflow">if</span>((tempmat*vec - tempvec).<a class="code" href="DmrgPivotMatrix0_8h.html#a0c09fc9551162052524fc669ea7364a2">norm</a>() &lt; tolerance)</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            {</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;](...-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Column &quot;</span> &lt;&lt; col_to_delete &lt;&lt; <span class="stringliteral">&quot; can be written as linear combination of other columns&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                }</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                delete_col(loc, qOut, col_to_delete,<span class="keyword">false</span>);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                std::map&lt;qType, std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; deleted_row = delete_row((loc+1)%N_sites, qOut, col_to_delete, SAMESITE);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                decrement_auxdim((loc+1)%N_sites,qOut);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                std::size_t rows = get_auxdim(loc+1,qOut);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                std::size_t rowskipcount = 0;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                {</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                    <span class="keywordflow">if</span>((boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> and qOut == qVac and (row == pos_qVac or row == pos_qTot)))</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                    {</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                        rowskipcount++;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                    }</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                    <span class="keywordflow">if</span>(std::abs(vec(row-rowskipcount)) &gt; tolerance)</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                    {</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                        add_to_row((loc+1)%N_sites, qOut, row, deleted_row, vec(row-rowskipcount));</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                    }</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            }</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        }</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;}</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a540eb7909387ae88971a5d0dda1032be"> 1911</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a540eb7909387ae88971a5d0dda1032be">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<a class="code" href="classMpoTerms.html#a540eb7909387ae88971a5d0dda1032be">add_to_row</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn, <span class="keyword">const</span> std::size_t row, <span class="keyword">const</span> std::map&lt;<a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a>,std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; &amp;ops, <span class="keyword">const</span> Scalar factor)</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;{</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    {</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tO[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;...): Add another row scaled by factor &quot;</span> &lt;&lt; factor &lt;&lt; <span class="stringliteral">&quot; to row &quot;</span> &lt;&lt; row &lt;&lt; std::endl;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    }</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    std::size_t rows = get_auxdim(loc, qIn);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    assert(row &lt; rows and <span class="stringliteral">&quot;Trying to add to a nonexisting row&quot;</span>);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    got_update();</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut, deg] : auxdim[loc+1])</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keyword">auto</span> it = O[loc].find({qIn, qOut});</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="keyword">auto</span> it2 = ops.find(qOut);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        assert(it != O[loc].end());</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        assert(it2 != ops.end());</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        assert((it2-&gt;second).size() == deg and <span class="stringliteral">&quot;Adding rows of different size&quot;</span>);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keywordflow">for</span>(std::size_t col=0; col&lt;deg; ++col)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;            std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[row][col];</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            <span class="keyword">const</span> std::map&lt;qType,OperatorType&gt; &amp;ops_new = (it2-&gt;second)[col];</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q_new,op_new] : ops_new)</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                <span class="keyword">auto</span> it3 = existing_ops.find(Q_new);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                <span class="keywordflow">if</span>(it3 != existing_ops.end())</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                    (it3-&gt;second) += factor*op_new;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                {</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                    existing_ops.insert({Q_new,factor*op_new});</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                }</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            }</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        }</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;}</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; </div>
<div class="line"><a name="l01950"></a><span class="lineno"><a class="line" href="classMpoTerms.html#af017aefebdff6bd775d6f12109233144"> 1950</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#af017aefebdff6bd775d6f12109233144">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<a class="code" href="classMpoTerms.html#af017aefebdff6bd775d6f12109233144">add_to_col</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut, <span class="keyword">const</span> std::size_t col, <span class="keyword">const</span> std::map&lt;<a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a>, std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; &amp;ops, <span class="keyword">const</span> Scalar factor)</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;{</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tO[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;](...-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Add another column scaled by factor &quot;</span> &lt;&lt; factor &lt;&lt; <span class="stringliteral">&quot; to column &quot;</span> &lt;&lt; col &lt;&lt; std::endl;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    std::size_t cols = get_auxdim(loc+1, qOut);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    assert(col &lt; cols and <span class="stringliteral">&quot;Trying to add to a nonexisting col&quot;</span>);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    got_update();</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn, deg] : auxdim[loc])</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        <span class="keyword">auto</span> it = O[loc].find({qIn, qOut});</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        <span class="keyword">auto</span> it2 = ops.find(qIn);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        assert(it != O[loc].end());</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        assert(it2 != ops.end());</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        assert((it2-&gt;second).size() == deg and <span class="stringliteral">&quot;Adding columns of different size&quot;</span>);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">for</span>(std::size_t row=0; row&lt;deg; ++row)</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[row][col];</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            <span class="keyword">const</span> std::map&lt;qType,OperatorType&gt; &amp;ops_new = (it2-&gt;second)[row];</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q_new,op_new] : ops_new)</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                <span class="keyword">auto</span> it3 = existing_ops.find(Q_new);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                <span class="keywordflow">if</span>(it3 != existing_ops.end())</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                    (it3-&gt;second) += factor*op_new;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                }</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                    existing_ops.insert({Q_new,factor*op_new});</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        }</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    }</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;}</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1"> 1989</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::map&lt;typename Symmetry::qType,std::vector&lt;std::map&lt;typename Symmetry::qType,SiteOperator&lt;Symmetry,Scalar&gt;&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<a class="code" href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1">delete_row</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn, <span class="keyword">const</span> std::size_t row_to_delete, <span class="keyword">const</span> <span class="keywordtype">bool</span> SAMESITE)</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;{</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tO[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;...): Delete row &quot;</span> &lt;&lt; row_to_delete &lt;&lt; std::endl;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        <span class="keywordflow">if</span>(SAMESITE)</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;\tPaying attention since a column has been deleted at the same site before&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        }</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    std::map&lt;qType, std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; deleted_row;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    std::size_t rows = get_auxdim(loc, qIn);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    assert(row_to_delete &lt; rows and <span class="stringliteral">&quot;Trying to delete a nonexisting row&quot;</span>);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    got_update();</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut, deg] : auxdim[loc+1])</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        <span class="keyword">auto</span> it = O[loc].find({qIn, qOut});</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        assert(it != O[loc].end());</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        std::size_t skip = 0;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <span class="keywordflow">if</span>(SAMESITE and qOut == qIn)</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            skip = 1;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        }</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="keywordflow">for</span>(std::size_t col=0; col&lt;deg-skip; ++col)</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            temp.push_back((it-&gt;second)[row_to_delete][col]);</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=row_to_delete; row&lt;rows-1; ++row)</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                (it-&gt;second)[row][col] = (it-&gt;second)[row+1][col];</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            }</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            (it-&gt;second)[rows-1][col] = empty_op_map;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        deleted_row.insert({qOut, temp});</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">return</span> deleted_row;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;}</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45"> 2031</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::map&lt;typename Symmetry::qType,std::vector&lt;std::map&lt;typename Symmetry::qType,SiteOperator&lt;Symmetry,Scalar&gt;&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<a class="code" href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45">delete_col</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut, <span class="keyword">const</span> std::size_t col_to_delete, <span class="keyword">const</span> <span class="keywordtype">bool</span> SAMESITE)</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;{</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tO[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;](...-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Delete column &quot;</span> &lt;&lt; col_to_delete &lt;&lt; std::endl;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        <span class="keywordflow">if</span>(SAMESITE)</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;\tPaying attention since a row has been deleted at the same site before&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    std::map&lt;qType, std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; deleted_col;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    std::size_t cols = get_auxdim(loc+1, qOut);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    assert(col_to_delete &lt; cols and <span class="stringliteral">&quot;Trying to delete a nonexisting column&quot;</span>);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    got_update();</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn, deg] : auxdim[loc])</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keyword">auto</span> it = O[loc].find({qIn, qOut});</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;        assert(it != O[loc].end());</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        std::size_t skip = 0;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        <span class="keywordflow">if</span>(SAMESITE and qIn == qOut)</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        {</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;            skip = 1;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <span class="keywordflow">for</span>(std::size_t row=0; row&lt;deg-skip; ++row)</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            temp.push_back((it-&gt;second)[row][col_to_delete]);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            <span class="keywordflow">for</span>(std::size_t col=col_to_delete; col&lt;cols-1; ++col)</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;            {</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                (it-&gt;second)[row][col] = (it-&gt;second)[row][col+1];</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            }</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            (it-&gt;second)[row][cols-1] = empty_op_map;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        deleted_col.insert({qIn, temp});</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">return</span> deleted_col;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;}</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; </div>
<div class="line"><a name="l02073"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ada00ad294f429b62b093ea45c6ea62d2"> 2073</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ada00ad294f429b62b093ea45c6ea62d2">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<a class="code" href="classMpoTerms.html#ada00ad294f429b62b093ea45c6ea62d2">add</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="structSiteOperator.html">OperatorType</a> &amp;op, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut, <span class="keyword">const</span> std::size_t leftIndex, <span class="keyword">const</span> std::size_t rightIndex)</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;{</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="preprocessor">        #ifdef OPLABELS</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;})[&quot;</span> &lt;&lt; leftIndex &lt;&lt; <span class="stringliteral">&quot;|&quot;</span> &lt;&lt; rightIndex &lt;&lt; <span class="stringliteral">&quot;]: Add &quot;</span> &lt;&lt; op.<a class="code" href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">label</a> &lt;&lt; <span class="stringliteral">&quot; ({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(op.<a class="code" href="structSiteOperator.html#a8e83604df485e170d2c7a01d7fc3229f">Q</a>) &lt;&lt; <span class="stringliteral">&quot;})&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="preprocessor">        #else</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;O[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;})[&quot;</span> &lt;&lt; leftIndex &lt;&lt; <span class="stringliteral">&quot;|&quot;</span> &lt;&lt; rightIndex &lt;&lt; <span class="stringliteral">&quot;]: Add Operator ({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(op.<a class="code" href="structSiteOperator.html#a8e83604df485e170d2c7a01d7fc3229f">Q</a>) &lt;&lt; <span class="stringliteral">&quot;})&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    }</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    std::size_t rows = get_auxdim(loc, qIn);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    std::size_t cols = get_auxdim(loc+1, qOut);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="keyword">auto</span> it = O[loc].find({qIn, qOut});</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    assert(leftIndex &lt;= rows and <span class="stringliteral">&quot;Index out of bounds&quot;</span>);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    assert(rightIndex &lt;= cols and <span class="stringliteral">&quot;Index out of bounds&quot;</span>);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    assert(it != O[loc].end() and <span class="stringliteral">&quot;Quantum numbers not available&quot;</span>);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    got_update();</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[leftIndex][rightIndex];</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keyword">auto</span> it2 = existing_ops.find(op.<a class="code" href="structSiteOperator.html#a8e83604df485e170d2c7a01d7fc3229f">Q</a>);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keywordflow">if</span>(it2 != existing_ops.end())</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    {</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        (it2-&gt;second) += op;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        existing_ops.insert({op.<a class="code" href="structSiteOperator.html#a8e83604df485e170d2c7a01d7fc3229f">Q</a>,op});</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;}</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"><a class="line" href="classMpoTerms.html#acf9fa7121f8720860d44179a898be76d"> 2105</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#acf9fa7121f8720860d44179a898be76d">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<a class="code" href="classMpoTerms.html#acf9fa7121f8720860d44179a898be76d">increment_auxdim</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;q)</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;{</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tqAux[&quot;</span> &lt;&lt; (loc+N_sites-1)%N_sites &lt;&lt; <span class="stringliteral">&quot;-&gt;&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): &quot;</span>;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    got_update();</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordflow">if</span>(loc != 0)</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    {</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        assert(loc &lt; N_sites);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <span class="keyword">auto</span> it = auxdim[loc].find(q);</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="keywordflow">if</span>(it == auxdim[loc].end())</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        {</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            {</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;New counter started&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            }</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qPrev,dimPrev] : auxdim[loc-1])</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                {</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; loc-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPrev) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Block created with one column of operators (number of rows: &quot;</span> &lt;&lt; dimPrev &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_col(1,empty_op_map);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp_ops(dimPrev,temp_col);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                O[loc-1].insert({{qPrev,q},temp_ops});</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qNext,dimNext] : auxdim[loc+1])</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            {</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qNext) &lt;&lt; <span class="stringliteral">&quot;}): Block created with one row of operators (number of columns: &quot;</span> &lt;&lt; dimNext &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                }</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_col(dimNext,empty_op_map);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp_ops(1,temp_col);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                O[loc].insert({{q,qNext},temp_ops});</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            auxdim[loc].insert({q,1});</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        }</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        {</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;Counter incremented to &quot;</span> &lt;&lt; (it-&gt;second)+1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qPrev,dimPrev] : auxdim[loc-1])</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;            {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                {</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; loc-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPrev) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Create a new column of operators (number of rows: &quot;</span> &lt;&lt; dimPrev &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                <span class="keyword">auto</span> it_prev = O[loc-1].find({qPrev,q});</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                assert(it_prev != O[loc-1].end());</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;dimPrev; ++row)</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                    (it_prev-&gt;second)[row].push_back(empty_op_map);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;            }</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qNext,dimNext] : auxdim[loc+1])</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;            {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qNext) &lt;&lt; <span class="stringliteral">&quot;}): Create a new row of operators (number of columns: &quot;</span> &lt;&lt; dimNext &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                }</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                <span class="keyword">auto</span> it_next = O[loc].find({q,qNext});</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                assert(it_next != O[loc].end());</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_row(dimNext, empty_op_map);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                (it_next-&gt;second).push_back(temp_row);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;            }</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            (it-&gt;second)++;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    }</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    {</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>);</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        <span class="keyword">auto</span> it = auxdim[0].find(q);</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        <span class="keywordflow">if</span>(it == auxdim[0].end())</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;New counter started&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qPrev,dimPrev] : auxdim[N_sites-1])</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                {</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPrev) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Block created with one column of operators (number of rows: &quot;</span> &lt;&lt; dimPrev &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_col(1,empty_op_map);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp_ops(dimPrev,temp_col);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                O[N_sites-1].insert({{qPrev,q},temp_ops});</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qNext,dimNext] : auxdim[1])</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;            {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qNext) &lt;&lt; <span class="stringliteral">&quot;}): Block created with one row of operators (number of columns: &quot;</span> &lt;&lt; dimNext &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_col(dimNext,empty_op_map);</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp_ops(1,temp_col);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                O[0].insert({{q,qNext},temp_ops});</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            auxdim[0].insert({q,1});</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            auxdim[N_sites].insert({q,1});</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        }</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        {</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;            {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;Counter incremented to &quot;</span> &lt;&lt; (it-&gt;second)+1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            }</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qPrev,dimPrev] : auxdim[N_sites-1])</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            {</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                {</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPrev) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Create a new column of operators (number of rows: &quot;</span> &lt;&lt; dimPrev &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                }</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                <span class="keyword">auto</span> it_prev = O[N_sites-1].find({qPrev,q});</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                assert(it_prev != O[N_sites-1].end());</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;dimPrev; ++row)</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                {</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                    (it_prev-&gt;second)[row].push_back(empty_op_map);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qNext,dimNext] : auxdim[1])</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;            {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                {</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qNext) &lt;&lt; <span class="stringliteral">&quot;}): Create a new row of operators (number of columns: &quot;</span> &lt;&lt; dimNext &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                }</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                <span class="keyword">auto</span> it_next = O[0].find({q,qNext});</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                assert(it_next != O[0].end());</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_row(dimNext, empty_op_map);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                (it_next-&gt;second).push_back(temp_row);</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;            (it-&gt;second)++;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            <span class="keyword">auto</span> it_edge = auxdim[N_sites].find(q);</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;            assert(it_edge != auxdim[N_sites].end());</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;            (it_edge-&gt;second)++;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        }</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        <span class="keywordflow">if</span>(N_sites == 1)</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        {</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="keyword">auto</span> it = O[0].find({q,q});</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            <span class="keywordflow">if</span>(it == O[0].end())</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            {</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Create a new block of operators with 1 row and 1 column&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_col(1,empty_op_map);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp_ops(1,temp_col);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                O[0].insert({{q,q},temp_ops});</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                {</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Add the corner operator&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                }</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                (it-&gt;second)[(it-&gt;second).size()-1].push_back(empty_op_map);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            }</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        }</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;}</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ad4af68f18ba1cd31be54f7a456c78286"> 2302</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ad4af68f18ba1cd31be54f7a456c78286">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<a class="code" href="classMpoTerms.html#ad4af68f18ba1cd31be54f7a456c78286">increment_first_auxdim_OBC</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn)</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;{</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tqAux[left edge-&gt;0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}): &quot;</span>;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    got_update();</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keyword">auto</span> it = auxdim[0].find(qIn);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keywordflow">if</span>(it == auxdim[0].end())</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        {</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;New counter started&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        }</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut,deg] : auxdim[1])</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        {</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            {</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Block created with one row of operators (number of columns: &quot;</span> &lt;&lt; deg &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_col(deg,empty_op_map);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp_ops(1,temp_col);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            O[0].insert({{qIn,qOut},temp_ops});</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        auxdim[0].insert({qIn,1});</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    }</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Counter incremented to &quot;</span> &lt;&lt; (it-&gt;second)+1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut,deg] : auxdim[1])</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        {</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            {</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Create a new row of operators (number of columns: &quot;</span> &lt;&lt; deg &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            }</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            <span class="keyword">auto</span> it_ops = O[0].find({qIn,qOut});</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            assert(it_ops != O[0].end());</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_row(deg, empty_op_map);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            (it_ops-&gt;second).push_back(temp_row);</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        }</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        (it-&gt;second)++;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    }</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;}</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ac77ed69cd6d0b71193358faba4ce23e9"> 2362</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#ac77ed69cd6d0b71193358faba4ce23e9">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<a class="code" href="classMpoTerms.html#ac77ed69cd6d0b71193358faba4ce23e9">increment_last_auxdim_OBC</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut)</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;{</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>);</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    {</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tqAux[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;-&gt;right edge]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): &quot;</span>;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    }</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    got_update();</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <span class="keyword">auto</span> it = auxdim[N_sites].find(qOut);</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <span class="keywordflow">if</span>(it == auxdim[N_sites].end())</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    {</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        {</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;New counter started&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        }</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn,deg] : auxdim[N_sites-1])</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;            {</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Block created with one column of operators (number of rows: &quot;</span> &lt;&lt; deg &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;            }</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_col(1,empty_op_map);</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp_ops(deg,temp_col);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            O[N_sites-1].insert({{qIn,qOut},temp_ops});</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        auxdim[N_sites].insert({qOut,1});</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    }</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    {</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        {</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Counter incremented to &quot;</span> &lt;&lt; (it-&gt;second)+1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        }</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn,deg] : auxdim[N_sites-1])</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        {</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;            {</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Create a new column of operators (number of rows: &quot;</span> &lt;&lt; deg &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            }</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            <span class="keyword">auto</span> it_ops = O[N_sites-1].find({qIn,qOut});</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            assert(it_ops != O[N_sites-1].end());</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;deg; ++row)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                (it_ops-&gt;second)[row].push_back(empty_op_map);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        (it-&gt;second)++;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    }</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;}</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a037a5789f20cfbb4e76fa33d62529269"> 2424</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a037a5789f20cfbb4e76fa33d62529269">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<a class="code" href="classMpoTerms.html#a037a5789f20cfbb4e76fa33d62529269">decrement_auxdim</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;q)</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;{</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    {</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tqAux[&quot;</span> &lt;&lt; (loc+N_sites-1)%N_sites &lt;&lt; <span class="stringliteral">&quot;-&gt;&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): &quot;</span>;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    }</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    got_update();</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="keyword">auto</span> it = auxdim[loc].find(q);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    assert(it != auxdim[loc].end());</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keywordflow">if</span>(loc != 0)</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        assert(loc &lt; N_sites);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        <span class="keywordflow">if</span>(it-&gt;second == 1)</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        {</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;            {</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;Quantum number deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;            }</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qPrev,dimPrev] : auxdim[loc-1])</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;            {</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; loc-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPrev) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Block deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                }</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                O[loc-1].erase({qPrev,q});</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;            }</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qNext,dimNext] : auxdim[loc+1])</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                {</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qNext) &lt;&lt; <span class="stringliteral">&quot;}): Block deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                }</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                O[loc].erase({q,qNext});</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;            }</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;            auxdim[loc].erase(q);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;            {</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;Counter decremented to &quot;</span> &lt;&lt; (it-&gt;second)-1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;            }</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qPrev,dimPrev] : auxdim[loc-1])</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; loc-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPrev) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Delete a column of operators (number of rows: &quot;</span> &lt;&lt; dimPrev &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                }</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                <span class="keyword">auto</span> it_prev = O[loc-1].find({qPrev,q});</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                assert(it_prev != O[loc-1].end());</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;dimPrev; ++row)</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                    (it_prev-&gt;second)[row].resize((it_prev-&gt;second)[row].size()-1);</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                }</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            }</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qNext,dimNext] : auxdim[loc+1])</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            {</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qNext) &lt;&lt; <span class="stringliteral">&quot;}): Delete a row of operators (number of columns: &quot;</span> &lt;&lt; dimNext &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                }</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                <span class="keyword">auto</span> it_next = O[loc].find({q,qNext});</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                assert(it_next != O[loc].end());</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                (it_next-&gt;second).resize((it_next-&gt;second).size()-1);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;            }</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;            (it-&gt;second)--;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        }</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    }</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    {</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>);</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        <span class="keywordflow">if</span>(it-&gt;second == 1)</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        {</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            {</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;Quantum number deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            }</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qPrev,dimPrev] : auxdim[N_sites-1])</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            {</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                {</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPrev) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Block deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                }</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                O[N_sites-1].erase({qPrev,q});</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            }</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qNext,dimNext] : auxdim[1])</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            {</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tOperators[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qNext) &lt;&lt; <span class="stringliteral">&quot;}): Block deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                O[0].erase({q,qNext});</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            }</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;            auxdim[0].erase(q);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            auxdim[N_sites].erase(q);</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        }</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        {</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            {</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;Counter decremented to &quot;</span> &lt;&lt; (it-&gt;second)-1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;            }</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qPrev,dimPrev] : auxdim[N_sites-1])</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;            {</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;                {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qPrev) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}): Delete a column of operators (number of rows: &quot;</span> &lt;&lt; dimPrev &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;                }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                <span class="keyword">auto</span> it_prev = O[N_sites-1].find({qPrev,q});</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                assert(it_prev != O[N_sites-1].end());</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;dimPrev; ++row)</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                {</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                    (it_prev-&gt;second)[row].resize((it_prev-&gt;second)[row].size()-1);</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                }</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            }</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qNext,dimNext] : auxdim[1])</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;            {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                {</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(q) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qNext) &lt;&lt; <span class="stringliteral">&quot;}): Delete a row of operators (number of columns: &quot;</span> &lt;&lt; dimNext &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                }</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                <span class="keyword">auto</span> it_next = O[0].find({q,qNext});</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                assert(it_next != O[0].end());</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                (it_next-&gt;second).resize((it_next-&gt;second).size()-1);</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;            }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;            (it-&gt;second)--;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            <span class="keyword">auto</span> it_edge = auxdim[N_sites].find(q);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            assert(it_edge != auxdim[N_sites].end());</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            (it_edge-&gt;second)--;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        }</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    }</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;}</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160; </div>
<div class="line"><a name="l02585"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a50686e5f9fb163156350c4804cc3f630"> 2585</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a50686e5f9fb163156350c4804cc3f630">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<a class="code" href="classMpoTerms.html#a50686e5f9fb163156350c4804cc3f630">decrement_first_auxdim_OBC</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qIn)</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;{</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    {</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tqAux[left edge-&gt;0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}): &quot;</span>;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    got_update();</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <span class="keyword">auto</span> it = auxdim[0].find(qIn);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    assert(it != auxdim[0].end());</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keywordflow">if</span>(it-&gt;second == 1)</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    {</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;        {</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Quantum number deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        }</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut,deg] : auxdim[1])</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;            {</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Block deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;            }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;            O[0].erase({qIn,qOut});</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        }</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        auxdim[0].erase(qIn);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    }</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    {</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        {</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Counter decremented to &quot;</span> &lt;&lt; (it-&gt;second)-1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut,deg] : auxdim[1])</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        {</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;            {</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[0]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Delete a row of operators (number of columns: &quot;</span> &lt;&lt; deg &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;            }</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;            <span class="keyword">auto</span> it_ops = O[0].find({qIn,qOut});</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;            assert(it_ops != O[0].end());</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;            (it_ops-&gt;second).resize((it_ops-&gt;second).size()-1);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        }</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        (it-&gt;second)--;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;}</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a81f461a56543a78c0a8f03fcca9b5de9"> 2642</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a81f461a56543a78c0a8f03fcca9b5de9">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<a class="code" href="classMpoTerms.html#a81f461a56543a78c0a8f03fcca9b5de9">decrement_last_auxdim_OBC</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qOut)</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;{</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>);</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="preprocessor">    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    {</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\tqAux[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;-&gt;right edge]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): &quot;</span>;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    }</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    got_update();</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <span class="keyword">auto</span> it = auxdim[N_sites].find(qOut);</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    assert(it != auxdim[N_sites].end());</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keywordflow">if</span>(it-&gt;second == 1)</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    {</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        {</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Quantum number deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        }</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn,deg] : auxdim[N_sites-1])</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        {</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            {</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Block deleted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            }</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;            O[N_sites-1].erase({qIn,qOut});</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        }</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        auxdim[N_sites].erase(qOut);</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    }</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    {</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;        {</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Counter decremented to &quot;</span> &lt;&lt; (it-&gt;second)-1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        }</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn,deg] : auxdim[N_sites-1])</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        {</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="preprocessor">            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            {</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                lout &lt;&lt; <span class="stringliteral">&quot;\t\tO[&quot;</span> &lt;&lt; N_sites-1 &lt;&lt; <span class="stringliteral">&quot;]({&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;}): Delete a column of operators (number of rows: &quot;</span> &lt;&lt; deg &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            }</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            <span class="keyword">auto</span> it_ops = O[N_sites-1].find({qIn,qOut});</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;            assert(it_ops != O[N_sites-1].end());</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;deg; ++row)</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            {</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                (it_ops-&gt;second)[row].resize((it_ops-&gt;second)[row].size()-1);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;            }</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        }</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        (it-&gt;second)--;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;}</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160; </div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160; </div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160; </div>
<div class="line"><a name="l02704"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a944d0323c6ad445cdf217445b86a9216"> 2704</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::size_t <a class="code" href="classMpoTerms.html#a944d0323c6ad445cdf217445b86a9216">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<a class="code" href="classMpoTerms.html#a944d0323c6ad445cdf217445b86a9216">get_auxdim</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;q)<span class="keyword"> const</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    std::size_t loc_eff;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>)</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    {</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        loc_eff = loc%N_sites;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    }</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        loc_eff = loc;</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    }</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keyword">auto</span> it = auxdim[loc_eff].find(q);</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    <span class="keywordflow">if</span> (it != auxdim[loc_eff].end())</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    {</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        <span class="keywordflow">return</span> (it-&gt;second);</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    }</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;}</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160; </div>
<div class="line"><a name="l02727"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a36e9956082a09f9fb2d56120de38be16"> 2727</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a36e9956082a09f9fb2d56120de38be16">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<a class="code" href="classMpoTerms.html#a36e9956082a09f9fb2d56120de38be16">assert_hilbert</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> std::size_t <a class="code" href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a>)</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;{</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <span class="keywordflow">if</span>(hilbert_dimension[loc] == 0)</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    {</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        hilbert_dimension[loc] = <a class="code" href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a>;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    {</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        <span class="keywordflow">if</span> (hilbert_dimension[loc] != <a class="code" href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a>)</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        {</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;            lout &lt;&lt; termcolor::red &lt;&lt; <span class="stringliteral">&quot;hilbert_dimension[loc]=&quot;</span> &lt;&lt; hilbert_dimension[loc] &lt;&lt; <span class="stringliteral">&quot;, dim=&quot;</span> &lt;&lt; <a class="code" href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a> &lt;&lt; termcolor::reset &lt;&lt; endl;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        }</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        assert(hilbert_dimension[loc] == <a class="code" href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a> and <span class="stringliteral">&quot;Dimensions of operator and local Hilbert space do not match!&quot;</span>);</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    }</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;}</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160; </div>
<div class="line"><a name="l02744"></a><span class="lineno"><a class="line" href="classMpoTerms.html#adb2a09be541f434ab3cb0f2d64f5efc0"> 2744</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#adb2a09be541f434ab3cb0f2d64f5efc0">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<a class="code" href="classMpoTerms.html#adb2a09be541f434ab3cb0f2d64f5efc0">save_label</a> (<span class="keyword">const</span> std::size_t loc, <span class="keyword">const</span> std::string &amp;info_label)</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;{</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    assert(loc &lt; N_sites and <span class="stringliteral">&quot;Chosen lattice site out of bounds&quot;</span>);</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <span class="keywordflow">if</span>(info_label != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    {</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        info[loc].push_back(info_label);</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    }</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;}</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160; </div>
<div class="line"><a name="l02754"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a22d6f4fe971d81465f2dc32b95ec0e4c"> 2754</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::vector&lt;std::string&gt; <a class="code" href="classMpoTerms.html#a22d6f4fe971d81465f2dc32b95ec0e4c">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<a class="code" href="classMpoTerms.html#a22d6f4fe971d81465f2dc32b95ec0e4c">get_info</a> ()<span class="keyword"> const</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    std::vector&lt;std::string&gt; res(N_sites);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    {</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        <span class="keywordflow">if</span> (info[loc].size()&gt;0)</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            std::copy(info[loc].begin(), info[loc].end()-1, std::ostream_iterator&lt;std::string&gt;(ss,<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            ss &lt;&lt; info[loc].back();</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        {</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;            ss &lt;&lt; <span class="stringliteral">&quot;no info&quot;</span>;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        }</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        </div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        res[loc] = ss.str();</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        </div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;perp&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;perp&quot;</span>), 4, <span class="stringliteral">&quot;⟂&quot;</span>);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;para&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;para&quot;</span>), 4, <span class="stringliteral">&quot;∥&quot;</span>);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;prime&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;prime&quot;</span>), 5, <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;Perp&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;Perp&quot;</span>), 4, <span class="stringliteral">&quot;⟂&quot;</span>);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;Para&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;Para&quot;</span>), 4, <span class="stringliteral">&quot;∥&quot;</span>);</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;Prime&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;Prime&quot;</span>), 5, <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;mu&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;mu&quot;</span>), 2, <span class="stringliteral">&quot;µ&quot;</span>);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;Delta&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;Delta&quot;</span>), 5, <span class="stringliteral">&quot;Δ&quot;</span>);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;next&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;next&quot;</span>), 4, <span class="stringliteral">&quot;ₙₑₓₜ&quot;</span>);</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;prev&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;prev&quot;</span>), 4, <span class="stringliteral">&quot;ₚᵣₑᵥ&quot;</span>);</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;3site&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;3site&quot;</span>), 5, <span class="stringliteral">&quot;₃ₛᵢₜₑ&quot;</span>);</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;sub&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;sub&quot;</span>), 3, <span class="stringliteral">&quot;ˢᵘᵇ&quot;</span>);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;rung&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;rung&quot;</span>), 4, <span class="stringliteral">&quot;ʳᵘⁿᵍ&quot;</span>);</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        <span class="keywordflow">while</span> (res[loc].find(<span class="stringliteral">&quot;t0&quot;</span>) != std::string::npos) res[loc].replace(res[loc].find(<span class="stringliteral">&quot;t0&quot;</span>), 2, <span class="stringliteral">&quot;t₀&quot;</span>);</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        </div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        <span class="comment">//⁰ ¹ ² ³ ⁴ ⁵ ⁶ ⁷ ⁸ ⁹ ⁺ ⁻ ⁼ ⁽ ⁾ ₀ ₁ ₂ ₃ ₄ ₅ ₆ ₇ ₈ ₉ ₊ ₋ ₌ ₍ ₎</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        <span class="comment">//ᵃ ᵇ ᶜ ᵈ ᵉ ᶠ ᵍ ʰ ⁱ ʲ ᵏ ˡ ᵐ ⁿ ᵒ ᵖ ʳ ˢ ᵗ ᵘ ᵛ ʷ ˣ ʸ ᶻ</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <span class="comment">//ᴬ ᴮ ᴰ ᴱ ᴳ ᴴ ᴵ ᴶ ᴷ ᴸ ᴹ ᴺ ᴼ ᴾ ᴿ ᵀ ᵁ ⱽ ᵂ</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        <span class="comment">//ₐ ₑ ₕ ᵢ ⱼ ₖ ₗ ₘ ₙ ₒ ₚ ᵣ ₛ ₜ ᵤ ᵥ ₓ</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <span class="comment">//ᵅ ᵝ ᵞ ᵟ ᵋ ᶿ ᶥ ᶲ ᵠ ᵡ ᵦ ᵧ ᵨ ᵩ ᵪ</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    }</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;}</div>
<div class="line"><a name="l02796"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a82c026d1a3a6c4e42e59320a76bb9f44"> 2796</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry, Eigen::SparseMatrix&lt;Scalar,Eigen::ColMajor,EIGEN_DEFAULT_SPARSE_INDEX_TYPE&gt;&gt;&gt;&gt;&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a82c026d1a3a6c4e42e59320a76bb9f44">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<a class="code" href="classMpoTerms.html#a82c026d1a3a6c4e42e59320a76bb9f44">get_W_power</a> (std::size_t power)<span class="keyword"> const</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    assert(power &gt; 0 and <span class="stringliteral">&quot;Power has to be at least 1&quot;</span>);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    assert(power &lt;= current_power and <span class="stringliteral">&quot;This power of the MPO has not been calculated!&quot;</span>);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    <span class="keywordflow">if</span>(power == 1)</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    {</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        <span class="keywordflow">return</span> W;</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    }</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    {</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        <span class="keywordflow">return</span> W_powers[power-2];</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    }</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;}</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; </div>
<div class="line"><a name="l02811"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a056cc8e2dd6c915ca6112b9eab5eb73e"> 2811</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keyword">const</span> std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a056cc8e2dd6c915ca6112b9eab5eb73e">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<a class="code" href="classMpoTerms.html#a056cc8e2dd6c915ca6112b9eab5eb73e">get_qAux_power</a> (std::size_t power)<span class="keyword"> const</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    assert(power &gt; 0 and <span class="stringliteral">&quot;Power has to be at least 1&quot;</span>);</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    assert(power &lt;= current_power and <span class="stringliteral">&quot;This power of the MPO has not been calculated!&quot;</span>);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    <span class="keywordflow">if</span>(power == 1)</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    {</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="keywordflow">return</span> qAux;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    }</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    {</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        <span class="keywordflow">return</span> qAux_powers[power-2];</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    }</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;}</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160; </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160; </div>
<div class="line"><a name="l02827"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a89d4a7d72e78c0e62b2c26fc154b91eb"> 2827</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keyword">const</span> std::vector&lt;std::vector&lt;typename Symmetry::qType&gt;&gt; &amp;<a class="code" href="classMpoTerms.html#a89d4a7d72e78c0e62b2c26fc154b91eb">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<a class="code" href="classMpoTerms.html#a89d4a7d72e78c0e62b2c26fc154b91eb">get_qOp_power</a> (std::size_t power)<span class="keyword"> const</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    assert(power &gt; 0 and <span class="stringliteral">&quot;Power has to be at least 1&quot;</span>);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    assert(power &lt;= current_power and <span class="stringliteral">&quot;This power of the MPO has not been calculated!&quot;</span>);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="keywordflow">if</span>(power == 1)</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    {</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        <span class="keywordflow">return</span> qOp;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    {</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordflow">return</span> qOp_powers[power-2];</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    }</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;}</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160; </div>
<div class="line"><a name="l02842"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a2ae5c2f5b161751796f20ee3eb56c95d"> 2842</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">bool</span> <a class="code" href="classMpoTerms.html#a2ae5c2f5b161751796f20ee3eb56c95d">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<a class="code" href="classMpoTerms.html#a2ae5c2f5b161751796f20ee3eb56c95d">check_qPhys</a> ()<span class="keyword"> const</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="keywordtype">bool</span> all = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    {</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <span class="keywordflow">if</span>(!GOT_QPHYS[loc])</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        {</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;            all = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    <span class="keywordflow">return</span> all;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;}</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160; </div>
<div class="line"><a name="l02856"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a240574966a2d46584d23e3e4da2ec8e0"> 2856</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a240574966a2d46584d23e3e4da2ec8e0">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<a class="code" href="classMpoTerms.html#a240574966a2d46584d23e3e4da2ec8e0">scale</a> (<span class="keyword">const</span> Scalar factor, <span class="keyword">const</span> Scalar offset, <span class="keyword">const</span> std::size_t power, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance)</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;{</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    std::size_t calc_to_power = (power != 0 ? power : current_power);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    </div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    <span class="keywordflow">if</span> (std::abs(factor-1.) &gt; ::mynumeric_limits&lt;double&gt;::epsilon() or std::abs(offset) &gt; tolerance)</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    {</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        got_update();</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    }</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    </div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <span class="keywordflow">if</span> (std::abs(factor-1.) &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    {</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment">//      lout &lt;&lt; termcolor::blue &lt;&lt; &quot;SCALING&quot; &lt;&lt; &quot;, std::abs(factor-1.)=&quot; &lt;&lt; std::abs(factor-1.) &lt;&lt; termcolor::reset &lt;&lt; endl;</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        </div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment">//        bool sign_factor = (factor &lt; 0. ? true : false);</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        <span class="keywordtype">bool</span> sign_factor = (std::abs(std::arg(factor)) &gt; 0. ? true : <span class="keyword">false</span>);</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        </div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="keywordtype">double</span> factor_per_site = std::pow(std::abs(factor), 1./(1.*N_sites));</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        {</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn, rows] : auxdim[loc])</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;            {</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut, cols] : auxdim[loc+1])</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                {</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                    <span class="keyword">auto</span> it = O[loc].find({qIn,qOut});</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                    assert(it != O[loc].end());</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;                    <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                    {</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                        <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                        {</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                            std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[row][col];</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                            <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[q,op] : existing_ops)</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                            {</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                                 op = factor_per_site*op;</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                            }</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                        }</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                    }</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                }</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;            }</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        }</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        <span class="keywordflow">if</span>(sign_factor)</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        {</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;            <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a> or status == <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">MPO_STATUS::ALTERABLE</a>)</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;            {</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                {</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut, cols] : auxdim[loc+1])</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                    {</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                        <span class="keyword">auto</span> it = O[loc].find({qVac,qOut});</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                        assert(it != O[loc].end());</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                        <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                        {</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                            <span class="keywordflow">if</span>(col == pos_qVac)</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                            {</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                            }</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                            std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[pos_qVac][col];</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                            <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[q,op] : existing_ops)</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                            {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                                <span class="keywordflow">if</span> constexpr(std::is_same&lt;Scalar,complex&lt;double&gt;&gt;::value)</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                                {</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                                    op = exp(1.i*std::arg(factor))*op;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                                }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                                {</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                                    op = -1.*op;</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                                }</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                            }</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                        }</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                    }</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                }</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;            }</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;            {</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn,rows] : auxdim[0])</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                {</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut,cols] : auxdim[1])</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                    {</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                        <span class="keyword">auto</span> it = O[0].find({qIn,qOut});</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                        assert(it != O[0].end());</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                        <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                        {</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                            <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                            {</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                                std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[row][col];</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                                <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[q,op] : existing_ops)</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                                {</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                                    <span class="keywordflow">if</span> constexpr(std::is_same&lt;Scalar,complex&lt;double&gt;&gt;::value)</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                                    {</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                                        op = exp(1.i*std::arg(factor))*op;</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;                                    }</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;                                    {</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;                                        op = -1.*op;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                                    }</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                                }</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                            }</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                        }</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                    }</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                }</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;            }</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        }</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    <span class="keywordflow">if</span> (std::abs(offset) &gt; tolerance)</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    {</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <span class="comment">//bool sign_offset = (offset &lt; 0. ? true : false);</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        <span class="comment">//cout &lt;&lt; boolalpha &lt;&lt; &quot;sign_offset=&quot; &lt;&lt; sign_offset &lt;&lt; endl;</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        <span class="keywordtype">double</span> offset_per_site = std::abs(offset)/(1.*N_sites);</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        <span class="comment">//cout &lt;&lt; &quot;offset_per_site=&quot; &lt;&lt; offset_per_site &lt;&lt; endl;</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>)</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;        {</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            assert(qTot == qVac and <span class="stringliteral">&quot;For adding an offset, the MPO needs to be a singlet.&quot;</span>);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            assert(get_auxdim(0,qVac) == 1 and get_auxdim(N_sites,qVac) == 1 and <span class="stringliteral">&quot;Ill-formed auxiliar basis for open boundary condition&quot;</span>);</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites-1; ++loc)</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;            {</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                increment_auxdim(loc+1, qVac);</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                <span class="keyword">auto</span> it = O[loc].find({qVac,qVac});</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                assert(it != O[loc].end());</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[get_auxdim(loc,qVac)-1][get_auxdim(loc+1,qVac)-1];</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                <a class="code" href="structSiteOperator.html">SiteOperator&lt;Symmetry,Scalar&gt;</a> Id;</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                Id.<a class="code" href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">data</a> = Matrix&lt;Scalar,Dynamic,Dynamic&gt;::Identity(hilbert_dimension[loc],hilbert_dimension[loc]).sparseView();</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                <span class="keywordflow">if</span>(loc == N_sites/2) <span class="comment">// Muss fuer Spektralfunktionen in der Mitte sein, sonst Phasenshift um pi</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                {</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                    <span class="keywordflow">if</span> constexpr(std::is_same&lt;Scalar,complex&lt;double&gt;&gt;::value)</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                    {</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                        Id.<a class="code" href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">data</a> *= exp(1.i*std::arg(offset));</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                    }</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                    {</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                        Id.<a class="code" href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">data</a> *= (offset&lt;0.)? -1.:+1.;</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                    }</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                }</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="preprocessor">                #ifdef OPLABELS</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;                Id.<a class="code" href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">label</a> = <span class="stringliteral">&quot;id&quot;</span>;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                <span class="keyword">auto</span> itQ = existing_ops.find(qVac);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                <span class="keywordflow">if</span>(itQ == existing_ops.end())</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                {</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                    existing_ops.insert({qVac,offset_per_site*Id});</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                {</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                    (itQ-&gt;second) += offset_per_site*Id;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                }</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;            }</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;            <span class="keyword">auto</span> it = O[N_sites-1].find({qVac,qVac});</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;            assert(it != O[N_sites-1].end());</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;            std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[get_auxdim(N_sites-1,qVac)-1][get_auxdim(N_sites,qVac)-1];</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;            <a class="code" href="structSiteOperator.html">SiteOperator&lt;Symmetry,Scalar&gt;</a> Id;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;            Id.<a class="code" href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">data</a> = Matrix&lt;Scalar,Dynamic,Dynamic&gt;::Identity(hilbert_dimension[N_sites-1],hilbert_dimension[N_sites-1]).sparseView();</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;<span class="preprocessor">            #ifdef OPLABELS</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;            Id.<a class="code" href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">label</a> = <span class="stringliteral">&quot;id&quot;</span>;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;            <span class="keyword">auto</span> itQ = existing_ops.find(qVac);</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;            <span class="keywordflow">if</span>(itQ == existing_ops.end())</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;            {</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;                existing_ops.insert({qVac,offset_per_site*Id});</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            }</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;            {</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                (itQ-&gt;second) += offset_per_site*Id;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            }</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            compress(tolerance);</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        }</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>)</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        {</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;            {</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                <span class="keyword">auto</span> it = O[loc].find({qVac,qVac});</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                assert(it != O[loc].end());</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[pos_qVac][pos_qTot];</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                <a class="code" href="structSiteOperator.html">SiteOperator&lt;Symmetry,Scalar&gt;</a> Id;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                Id.<a class="code" href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">data</a> = Matrix&lt;Scalar,Dynamic,Dynamic&gt;::Identity(hilbert_dimension[loc],hilbert_dimension[loc]).sparseView();</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;<span class="preprocessor">                #ifdef OPLABELS</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;                Id.<a class="code" href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">label</a> = <span class="stringliteral">&quot;id&quot;</span>;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                <span class="keyword">auto</span> op_it = existing_ops.find(qVac);</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                <span class="keywordflow">if</span>(op_it == existing_ops.end())</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                {</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                    existing_ops.insert({qVac,offset_per_site*Id});</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                }</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                {</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                    (op_it-&gt;second) = (op_it-&gt;second) + offset_per_site*Id;</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;                }</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;            }</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        }</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    }</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    </div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="keywordflow">if</span> (std::abs(factor-1.) &gt; ::mynumeric_limits&lt;double&gt;::epsilon() or std::abs(offset) &gt; tolerance)</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    {</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;        std::stringstream new_name;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        <span class="keywordflow">if</span>(std::abs(offset) &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        {</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;            new_name &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;        }</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        std::size_t curr_prec = std::cout.precision();</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        <span class="keywordflow">if</span>(std::abs(factor-1.) &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;        {</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;            new_name &lt;&lt; setprecision(3) &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; factor &lt;&lt; <span class="stringliteral">&quot;*&quot;</span> &lt;&lt; label &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; setprecision(curr_prec);</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;        }</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <span class="keywordflow">if</span>(std::abs(offset) &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        {</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;            new_name &lt;&lt; <span class="stringliteral">&quot; + &quot;</span> &lt;&lt; setprecision(3) &lt;&lt; offset &lt;&lt; setprecision(curr_prec) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        }</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;        </div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <span class="keywordflow">if</span>(new_name.str().length() &lt; <a class="code" href="MpoTerms_8h.html#a5b138ca20fd685462fbb27038ee41fd2">MAX_SUMPROD_STRINGLENGTH</a>)</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        {</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;            set_name(new_name.str());</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        }</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;        {</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;            set_name(label+<span class="stringliteral">&quot;+[...]&quot;</span>);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        }</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;        calc(calc_to_power);</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    }</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;}</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160; </div>
<div class="line"><a name="l03075"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5def179250b990da0d480300e771571e"> 3075</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keyword">template</span>&lt;<span class="keyword">typename</span> OtherScalar&gt; <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry, OtherScalar&gt;</a> <a class="code" href="classMpoTerms.html#a5def179250b990da0d480300e771571e">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<a class="code" href="classMpoTerms.html#a5def179250b990da0d480300e771571e">cast</a> ()</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;{</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry, OtherScalar&gt;</a> other(N_sites, boundary_condition);</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    other.<a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a>(label);</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    {</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn, rows] : auxdim[loc])</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        {</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut, cols] : auxdim[loc+1])</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;            {</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                <span class="keyword">auto</span> it = O[loc].find({qIn,qOut});</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                assert(it != O[loc].end());</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                {</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                    <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                    {</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                        std::map&lt;qType,OperatorType&gt; &amp;existing_ops = (it-&gt;second)[row][col];</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[q,op] : existing_ops)</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                        {</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                            op.template cast&lt;OtherScalar&gt;();</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                        }</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                    }</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                }</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;            }</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;        }</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    }</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    {</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        <span class="keywordflow">for</span>(std::size_t i=0; i&lt;info[loc].size(); ++i)</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        {</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;            other.<a class="code" href="classMpoTerms.html#adb2a09be541f434ab3cb0f2d64f5efc0">save_label</a>(loc, info[loc][i]);</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        }</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    }</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="keywordflow">return</span> other;</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;}</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160; </div>
<div class="line"><a name="l03112"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a8fb6d1b6202c928edf48a9c507334c68"> 3112</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a8fb6d1b6202c928edf48a9c507334c68">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;<a class="code" href="classMpoTerms.html#a8fb6d1b6202c928edf48a9c507334c68">transform_base</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qShift, <span class="keyword">const</span> <span class="keywordtype">bool</span> PRINT, <span class="keyword">const</span> <span class="keywordtype">int</span> factor, <span class="keyword">const</span> std::size_t power)</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;{</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    std::size_t calc_to_power = (power != 0ul ? power : current_power);</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    <span class="keywordtype">int</span> length = (factor==-1)? <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(qPhys.size()):factor;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    ::transform_base&lt;Symmetry&gt;(qPhys, qShift, PRINT, <span class="keyword">false</span>, length); <span class="comment">// from symmery/functions.h, BACK=false</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    </div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    std::vector&lt;std::map&lt;std::array&lt;qType, 2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; O_new(N_sites);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    std::vector&lt;std::map&lt;qType, std::size_t&gt;&gt; auxdim_new(N_sites+1);</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    </div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <span class="keywordflow">if</span>(qShift != Symmetry::qvacuum())</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    {</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;        std::vector&lt;std::size_t&gt; symmetries_to_transform;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        <span class="keywordflow">for</span>(std::size_t n=0; n&lt;Symmetry::Nq; ++n)</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        {</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;            <span class="keywordflow">if</span>(Symmetry::kind()[n] != <a class="code" href="namespaceSym.html#a359c8465d27b791d515bfbc2554ec963a1e979858f0a754fa28202934a5e6787d">Sym::KIND::S</a> and Symmetry::kind()[n] != <a class="code" href="namespaceSym.html#a359c8465d27b791d515bfbc2554ec963a711a78bef49adbb12d22ff554c97ab79">Sym::KIND::T</a>)</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;            {</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;                symmetries_to_transform.push_back(n);</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;            }</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;        }</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;        </div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        <span class="keywordflow">for</span>(std::size_t n=0; n&lt;symmetries_to_transform.size(); ++n)</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;            qTot[symmetries_to_transform[n]] *= length;</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;            qVac[symmetries_to_transform[n]] *= length;</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;        }</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160; </div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;        {</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qs_key, ops] : O[loc])</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;            {</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160; </div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> qIn = std::get&lt;0&gt;(qs_key);</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> qOut = std::get&lt;1&gt;(qs_key);</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;symmetries_to_transform.size(); ++n)</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                {</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                        qIn[symmetries_to_transform[n]] *= length;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;                        qOut[symmetries_to_transform[n]] *= length;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                }</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_row(ops[0].size(), empty_op_map);</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; ops_new(ops.size(), temp_row);</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;ops.size(); ++row)</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                {</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                    <span class="keywordflow">for</span>(std::size_t col=0; col&lt;ops[row].size(); ++col)</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                    {</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[q,op] : ops[row][col])</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                        {</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;                            <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> q_new = q;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;                            <a class="code" href="structSiteOperator.html">OperatorType</a> op_new = op;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;                            <span class="keywordflow">for</span>(std::size_t n=0; n&lt;symmetries_to_transform.size(); ++n)</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                            {</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;                                q_new[symmetries_to_transform[n]] *= length;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                                op_new.<a class="code" href="structSiteOperator.html#a8e83604df485e170d2c7a01d7fc3229f">Q</a>[symmetries_to_transform[n]] *= length ;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;                            }</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;                            ops_new[row][col].insert({q_new,op_new});</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                        }</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                    }</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;                }</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;                O_new[loc].insert({{qIn,qOut},ops_new});</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;            }</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;        }</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;                </div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites+1; ++loc)</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;        {</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[q_key, deg] : auxdim[loc])</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;            {</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> q = q_key;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;symmetries_to_transform.size(); ++n)</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;                {</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;                    q[symmetries_to_transform[n]] *= length;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;                }</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;                auxdim_new[loc].insert({q,deg});</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;            }</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        }</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        </div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        O = O_new;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        auxdim = auxdim_new;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;        got_update();</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        calc(calc_to_power);</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    }</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;}</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160; </div>
<div class="line"><a name="l03195"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a6b5bb8791d64458c41be2650e28a5e3f"> 3195</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::vector&lt;std::vector&lt;TwoSiteData&lt;Symmetry,Scalar&gt;&gt;&gt; <a class="code" href="classMpoTerms.html#a6b5bb8791d64458c41be2650e28a5e3f">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<a class="code" href="classMpoTerms.html#a6b5bb8791d64458c41be2650e28a5e3f">calc_TwoSiteData</a> ()<span class="keyword"> const</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    std::vector&lt;std::vector&lt;TwoSiteData&lt;Symmetry,Scalar&gt;&gt;&gt; tsd(N_sites-1);</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    </div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites-1; ++loc)</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    {</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> loc12; loc12.<a class="code" href="classQbasis.html#a73c16f8f52623975bcf7340ecaa44d9d">pullData</a>(qPhys[loc]);</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> loc34; loc34.<a class="code" href="classQbasis.html#a73c16f8f52623975bcf7340ecaa44d9d">pullData</a>(qPhys[loc+1]);</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;        <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> tensor_basis = loc12.<a class="code" href="classQbasis.html#a641b3c1198713e784d80894d7d988bb9">combine</a>(loc34);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        </div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        <span class="comment">// auto tensor_basis = Symmetry::tensorProd(qPhys[loc], qPhys[loc+1]);</span></div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        <span class="keywordflow">for</span>(std::size_t n_lefttop=0; n_lefttop&lt;qPhys[loc].size(); ++n_lefttop)</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        {</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;            <span class="keywordflow">for</span>(std::size_t n_leftbottom=0; n_leftbottom&lt;qPhys[loc].size(); ++n_leftbottom)</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;            {</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                <span class="keywordflow">for</span>(std::size_t t_left=0; t_left&lt;qOp[loc].size(); ++t_left)</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                {</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                    <span class="keywordflow">if</span>(std::array&lt;qType,3&gt; qCheck = {qPhys[loc][n_leftbottom], qOp[loc][t_left], qPhys[loc][n_lefttop]}; !Symmetry::validate(qCheck))</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;                    {</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                    }</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;                    <span class="keywordflow">for</span>(std::size_t n_righttop=0; n_righttop&lt;qPhys[loc+1].size(); ++n_righttop)</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;                        {</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;                        <span class="keywordflow">for</span>(std::size_t n_rightbottom=0; n_rightbottom&lt;qPhys[loc+1].size(); ++n_rightbottom)</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                        {</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                            <span class="keywordflow">for</span>(std::size_t t_right=0; t_right&lt;qOp[loc+1].size(); ++t_right)</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                            {</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                                <span class="keywordflow">if</span>(std::array&lt;qType,3&gt; qCheck = {qPhys[loc+1][n_rightbottom], qOp[loc+1][t_right], qPhys[loc+1][n_righttop]}; !Symmetry::validate(qCheck))</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                                {</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;                                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;                                }</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160; </div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                                <span class="keyword">auto</span> qOp_merges = Symmetry::reduceSilent(qOp[loc][t_left], qOp[loc+1][t_right]);</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;                                </div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;qOp_merge : qOp_merges)</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                                {</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                                    <span class="keywordflow">if</span>(!qAux[loc+1].find(qOp_merge))</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;                                    {</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                                    }</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;                                    </div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;                                    <span class="keyword">auto</span> qPhys_tops = Symmetry::reduceSilent(qPhys[loc][n_lefttop], qPhys[loc+1][n_righttop]);</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;                                    <span class="keyword">auto</span> qPhys_bottoms = Symmetry::reduceSilent(qPhys[loc][n_leftbottom], qPhys[loc+1][n_rightbottom]);</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;                                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;qPhys_top : qPhys_tops)</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                                    {</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                                        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;qPhys_bottom : qPhys_bottoms)</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;                                        {</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                                            <span class="comment">// auto qTensor_top = make_tuple(qPhys[loc][n_lefttop], n_lefttop, qPhys[loc+1][n_righttop], n_righttop, qPhys_top);</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                                            <span class="comment">// std::size_t n_top = distance(tensor_basis.begin(), find(tensor_basis.begin(), tensor_basis.end(), qTensor_top));</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                                            <span class="comment">// std::size_t n_top = tensor_basis.outer_num(qPhys_top) + tensor_basis.leftAmount(qPhys_top,{qPhys[loc][n_lefttop],qPhys[loc+1][n_righttop]}) +</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                                            <span class="comment">//  loc12.inner_num(n_lefttop) + loc34.inner_num(n_righttop)*loc12.inner_dim(qPhys[loc][n_lefttop]);</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                                            <span class="keywordtype">size_t</span> n_top = tensor_basis.<a class="code" href="classQbasis.html#afd17e65eb19e217c14ec7adff1ea3405">outer_num</a>(qPhys_top) + tensor_basis.<a class="code" href="classQbasis.html#a6facb7c84d9574dded4d3fcb0cd11eba">leftOffset</a>(qPhys_top,{qPhys[loc][n_lefttop],qPhys[loc+1][n_righttop]},</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;                                                                                                                       {loc12.<a class="code" href="classQbasis.html#a5b08b155c5907090ed8174785a650c6e">inner_num</a>(n_lefttop),loc34.<a class="code" href="classQbasis.html#a5b08b155c5907090ed8174785a650c6e">inner_num</a>(n_righttop)});</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;                                            <span class="comment">// auto qTensor_bottom = make_tuple(qPhys[loc][n_leftbottom], n_leftbottom, qPhys[loc+1][n_rightbottom], n_rightbottom, qPhys_bottom);</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;                                            <span class="comment">// std::size_t n_bottom = distance(tensor_basis.begin(), find(tensor_basis.begin(), tensor_basis.end(), qTensor_bottom));</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;                                            <span class="comment">// std::size_t n_bottom = tensor_basis.outer_num(qPhys_bottom) + tensor_basis.leftAmount(qPhys_bottom,{qPhys[loc][n_leftbottom],qPhys[loc+1][n_rightbottom]}) +</span></div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;                                            <span class="comment">//  loc12.inner_num(n_leftbottom) + loc34.inner_num(n_rightbottom)*loc12.inner_dim(qPhys[loc][n_leftbottom]);</span></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;                                            <span class="keywordtype">size_t</span> n_bottom = tensor_basis.<a class="code" href="classQbasis.html#afd17e65eb19e217c14ec7adff1ea3405">outer_num</a>(qPhys_bottom) + tensor_basis.<a class="code" href="classQbasis.html#a6facb7c84d9574dded4d3fcb0cd11eba">leftOffset</a>(qPhys_bottom,{qPhys[loc][n_leftbottom],qPhys[loc+1][n_rightbottom]},</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;                                                                                                                             {loc12.<a class="code" href="classQbasis.html#a5b08b155c5907090ed8174785a650c6e">inner_num</a>(n_leftbottom),loc34.<a class="code" href="classQbasis.html#a5b08b155c5907090ed8174785a650c6e">inner_num</a>(n_rightbottom)});</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;                                            Scalar factor_cgc = 1.;</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;                                            <span class="keywordflow">if</span>(Symmetry::NON_ABELIAN)</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                                            {</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                                                factor_cgc = Symmetry::coeff_tensorProd(qPhys[loc][n_leftbottom], qPhys[loc+1][n_rightbottom], qPhys_bottom, qOp[loc][t_left], qOp[loc+1][t_right], qOp_merge, qPhys[loc][n_lefttop], qPhys[loc+1][n_righttop], qPhys_top);</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                                            }</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                                            <span class="keywordflow">if</span>(std::abs(factor_cgc) &lt; mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;                                            {</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                                            }</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                                            <a class="code" href="structTwoSiteData.html">TwoSiteData&lt;Symmetry,Scalar&gt;</a> entry({{n_lefttop,n_leftbottom,n_righttop,n_rightbottom,n_top,n_bottom}}, {{qPhys_top,qPhys_bottom}}, {{t_left,t_right}}, qOp_merge, factor_cgc);</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                                            tsd[loc].push_back(entry);</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                                        }</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;                                    }</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                                }</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                            }</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                        }</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                    }</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;                }</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;            }</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        }</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    }</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <span class="keywordflow">return</span> tsd;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;}</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160; </div>
<div class="line"><a name="l03279"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a2fdc3c86a0ca19b84275cb722c25b7d5"> 3279</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a2fdc3c86a0ca19b84275cb722c25b7d5">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;<a class="code" href="classMpoTerms.html#a2fdc3c86a0ca19b84275cb722c25b7d5">got_update</a> ()</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;{</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    GOT_W = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;    GOT_QOP = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    GOT_QAUX = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;    current_power = 1;</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;}</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160; </div>
<div class="line"><a name="l03288"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a01cd59d39dd7afefbd450c1a34072080"> 3288</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> <a class="code" href="classMpoTerms.html#a01cd59d39dd7afefbd450c1a34072080">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;<a class="code" href="classMpoTerms.html#a01cd59d39dd7afefbd450c1a34072080">prod</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> &amp;top, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> &amp;bottom, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qTot, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance)</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;{</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> Symmetry::qType <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a>;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structSiteOperator.html">SiteOperator&lt;Symmetry, Scalar&gt;</a> <a class="code" href="structSiteOperator.html">OperatorType</a>;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    <span class="keyword">typedef</span> Eigen::SparseMatrix&lt;Scalar,Eigen::ColMajor,EIGEN_DEFAULT_SPARSE_INDEX_TYPE&gt; <a class="code" href="classMpoTerms.html#ab7be76c72cfd76e91404ffd0b0563a76">MatrixType</a>;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    <a class="code" href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a> VERB = std::max(top.<a class="code" href="classMpoTerms.html#a528fcd33e93b7ed7e6042ed9f93bd52d">get_verbosity</a>(), bottom.<a class="code" href="classMpoTerms.html#a528fcd33e93b7ed7e6042ed9f93bd52d">get_verbosity</a>());</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160; </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    <span class="keywordflow">if</span>(VERB &gt; DMRG::VERBOSITY::OPTION::ON_EXIT)</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    {</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;MPO multiplication of &quot;</span> &lt;&lt; top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>() &lt;&lt; <span class="stringliteral">&quot;*&quot;</span> &lt;&lt; bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>() &lt;&lt; <span class="stringliteral">&quot; to quantum number {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qTot) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    }</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    assert(bottom.<a class="code" href="classMpoTerms.html#aa68f98dab48c889cdb823956f77b6805">is_finalized</a>() and top.<a class="code" href="classMpoTerms.html#aa68f98dab48c889cdb823956f77b6805">is_finalized</a>() and <span class="stringliteral">&quot;Error: Multiplying non-finalized MPOs&quot;</span>);</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    assert(bottom.<a class="code" href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">size</a>() == top.<a class="code" href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">size</a>() and <span class="stringliteral">&quot;Error: Multiplying two MPOs of different size&quot;</span>);</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    assert(bottom.<a class="code" href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">get_boundary_condition</a>() == top.<a class="code" href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">get_boundary_condition</a>() and <span class="stringliteral">&quot;Error: Multiplying two MPOs with different boundary conditions&quot;</span>);</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> boundary_condition = bottom.<a class="code" href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">get_boundary_condition</a>();</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    </div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    std::vector&lt;qType&gt; qTots = Symmetry::reduceSilent(bottom.<a class="code" href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">get_qTot</a>(), top.<a class="code" href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">get_qTot</a>());</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    <span class="keyword">auto</span> it = std::find(qTots.begin(), qTots.end(), qTot);</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    <span class="keywordflow">if</span> (it==qTots.end())</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    {</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;qTot=&quot;</span> &lt;&lt; qTot &lt;&lt; endl;</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; qTotVal:qTots)</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        {</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;val=&quot;</span> &lt;&lt; qTotVal &lt;&lt; endl;</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        }</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        assert(it != qTots.end() and <span class="stringliteral">&quot;Cannot multiply these two operators to an operator with target quantum number&quot;</span>);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    }</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    </div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    std::vector&lt;std::map&lt;std::array&lt;qType, 2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; O_bottom, O_top, O;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; qAux_bottom, qAux_top, qAux;</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    std::vector&lt;std::vector&lt;qType&gt;&gt; qPhys, qPhys_check;</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    std::vector&lt;std::vector&lt;qType&gt;&gt; qOp_bottom, qOp_top;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    </div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    qPhys = bottom.<a class="code" href="classMpoTerms.html#ab2cbbcb24ec78394626aeb1a5e38e466">get_qPhys</a>();</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    qPhys_check = top.<a class="code" href="classMpoTerms.html#ab2cbbcb24ec78394626aeb1a5e38e466">get_qPhys</a>();</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    </div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    O_bottom = bottom.<a class="code" href="classMpoTerms.html#a1ed760f886a0cfe1399b7cda6a0f6507">get_O</a>();</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    O_top = top.<a class="code" href="classMpoTerms.html#a1ed760f886a0cfe1399b7cda6a0f6507">get_O</a>();</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    qAux_bottom = bottom.<a class="code" href="classMpoTerms.html#af9467e059bedd0b94cf403dc7aaf9ee2">get_qAux</a>();</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    qAux_top = top.<a class="code" href="classMpoTerms.html#af9467e059bedd0b94cf403dc7aaf9ee2">get_qAux</a>();</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    </div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    qOp_bottom = bottom.<a class="code" href="classMpoTerms.html#a205386f3179d65eb729b47d18a2d3e1a">get_qOp</a>();</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    qOp_top = top.<a class="code" href="classMpoTerms.html#a205386f3179d65eb729b47d18a2d3e1a">get_qOp</a>();</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;    </div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    std::size_t N_sites = bottom.<a class="code" href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">size</a>();</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    O.resize(N_sites);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    qAux.resize(N_sites+1);</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160; </div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;    std::size_t pos_qTot_out = 0;</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    <span class="keywordflow">if</span>(qTot == Symmetry::qvacuum())</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    {</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;        pos_qTot_out = 1;</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    }</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;    </div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    std::vector&lt;std::size_t&gt; row_qVac(N_sites);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    std::vector&lt;std::size_t&gt; col_qVac(N_sites);</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    std::vector&lt;std::size_t&gt; row_qTot(N_sites);</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    std::vector&lt;std::size_t&gt; col_qTot(N_sites);</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160; </div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    </div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    qAux[0] = qAux_bottom[0].combine(qAux_top[0]);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;    </div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    </div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    {</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        std::size_t hilbert_dimension = qPhys[loc].size();</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        </div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        assert(hilbert_dimension != 0 and <span class="stringliteral">&quot;Not all Hilbert space dimensions have been set!&quot;</span>);</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        assert(hilbert_dimension == qPhys_check[loc].size() and <span class="stringliteral">&quot;Local Hilbert space dimensions do not match!&quot;</span>);</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        </div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;        qAux[loc+1] = qAux_bottom[loc+1].combine(qAux_top[loc+1]);</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;entry_left : qAux[loc])</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;entry_right : qAux[loc+1])</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;            {</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;                std::size_t rows = std::get&lt;2&gt;(entry_left).size();</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;                std::size_t cols = std::get&lt;2&gt;(entry_right).size();</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> Qin = std::get&lt;0&gt;(entry_left);</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> Qout = std::get&lt;0&gt;(entry_right);</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_row(cols, empty_op_map);</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp(rows, temp_row);</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                O[loc].insert({{Qin,Qout},temp});</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;            }</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;        }</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;        {</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Lattice site &quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        }</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;        std::vector&lt;qType&gt; Qins = qAux[loc].qs();</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Qin : Qins)</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;        {</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;            std::size_t total_rows = qAux[loc].inner_dim(Qin);</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;            <span class="keyword">auto</span> qins = Sym::split&lt;Symmetry&gt;(Qin,qAux_top[loc].qs(), qAux_bottom[loc].qs());</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qin_top, qin_bottom] : qins)</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;            {</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                std::size_t rows_bottom = qAux_bottom[loc].inner_dim(qin_bottom);</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                std::size_t rows_top = qAux_top[loc].inner_dim(qin_top);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                {</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\tQin = {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Qin) &lt;&lt; <span class="stringliteral">&quot;} can be reached by {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qin_bottom) &lt;&lt; <span class="stringliteral">&quot;} + {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qin_top) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                }</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                std::vector&lt;qType&gt; Qouts = qAux[loc+1].qs();</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Qout : Qouts)</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                {</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a> and (loc+1 == N_sites) and (Qout != qTot))</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                    {</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                    }</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                    std::size_t total_cols = qAux[loc+1].inner_dim(Qout);</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                    <span class="keyword">auto</span> qouts = Sym::split&lt;Symmetry&gt;(Qout,qAux_top[loc+1].qs(), qAux_bottom[loc+1].qs());</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qout_top, qout_bottom] : qouts)</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                    {</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                        std::size_t cols_bottom = qAux_bottom[loc+1].inner_dim(qout_bottom);</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                        std::size_t cols_top = qAux_top[loc+1].inner_dim(qout_top);</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;<span class="preprocessor">                        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                        {</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                            lout &lt;&lt; <span class="stringliteral">&quot;\t\tQout = {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Qout) &lt;&lt; <span class="stringliteral">&quot;} can be reached by {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qout_bottom) &lt;&lt; <span class="stringliteral">&quot;} + {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qout_top) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                        }</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="preprocessor">                        #endif</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                        <span class="keyword">auto</span> it = O[loc].find({Qin, Qout});</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                        <span class="keyword">auto</span> it_bottom = O_bottom[loc].find({qin_bottom, qout_bottom});</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                        <span class="keyword">auto</span> it_top = O_top[loc].find({qin_top, qout_top});</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;                        std::size_t in_pos = qAux[loc].leftAmount(Qin, {qin_bottom, qin_top});</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                        std::size_t out_pos = qAux[loc+1].leftAmount(Qout, {qout_bottom, qout_top});</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                        <span class="keywordflow">for</span>(std::size_t row_bottom=0; row_bottom&lt;rows_bottom; ++row_bottom)</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;                        {</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;                            <span class="keywordflow">for</span>(std::size_t row_top=0; row_top&lt;rows_top; ++row_top)</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;                            {</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;                                std::size_t total_row = in_pos + row_bottom*rows_top + row_top;</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;                                <span class="keywordflow">if</span>((qin_bottom == bottom.<a class="code" href="classMpoTerms.html#a48be912d55d82e2e076d0dfacce41e8a">qVac</a> and row_bottom == bottom.<a class="code" href="classMpoTerms.html#a49308f057c4dc419d4c0301be82e5e70">pos_qVac</a>) and (qin_top == top.<a class="code" href="classMpoTerms.html#a48be912d55d82e2e076d0dfacce41e8a">qVac</a> and row_top == top.<a class="code" href="classMpoTerms.html#a49308f057c4dc419d4c0301be82e5e70">pos_qVac</a>) and total_row != row_qVac[loc])</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;                                {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;                                    row_qVac[loc] = total_row;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                                }</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                                <span class="keywordflow">if</span>((qin_bottom == bottom.<a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a> and row_bottom == bottom.<a class="code" href="classMpoTerms.html#a666f0aa6a2f44a1343f3ab2311f752e0">pos_qTot</a>) and (qin_top == top.<a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a> and row_top == top.<a class="code" href="classMpoTerms.html#a666f0aa6a2f44a1343f3ab2311f752e0">pos_qTot</a>) and total_row != row_qTot[loc])</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;                                {</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;                                    row_qTot[loc] = total_row;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;                                }</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;                                <span class="keywordflow">for</span>(std::size_t col_bottom=0; col_bottom&lt;cols_bottom; ++col_bottom)</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                                {</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                                    <span class="keywordflow">for</span>(std::size_t col_top=0; col_top&lt;cols_top; ++col_top)</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;                                    {</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                                        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOp_bottom,op_bottom] : (it_bottom-&gt;second)[row_bottom][col_bottom])</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;                                        {</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                                            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOp_top,op_top] : (it_top-&gt;second)[row_top][col_top])</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                                            {</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                                                std::size_t total_col = out_pos + col_bottom*cols_top + col_top;</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                                                <span class="keywordflow">if</span>((qout_bottom == bottom.<a class="code" href="classMpoTerms.html#a48be912d55d82e2e076d0dfacce41e8a">qVac</a> and col_bottom == bottom.<a class="code" href="classMpoTerms.html#a49308f057c4dc419d4c0301be82e5e70">pos_qVac</a>) and (qout_top == top.<a class="code" href="classMpoTerms.html#a48be912d55d82e2e076d0dfacce41e8a">qVac</a> and col_top == top.<a class="code" href="classMpoTerms.html#a49308f057c4dc419d4c0301be82e5e70">pos_qVac</a>) and total_col != col_qVac[loc])</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                                                {</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                                                    col_qVac[loc] = total_col;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                                                }</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                                                <span class="keywordflow">if</span>((qout_bottom == bottom.<a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a> and col_bottom == bottom.<a class="code" href="classMpoTerms.html#a666f0aa6a2f44a1343f3ab2311f752e0">pos_qTot</a>) and (qout_top == top.<a class="code" href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">qTot</a> and col_top == top.<a class="code" href="classMpoTerms.html#a666f0aa6a2f44a1343f3ab2311f752e0">pos_qTot</a>) and total_col != col_qTot[loc])</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                                                {</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                                                    col_qTot[loc] = total_col;</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;                                                }</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;                                                std::map&lt;qType,OperatorType&gt; &amp;ops = (it-&gt;second)[total_row][total_col];</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;                                                std::vector&lt;qType&gt; Qops = Symmetry::reduceSilent(qOp_bottom, qOp_top);</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                                                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Qop : Qops)</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                                                {</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                                                    <span class="keywordflow">if</span>(std::array&lt;qType,3&gt; qCheck = {Qin,Qop,Qout}; !Symmetry::validate(qCheck))</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                                                    {</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                                                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;                                                    }</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;<span class="preprocessor">                                                    #ifdef OPLABELS</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                                                    <a class="code" href="structSiteOperator.html">OperatorType</a> op(Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;::Zero(hilbert_dimension, hilbert_dimension).sparseView(), Qop, op_top.label+<span class="stringliteral">&quot;*&quot;</span>+op_bottom.label);</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;<span class="preprocessor">                                                    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;                                                    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                                                    {</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;                                                        lout &lt;&lt; <span class="stringliteral">&quot;\t\t\tBlock {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Qin) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Qout) &lt;&lt; <span class="stringliteral">&quot;},\tPosition [&quot;</span> &lt;&lt; total_row &lt;&lt; <span class="stringliteral">&quot;|&quot;</span> &lt;&lt; total_col &lt;&lt; <span class="stringliteral">&quot;], &quot;</span> &lt;&lt; op.<a class="code" href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">label</a> &lt;&lt; <span class="stringliteral">&quot; {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Qop) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                                                    }</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;<span class="preprocessor">                                                    #endif</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="preprocessor">                                                    #else</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;                                                    <a class="code" href="structSiteOperator.html">OperatorType</a> op(Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;::Zero(hilbert_dimension,hilbert_dimension).sparseView(), Qop);</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="preprocessor">                                                    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                                                    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;                                                    {</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;                                                        lout &lt;&lt; <span class="stringliteral">&quot;\t\t\tBlock {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Qin) &lt;&lt; <span class="stringliteral">&quot;}-&gt;{&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Qout) &lt;&lt; <span class="stringliteral">&quot;},\tPosition [&quot;</span> &lt;&lt; total_row &lt;&lt; <span class="stringliteral">&quot;|&quot;</span> &lt;&lt; total_col &lt;&lt; <span class="stringliteral">&quot;], Operator {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(Qop) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                                                    }</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;<span class="preprocessor">                                                    #endif</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;<span class="preprocessor">                                                    #endif</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                                                    Scalar factor_9j = Symmetry::coeff_tensorProd(qin_bottom, qin_top, Qin, qOp_bottom, qOp_top, Qop, qout_bottom, qout_top, Qout);</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;                                                    <span class="keywordflow">if</span>(std::abs(factor_9j) &lt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;                                                    {</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;                                                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;                                                    }</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;                                                    <span class="keywordflow">for</span>(std::size_t n_bottom=0; n_bottom&lt;hilbert_dimension; ++n_bottom)</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;                                                    {</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;                                                        <span class="keywordflow">for</span>(std::size_t n_top=0; n_top&lt;hilbert_dimension; ++n_top)</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;                                                        {</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;                                                            <span class="keywordflow">if</span>(std::array&lt;qType,3&gt; qCheck = {qPhys[loc][n_bottom], Qop, qPhys[loc][n_top]}; !Symmetry::validate(qCheck))</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;                                                            {</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;                                                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;                                                            }</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;<span class="preprocessor">                                                            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                                                            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;                                                            {</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;                                                                lout &lt;&lt; <span class="stringliteral">&quot;\t\t\t\tmat(&quot;</span> &lt;&lt; n_top &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; n_bottom &lt;&lt; <span class="stringliteral">&quot;) = 0&quot;</span>;</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;                                                            }</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="preprocessor">                                                            #endif</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;                                                            </div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;                                                            Scalar val = 0;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;                                                            <span class="keywordflow">for</span>(std::size_t n_middle=0; n_middle&lt;hilbert_dimension; ++n_middle)</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;                                                            {</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;                                                                <span class="keywordflow">if</span>(std::array&lt;qType,3&gt; qCheck = {qPhys[loc][n_bottom], qOp_bottom, qPhys[loc][n_middle]}; !Symmetry::validate(qCheck))</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;                                                                {</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;                                                                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;                                                                }</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;                                                                <span class="keywordflow">if</span>(std::array&lt;qType,3&gt; qCheck = {qPhys[loc][n_middle], qOp_top, qPhys[loc][n_top]}; !Symmetry::validate(qCheck))</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;                                                                {</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;                                                                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;                                                                }</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;                                                                <span class="keywordflow">if</span>(std::abs(op_top.data.coeff(n_top, n_middle)) &lt; ::mynumeric_limits&lt;double&gt;::epsilon() or std::abs(op_bottom.data.coeff(n_middle, n_bottom)) &lt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;                                                                {</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;                                                                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;                                                                }</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;                                                                Scalar factor_6j = Symmetry::coeff_Apair(qPhys[loc][n_top], qOp_top, qPhys[loc][n_middle], qOp_bottom, qPhys[loc][n_bottom], Qop);</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;                                                                <span class="keywordflow">if</span>(std::abs(factor_6j) &lt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;                                                                {</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;                                                                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;                                                                }</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;                                                                val += op_top.data.coeff(n_top, n_middle) * op_bottom.data.coeff(n_middle, n_bottom) * factor_9j * factor_6j;</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;<span class="preprocessor">                                                                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                                                                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;                                                                {</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                                                                    lout &lt;&lt; <span class="stringliteral">&quot; + &quot;</span> &lt;&lt; op_top.data.coeff(n_top, n_middle) &lt;&lt; <span class="stringliteral">&quot;*&quot;</span> &lt;&lt; op_bottom.data.coeff(n_middle, n_bottom) &lt;&lt; <span class="stringliteral">&quot;*&quot;</span> &lt;&lt; factor_9j*factor_6j;</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;                                                                }</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="preprocessor">                                                                #endif</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;                                                            }</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;                                                            <span class="keywordflow">if</span>(std::abs(val) &lt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;                                                            {</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="preprocessor">                                                                #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;                                                                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;                                                                {</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;                                                                    lout &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                                                                }</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="preprocessor">                                                                #endif</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                                                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;                                                            }</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                                                            op.<a class="code" href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">data</a>.coeffRef(n_top, n_bottom) = val;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;<span class="preprocessor">                                                            #if DEBUG_VERBOSITY &gt; 2</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                                                            <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;                                                            {</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                                                                lout &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; val &lt;&lt; std::endl;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                                                            }</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="preprocessor">                                                            #endif</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;                                                        }</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;                                                    }</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;                                                    <span class="keywordflow">if</span>(op.<a class="code" href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">data</a>.norm() &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;                                                    {</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;                                                        <span class="keyword">auto</span> it_op = ops.find(Qop);</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;                                                        <span class="keywordflow">if</span>(it_op != ops.end())</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;                                                        {</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;                                                            (it_op-&gt;second) = (it_op-&gt;second) + op;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;                                                        }</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;                                                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;                                                        {</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;                                                            ops.insert({Qop,op});</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;                                                        }</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                                                    }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;                                                }</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;                                            }</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                                        }</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;                                    }</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;                                }</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                            }</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                        }</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                    }</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;                }</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;            }</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;        }</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    }</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>)</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    {</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;        {</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Infinite system: Swap rows and columns to ensure identity operators to be at [0|0] and [1|1]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        }</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;        prod_swap_IBC(O, row_qVac, col_qVac, row_qTot, col_qTot);</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    }</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    <span class="keywordflow">if</span>(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>)</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    {</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;        {</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Open system: Delete columns at last lattice site which do not match target quantum number&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;        }</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;        prod_delZeroCols_OBC(O[N_sites-1], qAux[N_sites], qAux[N_sites-1], qTot, col_qTot[N_sites-1]);</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    }</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> out(N_sites, boundary_condition, qTot, VERB);</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    out.<a class="code" href="classMpoTerms.html#ada165954c8f586180a7e259d9cf535b3">reconstruct</a>(O, qAux, qPhys, <span class="keyword">true</span>, boundary_condition, qTot);</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <span class="keyword">auto</span> [name_top, power_top] = detect_and_remove_power(top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>());</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="keyword">auto</span> [name_bot, power_bot] = detect_and_remove_power(bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>());</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    </div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    <span class="keywordflow">if</span> ((top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;\n+&quot;</span>+bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()).length() &lt; <a class="code" href="MpoTerms_8h.html#a5b138ca20fd685462fbb27038ee41fd2">MAX_SUMPROD_STRINGLENGTH</a>)</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    {</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;        <span class="keywordflow">if</span>(name_top == name_bot)</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;        {</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;            out.<a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a>(name_top + power_to_string(power_top+power_bot));</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;        }</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;        {</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            out.<a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a>(<span class="stringliteral">&quot;⦅&quot;</span>+top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;⦆*⦅&quot;</span>+bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;⦆&quot;</span>);</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;        }</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    }</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;\n+&quot;</span>+bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()).length() &gt;= <a class="code" href="MpoTerms_8h.html#a5b138ca20fd685462fbb27038ee41fd2">MAX_SUMPROD_STRINGLENGTH</a> and top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>().substr(top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>().length()-5) != <span class="stringliteral">&quot;[...]&quot;</span>)</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    {</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;        out.<a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a>(top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;\n*[...]&quot;</span>);</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    }</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    {</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;        out.<a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a>(top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>());</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;    }</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    out.<a class="code" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">compress</a>(tolerance);</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    out.<a class="code" href="classMpoTerms.html#a7732332da5839d9c1aa15d02f436c1d8">calc</a>(1);</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;}</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160; </div>
<div class="line"><a name="l03616"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a833ba2c8a6a46bb177a72a2a9e828efc"> 3616</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::pair&lt;std::string, std::size_t&gt; <a class="code" href="classMpoTerms.html#a833ba2c8a6a46bb177a72a2a9e828efc">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;<a class="code" href="classMpoTerms.html#a833ba2c8a6a46bb177a72a2a9e828efc">detect_and_remove_power</a> (<span class="keyword">const</span> std::string &amp;name_w_power)</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;{</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;    std::vector&lt;std::string&gt; str_powers(10);</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;    str_powers[0] = <span class="stringliteral">&quot;⁰&quot;</span>;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;    str_powers[1] = <span class="stringliteral">&quot;¹&quot;</span>;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;    str_powers[2] = <span class="stringliteral">&quot;²&quot;</span>;</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;    str_powers[3] = <span class="stringliteral">&quot;³&quot;</span>;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    str_powers[4] = <span class="stringliteral">&quot;⁴&quot;</span>;</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    str_powers[5] = <span class="stringliteral">&quot;⁵&quot;</span>;</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;    str_powers[6] = <span class="stringliteral">&quot;⁶&quot;</span>;</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    str_powers[7] = <span class="stringliteral">&quot;⁷&quot;</span>;</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;    str_powers[8] = <span class="stringliteral">&quot;⁸&quot;</span>;</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    str_powers[9] = <span class="stringliteral">&quot;⁹&quot;</span>;</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;    </div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;    std::string name_wo_power = name_w_power;</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    std::size_t power = 1ul;</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    <span class="keywordflow">for</span>(std::size_t ip=0; ip&lt;str_powers.size(); ip++)</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;    {</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;        <span class="keyword">auto</span> pos = name_wo_power.find(str_powers[ip]);</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        <span class="keywordflow">if</span>(pos == std::string::npos)</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        {</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;        }</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;        name_wo_power.erase(pos,pos+str_powers[ip].size());</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;        power = ip;</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;        <span class="keywordflow">break</span>;      </div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    }</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;    <span class="keywordflow">return</span> std::make_pair(name_wo_power,power);</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;}</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160; </div>
<div class="line"><a name="l03647"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a86c195dde004a0acd459408dbac1d64f"> 3647</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::string <a class="code" href="classMpoTerms.html#a86c195dde004a0acd459408dbac1d64f">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;<a class="code" href="classMpoTerms.html#a86c195dde004a0acd459408dbac1d64f">power_to_string</a> (std::size_t power)</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;{</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    assert(power&lt;10 and <span class="stringliteral">&quot;power_to_string has only strings for power &lt; 10.&quot;</span>);</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    std::vector&lt;std::string&gt; str_powers(10);</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    str_powers[0] = <span class="stringliteral">&quot;⁰&quot;</span>;</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    str_powers[1] = <span class="stringliteral">&quot;¹&quot;</span>;</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    str_powers[2] = <span class="stringliteral">&quot;²&quot;</span>;</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;    str_powers[3] = <span class="stringliteral">&quot;³&quot;</span>;</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;    str_powers[4] = <span class="stringliteral">&quot;⁴&quot;</span>;</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    str_powers[5] = <span class="stringliteral">&quot;⁵&quot;</span>;</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    str_powers[6] = <span class="stringliteral">&quot;⁶&quot;</span>;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    str_powers[7] = <span class="stringliteral">&quot;⁷&quot;</span>;</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;    str_powers[8] = <span class="stringliteral">&quot;⁸&quot;</span>;</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    str_powers[9] = <span class="stringliteral">&quot;⁹&quot;</span>;</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    <span class="keywordflow">return</span> str_powers[power];</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;}</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160; </div>
<div class="line"><a name="l03665"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a3daa5410ec1ecda6e1acaecc8042bac7"> 3665</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> <a class="code" href="classMpoTerms.html#a3daa5410ec1ecda6e1acaecc8042bac7">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;<a class="code" href="classMpoTerms.html#a3daa5410ec1ecda6e1acaecc8042bac7">sum</a> (<span class="keyword">const</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> &amp;top, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> &amp;bottom, <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance)</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;{</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> Symmetry::qType <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a>;</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structSiteOperator.html">SiteOperator&lt;Symmetry, Scalar&gt;</a> <a class="code" href="structSiteOperator.html">OperatorType</a>;</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    </div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;    <a class="code" href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a> VERB = std::max(top.<a class="code" href="classMpoTerms.html#a528fcd33e93b7ed7e6042ed9f93bd52d">get_verbosity</a>(), bottom.<a class="code" href="classMpoTerms.html#a528fcd33e93b7ed7e6042ed9f93bd52d">get_verbosity</a>());</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160; </div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;    {</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;MPO addition of &quot;</span> &lt;&lt; bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>() &lt;&lt; <span class="stringliteral">&quot;+&quot;</span> &lt;&lt; top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;    }</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    </div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    assert(bottom.<a class="code" href="classMpoTerms.html#aa68f98dab48c889cdb823956f77b6805">is_finalized</a>() and top.<a class="code" href="classMpoTerms.html#aa68f98dab48c889cdb823956f77b6805">is_finalized</a>() and <span class="stringliteral">&quot;Error: Adding non-finalized MPOs&quot;</span>);</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    assert(bottom.<a class="code" href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">size</a>() == top.<a class="code" href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">size</a>() and <span class="stringliteral">&quot;Error: Adding two MPOs of different size&quot;</span>);</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160; </div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    assert(bottom.<a class="code" href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">get_boundary_condition</a>() == top.<a class="code" href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">get_boundary_condition</a>() and <span class="stringliteral">&quot;Error: Adding two MPOs with different boundary conditions&quot;</span>);</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;    <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a> boundary_condition_out = bottom.<a class="code" href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">get_boundary_condition</a>();</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    </div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;    std::vector&lt;std::map&lt;std::array&lt;qType, 2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; O_bottom, O_top, O_out;</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; qAux_bottom, qAux_top, qAux_out;</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    std::vector&lt;std::vector&lt;qType&gt;&gt; qPhys, qPhys_check;</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    std::vector&lt;std::vector&lt;qType&gt;&gt; qOp_bottom, qOp_top;</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    </div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    assert(bottom.<a class="code" href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">get_qTot</a>() == top.<a class="code" href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">get_qTot</a>() and <span class="stringliteral">&quot;Addition only possible for MPOs with the same total quantum number.&quot;</span>);</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> qTot = bottom.<a class="code" href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">get_qTot</a>();</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    </div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    qPhys = bottom.<a class="code" href="classMpoTerms.html#ab2cbbcb24ec78394626aeb1a5e38e466">get_qPhys</a>();</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    qPhys_check = top.<a class="code" href="classMpoTerms.html#ab2cbbcb24ec78394626aeb1a5e38e466">get_qPhys</a>();</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    </div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    O_bottom = bottom.<a class="code" href="classMpoTerms.html#a1ed760f886a0cfe1399b7cda6a0f6507">get_O</a>();</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    O_top = top.<a class="code" href="classMpoTerms.html#a1ed760f886a0cfe1399b7cda6a0f6507">get_O</a>();</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160; </div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    qAux_bottom = bottom.<a class="code" href="classMpoTerms.html#af9467e059bedd0b94cf403dc7aaf9ee2">get_qAux</a>();</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    qAux_top = top.<a class="code" href="classMpoTerms.html#af9467e059bedd0b94cf403dc7aaf9ee2">get_qAux</a>();</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    </div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    qOp_bottom = bottom.<a class="code" href="classMpoTerms.html#a205386f3179d65eb729b47d18a2d3e1a">get_qOp</a>();</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    qOp_top = top.<a class="code" href="classMpoTerms.html#a205386f3179d65eb729b47d18a2d3e1a">get_qOp</a>();</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    </div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;    std::size_t N_sites = bottom.<a class="code" href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">size</a>();</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    O_out.resize(N_sites);</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    qAux_out.resize(N_sites+1);</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    </div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    std::vector&lt;std::map&lt;qType,std::size_t&gt;&gt; auxdim(N_sites+1);</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    std::vector&lt;std::size_t&gt; auxdim_bottom_starts(N_sites+1);</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    </div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;=N_sites; ++loc)</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    {</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;entry : qAux_top[loc])</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;        {</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;            <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> q = std::get&lt;0&gt;(entry);</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;            std::size_t deg = std::get&lt;2&gt;(entry).size();</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;            auxdim[loc].insert({q,deg});</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;            <span class="keywordflow">if</span>(q == Symmetry::qvacuum())</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;            {</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;                auxdim_bottom_starts[loc] = deg;      </div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;        }</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        }</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;entry : qAux_bottom[loc])</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;        {</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;            <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> q = std::get&lt;0&gt;(entry);</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;            std::size_t deg = std::get&lt;2&gt;(entry).size();</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;            <span class="keyword">auto</span> it = auxdim[loc].find(q);</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            <span class="keywordflow">if</span>(it != auxdim[loc].end())</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;            {</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;                (it-&gt;second) += deg;</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;            }</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;            {</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;                auxdim[loc].insert({q,deg});</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;            }</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;        }</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[q,deg] : auxdim[loc])</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;        {</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;            qAux_out[loc].push_back(q,deg);</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;        }</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    }</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;    </div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;    {</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;        {</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Lattice site &quot;</span> &lt;&lt; loc &lt;&lt; std::endl;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;        }</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;        std::size_t hilbert_dimension = qPhys[loc].size();</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;        assert(hilbert_dimension == qPhys_check[loc].size() and <span class="stringliteral">&quot;Local Hilbert space dimensions do not match!&quot;</span>);</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160; </div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn,rows] : auxdim[loc])</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;        {</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;            std::size_t row_start = 0;</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;            <span class="keywordflow">if</span>(qAux_top[loc].find(qIn))</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;            {</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                row_start = qAux_top[loc].inner_dim(qIn);</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;            }</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160; </div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160; </div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut,cols] : auxdim[loc+1])</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;            {</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;                std::size_t col_start = 0;</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;                <span class="keywordflow">if</span>(qAux_top[loc+1].find(qOut))</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;                {</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;                    col_start = qAux_top[loc+1].inner_dim(qOut);</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;                }</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;                <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;                {</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                    lout &lt;&lt; <span class="stringliteral">&quot;\tqIn = {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qIn) &lt;&lt; <span class="stringliteral">&quot;} and qOut = {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(qOut) &lt;&lt; <span class="stringliteral">&quot;} is a &quot;</span> &lt;&lt; rows &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; cols &lt;&lt; <span class="stringliteral">&quot;-matrix:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;                }</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_row(cols, empty_op_map);</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; O_temp(rows, temp_row);</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                <span class="keyword">auto</span> it_top = O_top[loc].find({qIn,qOut});</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;                <span class="keyword">auto</span> it_bottom = O_bottom[loc].find({qIn,qOut});</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;                <span class="keywordflow">if</span>(it_top != O_top[loc].end())</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                {</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; &amp;O_top_temp = it_top-&gt;second;</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                    std::size_t top_rows = O_top_temp.size();</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;                    std::size_t top_cols = O_top_temp[0].size();</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;<span class="preprocessor">                    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;                    {</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;                        lout &lt;&lt; <span class="stringliteral">&quot;\t\t Block exists in top MPO and is written from [0|0] to [&quot;</span> &lt;&lt; top_rows-1 &lt;&lt; <span class="stringliteral">&quot;|&quot;</span> &lt;&lt; top_cols-1 &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;                    }</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="preprocessor">                    #endif</span></div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;                    <span class="keywordflow">for</span>(std::size_t row=0; row&lt;top_rows; ++row)</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;                    {</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;                        <span class="keywordflow">for</span>(std::size_t col=0; col&lt;top_cols; ++col)</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                        {</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;                            O_temp[row][col] = O_top_temp[row][col];</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;                        }</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;                    }</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;                }</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;                {</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;                    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;                    {</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;                        lout &lt;&lt; <span class="stringliteral">&quot;\t\t Block does not exist in top MPO&quot;</span>;</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                    }</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                }</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;                <span class="keywordflow">if</span>(it_bottom != O_bottom[loc].end())</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;                {</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;                    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; &amp;O_bottom_temp = it_bottom-&gt;second;</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                    std::size_t bottom_rows = O_bottom_temp.size();</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                    std::size_t bottom_cols = O_bottom_temp[0].size();</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;<span class="preprocessor">                    #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;                    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;                    {</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;                        lout &lt;&lt; <span class="stringliteral">&quot;\t|\t Block exists in bottom MPO and is written from [&quot;</span> &lt;&lt; row_start &lt;&lt; <span class="stringliteral">&quot;|&quot;</span> &lt;&lt; col_start &lt;&lt; <span class="stringliteral">&quot;] to [&quot;</span> &lt;&lt; row_start+bottom_rows-1 &lt;&lt; <span class="stringliteral">&quot;|&quot;</span> &lt;&lt; col_start+bottom_cols-1 &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                    }</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<span class="preprocessor">                    #endif</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                    <span class="keywordflow">for</span>(std::size_t row=0; row&lt;bottom_rows; ++row)</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;                    {</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;                        <span class="keywordflow">for</span>(std::size_t col=0; col&lt;bottom_cols; ++col)</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;                        {</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                            O_temp[row_start+row][col_start+col] = O_bottom_temp[row][col];</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                        }</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                    }</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                }</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;<span class="preprocessor">                #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;                {</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;                    <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;                    {</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;                        lout &lt;&lt; <span class="stringliteral">&quot;\t|\t Block does not exist in bottom MPO&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;                    }</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;                }</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                O_out[loc].insert({{qIn,qOut},O_temp});</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;            }</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;        }</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;    }</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160; </div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;    <a class="code" href="classMpoTerms.html">MpoTerms&lt;Symmetry,Scalar&gt;</a> out(N_sites,boundary_condition_out,qTot,VERB);</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;    out.<a class="code" href="classMpoTerms.html#ada165954c8f586180a7e259d9cf535b3">reconstruct</a>(O_out, qAux_out, qPhys, <span class="keyword">true</span>, boundary_condition_out,qTot);</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;    <span class="keywordflow">if</span>(boundary_condition_out == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">BC::OPEN</a>)</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;    {</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;        {</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Open System: Add both rows at first lattice site and both columns at last lattice site&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;        }</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;        out.<a class="code" href="classMpoTerms.html#a540eb7909387ae88971a5d0dda1032be">add_to_row</a>(0, Symmetry::qvacuum(), 0, out.<a class="code" href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1">delete_row</a>(0, Symmetry::qvacuum(),1,<span class="keyword">false</span>),1.);</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;        out.<a class="code" href="classMpoTerms.html#a50686e5f9fb163156350c4804cc3f630">decrement_first_auxdim_OBC</a>(Symmetry::qvacuum());</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;        out.<a class="code" href="classMpoTerms.html#af017aefebdff6bd775d6f12109233144">add_to_col</a>(N_sites-1, qTot, 0, out.<a class="code" href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45">delete_col</a>(N_sites-1, qTot,1,<span class="keyword">false</span>),1.);</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;        out.<a class="code" href="classMpoTerms.html#a81f461a56543a78c0a8f03fcca9b5de9">decrement_last_auxdim_OBC</a>(qTot);</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    }</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;    {</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;<span class="preprocessor">        #if DEBUG_VERBOSITY &gt; 1</span></div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;        <span class="keywordflow">if</span>(VERB != DMRG::VERBOSITY::OPTION::SILENT)</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;        {</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;            lout &lt;&lt; <span class="stringliteral">&quot;Infinite System: Add both incoming operator columns and both outgoing operator rows at each lattice site&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;        }</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;        {</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;            out.<a class="code" href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45">delete_col</a>(loc, Symmetry::qvacuum(), auxdim_bottom_starts[loc+1],<span class="keyword">false</span>);</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;            out.<a class="code" href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1">delete_row</a>(loc, Symmetry::qvacuum(), auxdim_bottom_starts[loc]+bottom.<a class="code" href="classMpoTerms.html#a1c9edb59beb0e03483cc8865ab648b92">get_pos_qTot</a>(),<span class="keyword">false</span>);</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;            out.<a class="code" href="classMpoTerms.html#af017aefebdff6bd775d6f12109233144">add_to_col</a>(loc, Symmetry::qvacuum(), top.<a class="code" href="classMpoTerms.html#a1c9edb59beb0e03483cc8865ab648b92">get_pos_qTot</a>(), out.<a class="code" href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45">delete_col</a>(loc, Symmetry::qvacuum(), auxdim_bottom_starts[loc+1],<span class="keyword">false</span>),1.);</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;            out.<a class="code" href="classMpoTerms.html#a540eb7909387ae88971a5d0dda1032be">add_to_row</a>(loc, Symmetry::qvacuum(), 0, out.<a class="code" href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1">delete_row</a>(loc, Symmetry::qvacuum(), auxdim_bottom_starts[loc],<span class="keyword">false</span>),1.);</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;        }</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;        {</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;            out.<a class="code" href="classMpoTerms.html#a037a5789f20cfbb4e76fa33d62529269">decrement_auxdim</a>(loc, Symmetry::qvacuum());</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;            out.<a class="code" href="classMpoTerms.html#a037a5789f20cfbb4e76fa33d62529269">decrement_auxdim</a>(loc, Symmetry::qvacuum());</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;        }</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;    }</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    <span class="keywordflow">if</span> ((top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;\n+&quot;</span>+bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()).length() &lt; <a class="code" href="MpoTerms_8h.html#a5b138ca20fd685462fbb27038ee41fd2">MAX_SUMPROD_STRINGLENGTH</a>)</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    {</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;        out.<a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a>(top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;\n+&quot;</span>+bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>());</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;    }</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;\n+&quot;</span>+bottom.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()).length() &gt;= <a class="code" href="MpoTerms_8h.html#a5b138ca20fd685462fbb27038ee41fd2">MAX_SUMPROD_STRINGLENGTH</a> and top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>().substr(top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>().length()-5) != <span class="stringliteral">&quot;[...]&quot;</span>)</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    {</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;        out.<a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a>(top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>()+<span class="stringliteral">&quot;\n+[...]&quot;</span>);</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;    }</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;    {</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;        out.<a class="code" href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">set_name</a>(top.<a class="code" href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">get_name</a>());</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    }</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    out.<a class="code" href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">compress</a>(tolerance);</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    out.<a class="code" href="classMpoTerms.html#a7732332da5839d9c1aa15d02f436c1d8">calc</a>(1);</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;    <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;}</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160; </div>
<div class="line"><a name="l03895"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a8b7aab9c8f59a6e6c9144e41e89da921"> 3895</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a8b7aab9c8f59a6e6c9144e41e89da921">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;<a class="code" href="classMpoTerms.html#a8b7aab9c8f59a6e6c9144e41e89da921">prod_delZeroCols_OBC</a> (std::map&lt;std::array&lt;qType, 2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt; &amp;O_last, <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> &amp;qAux_last, <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> &amp;qAux_prev, <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> &amp;qTot, <span class="keyword">const</span> std::size_t col_qTot)</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;{</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    std::map&lt;std::array&lt;qType, 2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt; O_new;</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    <a class="code" href="classQbasis.html">Qbasis&lt;Symmetry&gt;</a> qAux_new;</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    qAux_new.<a class="code" href="classQbasis.html#a08aa1430102e29bfdab544222a768043">push_back</a>(qTot,1);</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;entry : qAux_prev)</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    {</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;        <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> qIn = std::get&lt;0&gt;(entry);</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        std::size_t rows = std::get&lt;2&gt;(entry).size();</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_row(1,empty_op_map);</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp(rows,temp_row);</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        <span class="keyword">auto</span> it = O_last.find({qIn,qTot});</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        assert(it != O_last.end());</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;        <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        {</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;            temp[row][0] = (it-&gt;second)[row][col_qTot];</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        }</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        O_new.insert({{qIn,qTot},temp});</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;    }</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;    qAux_last.<a class="code" href="classQbasis.html#af737d717c947bb79f4540bb0a07e3851">clear</a>();</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;    qAux_last = qAux_new;</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;    O_last = O_new;</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;}</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160; </div>
<div class="line"><a name="l03921"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a5859cf057a9ecec4f6a758e6a63d6ee6"> 3921</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a5859cf057a9ecec4f6a758e6a63d6ee6">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;<a class="code" href="classMpoTerms.html#a5859cf057a9ecec4f6a758e6a63d6ee6">prod_swap_IBC</a> (std::vector&lt;std::map&lt;std::array&lt;qType, 2&gt;, std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt;&gt; &amp;O_out, std::vector&lt;std::size_t&gt; &amp;row_qVac, std::vector&lt;std::size_t&gt; &amp;col_qVac, std::vector&lt;std::size_t&gt; &amp;row_qTot, std::vector&lt;std::size_t&gt; &amp;col_qTot)</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;{</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;    std::size_t N_sites = O_out.size();</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;    <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> qVac = Symmetry::qvacuum();</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160; </div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    {</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;        <span class="keywordflow">if</span>(row_qVac[loc] != 0)</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;        {</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[qs, ops] : O_out[loc])</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;            {</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                <span class="keywordflow">if</span>(std::get&lt;0&gt;(qs) != qVac)</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                {</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                }</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp = ops[0];</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                ops[0] = ops[row_qVac[loc]];</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                ops[row_qVac[loc]] = temp;</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;            }</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;            <span class="keywordflow">if</span>(row_qTot[loc] == 0)</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;            {</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                row_qTot[loc] = row_qVac[0];</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;            }</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;        }</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;        <span class="keywordflow">if</span>(col_qVac[loc] != 0)</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;        {</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[qs, ops] : O_out[loc])</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;            {</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;                <span class="keywordflow">if</span>(std::get&lt;1&gt;(qs) != qVac)</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;                {</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;                }</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                std::size_t rows = ops.size();</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                {</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;                    std::map&lt;qType,OperatorType&gt; temp = ops[row][0];</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                    ops[row][0] = ops[row][col_qVac[loc]];</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;                    ops[row][col_qVac[loc]] = temp;</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;                }</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;            }</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;            <span class="keywordflow">if</span>(col_qTot[loc] == 0)</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;            {</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;                col_qTot[loc] = col_qVac[0];</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;            }</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;        }</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;        <span class="keywordflow">if</span>(row_qTot[loc] != 1)</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;        {</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[qs, ops] : O_out[loc])</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;            {</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;                <span class="keywordflow">if</span>(std::get&lt;0&gt;(qs) != qVac)</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;                {</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;                }</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp = ops[1];</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;                ops[1] = ops[row_qTot[loc]];</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                ops[row_qTot[loc]] = temp;</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;            }</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;        }</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;        <span class="keywordflow">if</span>(col_qTot[loc] != 1)</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;        {</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[qs, ops] : O_out[loc])</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;            {</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                <span class="keywordflow">if</span>(std::get&lt;1&gt;(qs) != qVac)</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;                {</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;                }</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;                std::size_t rows = ops.size();</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                {</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                    std::map&lt;qType,OperatorType&gt; temp = ops[row][1];</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;                    ops[row][1] = ops[row][col_qTot[loc]];</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;                    ops[row][col_qTot[loc]] = temp;</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;                }</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;            }</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;        }</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    }</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;}</div>
<div class="line"><a name="l03999"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aba05431e89e486dbc4c57592ed0bc715"> 3999</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#aba05431e89e486dbc4c57592ed0bc715">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<a class="code" href="classMpoTerms.html#aba05431e89e486dbc4c57592ed0bc715">set_Identity</a> (<span class="keyword">const</span> <span class="keyword">typename</span> Symmetry::qType &amp;Q)</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;{</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    got_update();</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    O.clear();</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;    O.resize(N_sites);</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;    auxdim.clear();</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    auxdim.resize(N_sites+1);</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    label = <span class="stringliteral">&quot;Id&quot;</span>;</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;    {</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;        auxdim[loc].insert({Q,1});</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;        std::map&lt;qType,OperatorType&gt; op_map;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        <a class="code" href="structSiteOperator.html">OperatorType</a> op = <a class="code" href="structSiteOperator.html">OperatorType</a>(Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;::Identity(qPhys[loc].size(),qPhys[loc].size()).sparseView(),Symmetry::qvacuum());</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="preprocessor">        #ifdef OPLABELS</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;        op.<a class="code" href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">label</a> = <span class="stringliteral">&quot;id&quot;</span>;</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        op_map.insert({Symmetry::qvacuum(),op});</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp(1,op_map);</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; Oloc(1,temp);</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        O[loc].insert({{Q,Q},Oloc});</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    }</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    auxdim[N_sites].insert({Q,1});</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    status = <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a>;</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;    calc(1);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;}</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160; </div>
<div class="line"><a name="l04026"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a18385263bb36606962eff5cf32648fc1"> 4026</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a18385263bb36606962eff5cf32648fc1">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;<a class="code" href="classMpoTerms.html#a18385263bb36606962eff5cf32648fc1">set_Zero</a> ()</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;{</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    got_update();</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;    O.clear();</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    O.resize(N_sites);</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    auxdim.clear();</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;    auxdim.resize(N_sites+1);</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;    label = <span class="stringliteral">&quot;Zero&quot;</span>;</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;    {</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;        auxdim[loc].insert({qVac,1});</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;        std::map&lt;qType,OperatorType&gt; op_map;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        <a class="code" href="structSiteOperator.html">OperatorType</a> op = <a class="code" href="structSiteOperator.html">OperatorType</a>(Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;::Zero(qPhys[loc].size(),qPhys[loc].size()).sparseView(),qVac);</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="preprocessor">        #ifdef OPLABELS</span></div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;        op.<a class="code" href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">label</a> = <span class="stringliteral">&quot;Zero&quot;</span>;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;        op_map.insert({qVac,op});</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;        std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp(1,op_map);</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; Oloc(1,temp);</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;        O[loc].insert({{qVac,qVac},Oloc});</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    }</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    auxdim[N_sites].insert({qVac,1});</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;    status = <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a>;</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    calc(1);</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;}</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160; </div>
<div class="line"><a name="l04053"></a><span class="lineno"><a class="line" href="classMpoTerms.html#ac7a18a0e931b11eb5bd258665a1dc29a"> 4053</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::vector&lt;std::pair&lt;typename Symmetry::qType, std::size_t&gt;&gt; <a class="code" href="classMpoTerms.html#ac7a18a0e931b11eb5bd258665a1dc29a">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;<a class="code" href="classMpoTerms.html#ac7a18a0e931b11eb5bd258665a1dc29a">base_order_IBC</a> (<span class="keyword">const</span> std::size_t power)<span class="keyword"> const</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;    assert(boundary_condition == <a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">BC::INFINITE</a>);</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    assert(power &gt; 0 and power &lt;= current_power);</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;    <span class="keyword">const</span> std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; &amp;qAux_ = (power == 1) ? qAux : qAux_powers[power-2];</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry,MatrixType&gt;&gt;&gt;&gt;&gt; &amp;W_ = (power == 1) ? W : W_powers[power-2];</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    std::vector&lt;std::pair&lt;qType, std::size_t&gt;&gt; vout(0);</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    std::vector&lt;std::pair&lt;qType, std::size_t&gt;&gt; vout_temp(0);</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    std::size_t hd = hilbert_dimension[0];</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    vout.push_back({qVac, pos_qTot});</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    <span class="keywordflow">for</span>(std::size_t i=0; i&lt;qAux_[0].data_.size(); ++i)</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    {</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <a class="code" href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">qType</a> qIn = std::get&lt;0&gt;(qAux_[0].data_[i]);</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        std::size_t <a class="code" href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a> = std::get&lt;2&gt;(qAux_[0].data_[i]).size();</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        <span class="keywordflow">for</span>(std::size_t row=0; row&lt;<a class="code" href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a>; row++)</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;        {</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;            <span class="keywordflow">if</span>(qIn == qVac and row == pos_qVac)</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;            {</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;            }</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;            <span class="keywordflow">if</span>(qIn == qTot and row == pos_qTot)</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;            {</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;            }</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;            <span class="keywordtype">bool</span> isZeroOp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;            <span class="keywordflow">for</span>(std::size_t m=0; m&lt;hd; ++m)</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;            {</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;hd; ++n)</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;                {</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                    <span class="keywordflow">for</span>(std::size_t t=0; t&lt;W_[0][m][n].size(); ++t)</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;                    {</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;                        <span class="keyword">auto</span> it = W_[0][m][n][t].dict.find({qIn,qVac});</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;                        <span class="keywordflow">if</span>(it != W_[0][m][n][t].dict.end() and</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;                           std::abs(W_[0][m][n][t].block[it-&gt;second].coeff(row,pos_qTot)) &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;                        {</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;                            isZeroOp = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;                        }</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;                    }</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                    <span class="keywordflow">if</span>(!isZeroOp) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;                }</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                <span class="keywordflow">if</span>(!isZeroOp) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;            }</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;            <span class="keywordflow">if</span>(!isZeroOp)</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;            {</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;                vout.push_back({qIn,row});</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;            }</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;            {</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;                vout_temp.push_back({qIn,row});</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;            }</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;        }</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    }</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    vout.insert(vout.end(), vout_temp.begin(), vout_temp.end());</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    vout.push_back({qVac, pos_qVac});</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;<span class="preprocessor">    #if DERBUG_VERBOSITY &gt; 0</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;    lout &lt;&lt; <span class="stringliteral">&quot;Base order for VUMPS:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;    <span class="keywordflow">for</span>(std::size_t i=0; i&lt;vout.size(); ++i)</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;    {</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;        lout &lt;&lt; <span class="stringliteral">&quot;\t#&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: {&quot;</span> &lt;&lt; Sym::format&lt;Symmetry&gt;(std::get&lt;0&gt;(vout[i])) &lt;&lt; <span class="stringliteral">&quot;}[&quot;</span> &lt;&lt; std::get&lt;1&gt;(vout[i]) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;    }</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;    <span class="keywordflow">return</span> vout;</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;}</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160; </div>
<div class="line"><a name="l04119"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a08d290a1f3029772b6b38dc559558099"> 4119</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a08d290a1f3029772b6b38dc559558099">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<a class="code" href="classMpoTerms.html#a08d290a1f3029772b6b38dc559558099">renormalize</a> ()</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;{</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    got_update();</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    std::vector&lt;double&gt; <a class="code" href="DmrgPivotMatrix0_8h.html#a0c09fc9551162052524fc669ea7364a2">norm</a>(N_sites, 0.);</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    {</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qs,ops] : O[loc])</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;        {</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;ops.size(); ++row)</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;            {</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;                <span class="keywordflow">for</span>(std::size_t col=0; col&lt;ops[row].size(); ++col)</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                {</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q,op] : ops[row][col])</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                    {</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                        <a class="code" href="DmrgPivotMatrix0_8h.html#a0c09fc9551162052524fc669ea7364a2">norm</a>[loc] += op.data.norm();</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                    }</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                }</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;            }</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;        }</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;    }</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    <span class="keywordtype">double</span> overall_norm = 1;</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;    {</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;        overall_norm *= <a class="code" href="DmrgPivotMatrix0_8h.html#a0c09fc9551162052524fc669ea7364a2">norm</a>[loc];</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    }</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;    overall_norm = std::pow(overall_norm, 1.0/N_sites);</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;    {</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[qs,ops] : O[loc])</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;        {</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;ops.size(); ++row)</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;            {</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;                <span class="keywordflow">for</span>(std::size_t col=0; col&lt;ops[row].size(); ++col)</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;                {</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[Q,op] : ops[row][col])</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;                    {</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;                        <span class="keywordtype">double</span> factor = overall_norm/<a class="code" href="DmrgPivotMatrix0_8h.html#a0c09fc9551162052524fc669ea7364a2">norm</a>[loc];</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;                        op.data = factor * op.data;</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;                    }</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;                }</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;            }</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;        }</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    }</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;}</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160; </div>
<div class="line"><a name="l04165"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a6cde3a3f485a4f4300c7b54b6674efc4"> 4165</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a6cde3a3f485a4f4300c7b54b6674efc4">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;<a class="code" href="classMpoTerms.html#a6cde3a3f485a4f4300c7b54b6674efc4">clear_opLabels</a> ()</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;{</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    {</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[qs,ops] : O[loc])</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;        {</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;ops.size(); ++row)</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;            {</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;                <span class="keywordflow">for</span>(std::size_t col=0; col&lt;ops[row].size(); ++col)</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;                {</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> &amp;[Q,op] : ops[row][col])</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                    {</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;                        op.label = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;                    }</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;                }</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;            }</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        }</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    }</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;}</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160; </div>
<div class="line"><a name="l04186"></a><span class="lineno"><a class="line" href="classMpoTerms.html#acd023265ae6218668c30d75e6ba2cdc3"> 4186</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; std::tuple&lt;std::size_t,std::size_t,std::size_t,std::size_t&gt; <a class="code" href="classMpoTerms.html#acd023265ae6218668c30d75e6ba2cdc3">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;<a class="code" href="classMpoTerms.html#acd023265ae6218668c30d75e6ba2cdc3">auxdim_infos</a> ()<span class="keyword"> const</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    std::size_t total_auxdim = 0;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    std::size_t maximum_local_auxdim = 0;</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    std::size_t total_full_auxdim = 0;</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    std::size_t maximum_local_full_auxdim = 0;</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    <span class="keywordflow">for</span>(std::size_t bond=0; bond&lt;N_sites; ++bond)</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    {</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;        std::size_t local_auxdim = 0;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;        std::size_t local_full_auxdim = 0;</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[q,deg] : auxdim[bond])</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;        {</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;            local_auxdim += deg;</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;            local_full_auxdim += deg * Symmetry::degeneracy(q);</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;        }</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;        total_auxdim += local_auxdim;</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;        total_full_auxdim += local_full_auxdim;</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;        <span class="keywordflow">if</span>(local_auxdim &gt; maximum_local_auxdim)</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;        {</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;            maximum_local_auxdim = local_auxdim;</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        }</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;        <span class="keywordflow">if</span>(local_full_auxdim &gt; maximum_local_full_auxdim)</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;        {</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;            maximum_local_full_auxdim = local_full_auxdim;</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;        }</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;    }</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    <span class="keywordflow">return</span> std::make_tuple(total_auxdim,maximum_local_auxdim,total_full_auxdim,maximum_local_full_auxdim);</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;}</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160; </div>
<div class="line"><a name="l04216"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a444847ac22aff7cca40686ff04d96160"> 4216</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">double</span> <a class="code" href="classMpoTerms.html#a444847ac22aff7cca40686ff04d96160">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;<a class="code" href="classMpoTerms.html#a444847ac22aff7cca40686ff04d96160">memory</a> (MEMUNIT memunit)<span class="keyword"> const</span></div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;    <span class="keywordtype">double</span> mem_O = 0.;</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;O.size(); ++loc)</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;    {</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;        mem_O += calc_memory&lt;std::size_t&gt;(2 * Symmetry::Nq * O[loc].size(),memunit);</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qs,ops] : O[loc])</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;        {</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;            <span class="keywordflow">for</span>(std::size_t row=0; row&lt;ops.size(); ++row)</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;            {</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                <span class="keywordflow">for</span>(std::size_t col=0; col&lt;ops[row].size(); ++col)</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;                {</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                    mem_O += calc_memory&lt;std::size_t&gt;(Symmetry::Nq * ops[row][col].size(),memunit);</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[Q,op] : ops[row][col])</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;                    {</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;                        mem_O += calc_memory(op.data,memunit) + calc_memory(op.label,memunit);</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                    }</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                }</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;            }</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;        }</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;    }</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160; </div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;    <span class="keywordtype">double</span> mem_auxdim = 0.;</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;=N_sites; ++loc)</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;    {</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;        mem_auxdim +=  calc_memory&lt;std::size_t&gt;((Symmetry::Nq + 1) * auxdim[loc].size(),memunit);</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    }</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    </div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;    <span class="keywordtype">double</span> mem_qAux = 0.;</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;    <span class="keywordflow">if</span>(GOT_QAUX)</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    {</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;qAux.size(); ++loc)</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;        {</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;            <span class="keywordflow">for</span>(std::size_t i=0; i&lt;qAux[loc].data_.size(); ++i)</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;            {</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;                mem_qAux += calc_memory&lt;std::size_t&gt;(Symmetry::Nq + 1,memunit);</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;                mem_qAux += std::get&lt;2&gt;(qAux[loc].data_[i]).size() * (calc_memory(<span class="stringliteral">&quot;&quot;</span>,memunit)+calc_memory&lt;std::size_t&gt;(1ul,memunit));</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;            }</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;            mem_qAux += calc_memory&lt;std::size_t&gt;(Symmetry::Nq * qAux[loc].history.size(),memunit);</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[q,vec] : qAux[loc].history)</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;            {</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;                mem_qAux += calc_memory&lt;std::size_t&gt;((2*Symmetry::Nq + 1) * vec.size(), memunit);</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;            }</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;        }</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    }</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    </div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    <span class="keywordtype">double</span> mem_qOp = 0.;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    <span class="keywordflow">if</span>(GOT_QOP)</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;    {</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;qOp.size(); ++loc)</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;        {</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;            mem_qOp += Symmetry::Nq * calc_memory&lt;std::size_t&gt;(qOp[loc].size(), memunit);</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;        }</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;    }</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;    </div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    <span class="keywordtype">double</span> mem_qPhys = 0.;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;qPhys.size(); ++loc)</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;    {</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;        <span class="keywordflow">if</span>(GOT_QPHYS[loc])</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;        {</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;            mem_qOp += Symmetry::Nq * calc_memory&lt;std::size_t&gt;(qPhys[loc].size(), memunit);</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;        }</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    }</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;    </div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;    <span class="keywordtype">double</span> mem_W = 0.;</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    <span class="keywordflow">if</span>(GOT_W)</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    {</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;W.size(); ++loc)</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;        {</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;            <span class="keywordflow">for</span>(std::size_t m=0; m&lt;W[loc].size(); ++m)</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;            {</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;W[loc][m].size(); ++n)</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;                {</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                    <span class="keywordflow">for</span>(std::size_t t=0; t&lt;W[loc][m][n].size(); ++t)</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;                    {</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                        mem_W += W[loc][m][n][t].memory(memunit) + W[loc][m][n][t].overhead(memunit);</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;                    }</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;                }</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;            }</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;        }</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    }</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;    </div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    <span class="keywordtype">double</span> mem_info = 0.;</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;    mem_info += calc_memory(label,memunit);</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;info.size(); ++loc)</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    {</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;        <span class="keywordflow">for</span>(std::size_t i=0; i&lt;info[loc].size(); ++i)</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;        {</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;            mem_info += calc_memory(info[loc][i],memunit);</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;        }</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    }</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    </div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <span class="keywordtype">double</span> mem_powers = 0.;</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    <span class="keywordflow">for</span>(std::size_t power=2; power&lt;=current_power; ++power)</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    {</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;W_powers[power-2].size(); ++loc)</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;        {</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;            <span class="keywordflow">for</span>(std::size_t m=0; m&lt;W_powers[power-2][loc].size(); ++m)</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;            {</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;W_powers[power-2][loc][m].size(); ++n)</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;                {</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;                    <span class="keywordflow">for</span>(std::size_t t=0; t&lt;W_powers[power-2][loc][m][n].size(); ++t)</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;                    {</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;                        mem_powers += W_powers[power-2][loc][m][n][t].memory(memunit) + W_powers[power-2][loc][m][n][t].overhead(memunit);</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;                    }</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;                }</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;            }</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;            mem_powers += Symmetry::Nq * calc_memory&lt;std::size_t&gt;(qOp_powers[power-2][loc].size(), memunit);</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;            <span class="keywordflow">for</span>(std::size_t i=0; i&lt;qAux_powers[power-2][loc].data_.size(); ++i)</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;            {</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;                mem_powers += calc_memory&lt;std::size_t&gt;(Symmetry::Nq + 1,memunit);</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;                mem_powers += std::get&lt;2&gt;(qAux_powers[power-2][loc].data_[i]).size() * (calc_memory(<span class="stringliteral">&quot;&quot;</span>,memunit)+calc_memory&lt;std::size_t&gt;(1ul,memunit));</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;            }</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;            mem_powers += calc_memory&lt;std::size_t&gt;(Symmetry::Nq * qAux_powers[power-2][loc].history.size(),memunit);</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[q,vec] : qAux_powers[power-2][loc].history)</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;            {</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;                mem_powers += calc_memory&lt;std::size_t&gt;((2*Symmetry::Nq + 1) * vec.size(), memunit);</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;            }</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;        }</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    }</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;    </div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;    <span class="keywordflow">return</span> mem_O + mem_auxdim + mem_qAux + mem_qOp + mem_qPhys + mem_W + mem_info + mem_powers;</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;}</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160; </div>
<div class="line"><a name="l04341"></a><span class="lineno"><a class="line" href="classMpoTerms.html#aff82dccf68884809ab15105b8a835f00"> 4341</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">double</span> <a class="code" href="classMpoTerms.html#aff82dccf68884809ab15105b8a835f00">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;<a class="code" href="classMpoTerms.html#aff82dccf68884809ab15105b8a835f00">sparsity</a> (<span class="keyword">const</span> std::size_t power, <span class="keyword">const</span> <span class="keywordtype">bool</span> PER_MATRIX)<span class="keyword"> const</span></div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;    assert(power &gt; 0 and power &lt;= current_power);</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;    assert(GOT_W);</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;    assert(GOT_QAUX);</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;    assert(!PER_MATRIX and <span class="stringliteral">&quot;? TODO&quot;</span>);</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    std::size_t nonzero_elements = 0;</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    std::size_t overall_elements = 0;</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;    <span class="keyword">const</span> std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; &amp;qAux_ = (power == 1) ? qAux : qAux_powers[power-2];</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry,MatrixType&gt;&gt;&gt;&gt;&gt; &amp;W_ = (power == 1) ? W : W_powers[power-2];</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;    std::vector&lt;std::size_t&gt; dims(N_sites+1);</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    <span class="keywordflow">for</span>(std::size_t i=0; i&lt;qAux_[0].data_.size(); ++i)</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;    {</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;        dims[0] += std::get&lt;2&gt;(qAux_[0].data_[i]).size();</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;    }</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    {</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;        <span class="keywordflow">for</span>(std::size_t i=0; i&lt;qAux_[loc+1].data_.size(); ++i)</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;        {</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;            dims[loc+1] += std::get&lt;2&gt;(qAux_[loc+1].data_[i]).size();</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;        }</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;        std::size_t hd = hilbert_dimension[loc];</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;        overall_elements += hd * hd * dims[loc] * dims[loc+1];</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;        <span class="keywordflow">for</span>(std::size_t m=0; m&lt;hd; ++m)</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;        {</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;            <span class="keywordflow">for</span>(std::size_t n=0; n&lt;hd; ++n)</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;            {</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> &amp;left = qAux_[loc].data_;</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> &amp;right = qAux_[loc+1].data_;</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;                <span class="keywordflow">for</span>(std::size_t i=0; i&lt;left.size(); ++i)</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;                {</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                    <span class="keywordflow">for</span>(std::size_t j=0; j&lt;right.size(); ++j)</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;                    {</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;                        Eigen::Matrix&lt;int,Eigen::Dynamic,Eigen::Dynamic&gt; entries = Eigen::Matrix&lt;int,Eigen::Dynamic,Eigen::Dynamic&gt;::Zero(std::get&lt;2&gt;(left[i]).size(),std::get&lt;2&gt;(right[j]).size());</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;                        <span class="keywordflow">for</span>(std::size_t t=0; t&lt;W_[loc][m][n].size(); ++t)</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;                        {</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;                            <span class="keyword">auto</span> it = W_[loc][m][n][t].dict.find({std::get&lt;0&gt;(left[i]),std::get&lt;0&gt;(right[j])});</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;                            <span class="keywordflow">if</span>(it != W_[loc][m][n][t].dict.end())</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;                            {</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classMpoTerms.html#ab7be76c72cfd76e91404ffd0b0563a76">MatrixType</a> &amp;mat = W_[loc][m][n][t].block[it-&gt;second];</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;                                assert(mat.rows() == std::get&lt;2&gt;(left[i]).size());</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;                                assert(mat.cols() == std::get&lt;2&gt;(right[j]).size());</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;                                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;mat.rows(); ++row)</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;                                {</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;                                    <span class="keywordflow">for</span>(std::size_t col=0; col&lt;mat.cols(); ++col)</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;                                    {</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;                                        <span class="keywordflow">if</span>(entries(row,col) == 0 and std::abs(mat.coeff(row,col)) &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;                                        {</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;                                            nonzero_elements++;</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;                                            entries(row,col) = 1;</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;                                        }</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                                    }</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;                                }</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;                            }</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;                        }</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;                    }</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;                }</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;            }</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;        }</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;    }</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;    <span class="keywordflow">return</span> (nonzero_elements+0.)/(overall_elements+0.);</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;}</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160; </div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;<span class="preprocessor">#ifdef USE_HDF5_STORAGE</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a32621141cb84e784d538736646f1ed0a">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;<a class="code" href="classMpoTerms.html#a32621141cb84e784d538736646f1ed0a">save</a> (std::string filename)</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;{</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;    assert(GOT_W and <span class="stringliteral">&quot;W has to be calculated before saving.&quot;</span>);</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    assert(GOT_QAUX and <span class="stringliteral">&quot;qAux has to be calculated before saving.&quot;</span>);</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;    assert(GOT_QOP and <span class="stringliteral">&quot;qOp has to be calculated before saving.&quot;</span>);</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;    filename+=<span class="stringliteral">&quot;.h5&quot;</span>;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    lout &lt;&lt; termcolor::green &lt;&lt; <span class="stringliteral">&quot;Saving MPO to path &quot;</span> &lt;&lt; filename &lt;&lt; termcolor::reset &lt;&lt; std::endl;</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;    HDF5Interface target(filename, WRITE);</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;    </div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;    target.save_scalar(N_sites,<span class="stringliteral">&quot;L&quot;</span>);</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;    target.save_scalar(N_phys,<span class="stringliteral">&quot;vol&quot;</span>);</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;    target.save_scalar(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(boundary_condition),<span class="stringliteral">&quot;boundary_condition&quot;</span>);</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;    target.save_scalar(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(status),<span class="stringliteral">&quot;status&quot;</span>);</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;    std::string labelstring = <span class="stringliteral">&quot;Label&quot;</span>;</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    target.save_char(label,labelstring.c_str());</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;    target.save_scalar(current_power,<span class="stringliteral">&quot;maxPower&quot;</span>);</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160; </div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    target.create_group(<span class="stringliteral">&quot;qTot&quot;</span>);</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    <span class="keywordflow">for</span>(std::size_t nq=0; nq&lt;Symmetry::Nq; ++nq)</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;    {</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;nq=&quot;</span> &lt;&lt; nq;</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;        target.save_scalar(qTot[nq],ss.str(),<span class="stringliteral">&quot;qTot&quot;</span>);</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;    }</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;    </div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    target.create_group(<span class="stringliteral">&quot;qPhys&quot;</span>);</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;    {</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;        std::stringstream ss_hd;</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;        ss_hd &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,hd&quot;</span>;</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;        target.save_scalar(hilbert_dimension[loc],ss_hd.str(),<span class="stringliteral">&quot;qPhys&quot;</span>);</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;        <span class="keywordflow">for</span>(std::size_t n=0; n&lt;hilbert_dimension[loc]; ++n)</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;        {</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;            <span class="keywordflow">for</span>(std::size_t nq=0; nq&lt;Symmetry::Nq; ++nq)</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;            {</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;                std::stringstream ss;</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;                ss &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,n=&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;,nq=&quot;</span> &lt;&lt; nq;</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;                target.save_scalar((qPhys[loc][n])[nq],ss.str(),<span class="stringliteral">&quot;qPhys&quot;</span>);</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;            }</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;        }</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    }</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;    </div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;    <span class="keywordflow">for</span>(std::size_t power = 1; power&lt;=current_power; ++power)</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;    {</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;^&quot;</span> &lt;&lt; power;</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;        std::string powerstring = (power == 1 ? <span class="stringliteral">&quot;&quot;</span> : ss.str());</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;    </div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;        std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; &amp;qAux_ = (power == 1 ? qAux : qAux_powers[power-2]);</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;        std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;qOp_ = (power == 1 ? qOp : qOp_powers[power-2]);</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;        std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry,MatrixType&gt;&gt;&gt;&gt;&gt; &amp;W_ = (power == 1 ? W : W_powers[power-2]);</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;        </div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;        std::vector&lt;std::vector&lt;qType&gt;&gt; qAuxVec_(N_sites+1);</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;        std::vector&lt;std::vector&lt;std::size_t&gt;&gt; qAuxVec_deg_(N_sites+1);</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;=N_sites; ++loc)</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;        {</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;            <span class="keywordflow">for</span>(std::size_t k=0; k&lt;qAux_[loc].data_.size(); ++k)</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;            {</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;                qAuxVec_[loc].push_back(std::get&lt;0&gt;(qAux_[loc].data_[k]));</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;                qAuxVec_deg_[loc].push_back(std::get&lt;2&gt;(qAux_[loc].data_[k]).size());</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;            }</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;        }</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;        </div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;        </div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;        target.create_group(<span class="stringliteral">&quot;qAux&quot;</span>+powerstring);</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;=N_sites; ++loc)</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;        {</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;            std::stringstream ss_size;</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;            ss_size &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,size&quot;</span>;</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;            target.save_scalar(qAuxVec_[loc].size(),ss_size.str(),<span class="stringliteral">&quot;qAux&quot;</span>+powerstring);</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;            <span class="keywordflow">for</span>(std::size_t k=0; k&lt;qAuxVec_[loc].size(); ++k)</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;            {</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;                std::stringstream ss_deg;</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;                ss_deg &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;,deg&quot;</span>;</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;                target.save_scalar(qAuxVec_deg_[loc][k], ss_deg.str(),<span class="stringliteral">&quot;qAux&quot;</span>+powerstring);</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;                <span class="keywordflow">for</span>(std::size_t nq=0; nq&lt;Symmetry::Nq; ++nq)</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;                {</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;                    std::stringstream ss_quantum;</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;                    ss_quantum &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;,nq=&quot;</span> &lt;&lt; nq;</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;                    target.save_scalar((qAuxVec_[loc][k])[nq], ss_quantum.str(),<span class="stringliteral">&quot;qAux&quot;</span>+powerstring);</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;                }</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;            }</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;        }</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;        </div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;        target.create_group(<span class="stringliteral">&quot;qOp&quot;</span>+powerstring);</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;        {</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;            std::stringstream ss_size;</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;            ss_size &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,size&quot;</span>;</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;            target.save_scalar(qOp_[loc].size(),ss_size.str(),<span class="stringliteral">&quot;qOp&quot;</span>+powerstring);</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;            <span class="keywordflow">for</span>(std::size_t t=0; t&lt;qOp_[loc].size(); ++t)</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;            {</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;                <span class="keywordflow">for</span>(std::size_t nq=0; nq&lt;Symmetry::Nq; ++nq)</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;                {</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;                    std::stringstream ss;</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;                    ss &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,t=&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;,nq=&quot;</span> &lt;&lt; nq;</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                    target.save_scalar((qOp_[loc][t])[nq],ss.str(),<span class="stringliteral">&quot;qOp&quot;</span>+powerstring);</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                }</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;            }</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;        }</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;        </div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;        target.create_group(<span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;        {</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;            <span class="keywordflow">for</span>(std::size_t m=0; m&lt;hilbert_dimension[loc]; ++m)</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;            {</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;hilbert_dimension[loc]; ++n)</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;                {</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;                    <span class="keywordflow">for</span>(std::size_t t=0; t&lt;qOp_[loc].size(); ++t)</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;                    {</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;                        <a class="code" href="structBiped.html">Biped&lt;Symmetry,MatrixType&gt;</a>&amp; bip = W_[loc][m][n][t];</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;                        std::vector&lt;std::size_t&gt; ins, outs;</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;                        <span class="keywordflow">for</span>(std::size_t entry=0; entry&lt;bip.<a class="code" href="structBiped.html#ae14468a902960038b011cf7969170c6a">dim</a>; ++entry)</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;                        {</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;                            <span class="keyword">auto</span> it_in = find(qAuxVec_[loc].begin(), qAuxVec_[loc].end(), bip.<a class="code" href="structBiped.html#a41624c550f8f19cb4ac1e07474dd04c3">in</a>[entry]);</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;                            <span class="keyword">auto</span> it_out = find(qAuxVec_[loc+1].begin(), qAuxVec_[loc+1].end(), bip.<a class="code" href="structBiped.html#aeac8db26eb6318041ee03501f6e2c8db">out</a>[entry]);</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;                            assert(it_in != qAuxVec_[loc].end() and it_out != qAuxVec_[loc+1].end());</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;                            std::size_t qAux_in_pos = std::distance(qAuxVec_[loc].begin(),it_in);</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;                            std::size_t qAux_out_pos = std::distance(qAuxVec_[loc+1].begin(),it_out);</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;                            ins.push_back(qAux_in_pos);</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;                            outs.push_back(qAux_out_pos);</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;                            std::stringstream ss;</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;                            ss &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt;<span class="stringliteral">&quot;,m=&quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;,n=&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;,t=&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;,k&#39;=&quot;</span> &lt;&lt; qAux_in_pos &lt;&lt; <span class="stringliteral">&quot;,k=&quot;</span> &lt;&lt; qAux_out_pos;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;                            <span class="keywordflow">if</span> constexpr(std::is_same&lt;Scalar,std::complex&lt;double&gt;&gt;::value)</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;                            {</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;                                target.save_matrix(Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;(bip.<a class="code" href="structBiped.html#a21a7e07b013de243c92ba88c20879336">block</a>[entry].real()), ss.str()+<span class="stringliteral">&quot;,Re&quot;</span>, <span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;                                target.save_matrix(Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;(bip.<a class="code" href="structBiped.html#a21a7e07b013de243c92ba88c20879336">block</a>[entry].imag()), ss.str()+<span class="stringliteral">&quot;,Im&quot;</span>, <span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;                            }</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;                            {</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;                                target.save_matrix(Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;(bip.<a class="code" href="structBiped.html#a21a7e07b013de243c92ba88c20879336">block</a>[entry]),ss.str(),<span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;                            }</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;                        }</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;                        Eigen::Matrix&lt;std::size_t,Eigen::Dynamic,Eigen::Dynamic&gt; entries(ins.size(),2);</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;                        <span class="keywordflow">for</span>(std::size_t i=0; i&lt;ins.size(); ++i)</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;                        {</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;                            entries(i,0) = ins[i];</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;                            entries(i,1) = outs[i];</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;                        }</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;                        std::stringstream ss_entries;</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;                        ss_entries &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,m=&quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;,n=&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;,t=&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;,entries&quot;</span>;</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;                        target.save_matrix(entries,ss_entries.str(),<span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;                    }</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;                }</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;            }</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;        }</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;    }</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;    target.close();</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;}</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160; </div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a9807df589a9e1d516e51af88fd25c2e5">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;<a class="code" href="classMpoTerms.html#a9807df589a9e1d516e51af88fd25c2e5">load</a> (std::string filename)</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;{</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;    filename+=<span class="stringliteral">&quot;.h5&quot;</span>;</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;    lout &lt;&lt; termcolor::green &lt;&lt; <span class="stringliteral">&quot;Loading MPO from path &quot;</span> &lt;&lt; filename &lt;&lt; termcolor::reset &lt;&lt; std::endl;</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;    HDF5Interface source(filename, READ);</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    </div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    source.load_scalar(N_sites,<span class="stringliteral">&quot;L&quot;</span>);</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;    source.load_scalar(N_phys,<span class="stringliteral">&quot;vol&quot;</span>);</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;    source.load_scalar(current_power,<span class="stringliteral">&quot;maxPower&quot;</span>);</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;    <span class="keywordtype">int</span> boundary;</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;    source.load_scalar(boundary,<span class="stringliteral">&quot;boundary_condition&quot;</span>);</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;    boundary_condition = <span class="keyword">static_cast&lt;</span><a class="code" href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a><span class="keyword">&gt;</span>(boundary);</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;    <span class="keywordtype">int</span> stat;</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;    source.load_scalar(stat,<span class="stringliteral">&quot;status&quot;</span>);</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;    status = <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1a">MPO_STATUS::OPTION</a><span class="keyword">&gt;</span>(stat);</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;    <span class="comment">//source.load_char(&quot;Label&quot;,label); // old HDF5Interface</span></div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;    source.load_char(label,<span class="stringliteral">&quot;Label&quot;</span>);</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;    </div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;    status = <a class="code" href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a>;</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;    </div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;    <span class="keywordflow">for</span>(std::size_t nq=0; nq&lt;Symmetry::Nq; ++nq)</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;    {</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;nq=&quot;</span> &lt;&lt; nq;</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;        source.load_scalar(qTot[nq],ss.str(),<span class="stringliteral">&quot;qTot&quot;</span>);</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;    }</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;        </div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;    hilbert_dimension.clear();</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;    hilbert_dimension.resize(N_sites,0);</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    GOT_QPHYS.clear();</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;    GOT_QPHYS.resize(N_sites,<span class="keyword">true</span>);</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;    qPhys.clear();</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;    qPhys.resize(N_sites);</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;    {</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;        std::stringstream ss_hd;</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;        ss_hd &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,hd&quot;</span>;</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;        source.load_scalar(hilbert_dimension[loc],ss_hd.str(),<span class="stringliteral">&quot;qPhys&quot;</span>);</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;        qPhys[loc].resize(hilbert_dimension[loc]);</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;        <span class="keywordflow">for</span>(std::size_t n=0; n&lt;hilbert_dimension[loc]; ++n)</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;        {</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;            <span class="keywordflow">for</span>(std::size_t nq=0; nq&lt;Symmetry::Nq; ++nq)</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;            {</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;                std::stringstream ss;</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;                ss &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,n=&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;,nq=&quot;</span> &lt;&lt; nq;</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;                source.load_scalar((qPhys[loc][n])[nq],ss.str(),<span class="stringliteral">&quot;qPhys&quot;</span>);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;            }</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;        }</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    }</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;    </div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;    qAux_powers.clear();</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;    W_powers.clear();</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;    qOp_powers.clear();</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;    <span class="keywordflow">if</span>(current_power &gt; 1)</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;    {</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;        qAux_powers.resize(current_power-1);</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;        W_powers.resize(current_power-1);</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;        qOp_powers.resize(current_power-1);</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;    }</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;    </div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;    <span class="keywordflow">for</span>(std::size_t power = 1; power&lt;=current_power; ++power)</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;    {</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;^&quot;</span> &lt;&lt; power;</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;        std::string powerstring = (power == 1 ? <span class="stringliteral">&quot;&quot;</span> : ss.str());</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;        std::vector&lt;Qbasis&lt;Symmetry&gt;&gt; &amp;qAux_ = (power == 1 ? qAux : qAux_powers[power-2]);</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;        std::vector&lt;std::vector&lt;qType&gt;&gt; &amp;qOp_ = (power == 1 ? qOp : qOp_powers[power-2]);</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;        std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;Biped&lt;Symmetry,MatrixType&gt;&gt;&gt;&gt;&gt; &amp;W_ = (power == 1 ? W : W_powers[power-2]);</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;        </div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;        qAux_.clear();</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;        qAux_.resize(N_sites+1);</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;        qOp_.clear();</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;        qOp_.resize(N_sites);</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;        W_.clear();</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;        W_.resize(N_sites);</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;        </div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;        std::vector&lt;std::vector&lt;qType&gt;&gt; qAuxVec_(N_sites+1);</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;        std::vector&lt;std::vector&lt;std::size_t&gt;&gt; qAuxVec_deg_(N_sites+1);</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;=N_sites; ++loc)</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;        {</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;            std::stringstream ss_size;</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;            ss_size &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,size&quot;</span>;</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;            std::size_t size;</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;            source.load_scalar(size,ss_size.str(),<span class="stringliteral">&quot;qAux&quot;</span>+powerstring);</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;            qAuxVec_[loc].resize(size);</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;            qAuxVec_deg_[loc].resize(size);</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;            <span class="keywordflow">for</span>(std::size_t k=0; k&lt;qAuxVec_[loc].size(); ++k)</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;            {</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;                std::stringstream ss_deg;</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;                ss_deg &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;,deg&quot;</span>;</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;                source.load_scalar(qAuxVec_deg_[loc][k], ss_deg.str(),<span class="stringliteral">&quot;qAux&quot;</span>+powerstring);</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;                <span class="keywordflow">for</span>(std::size_t nq=0; nq&lt;Symmetry::Nq; ++nq)</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;                {</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;                    std::stringstream ss_quantum;</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;                    ss_quantum &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;,nq=&quot;</span> &lt;&lt; nq;</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;                    source.load_scalar((qAuxVec_[loc][k])[nq], ss_quantum.str(),<span class="stringliteral">&quot;qAux&quot;</span>+powerstring);</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;                }</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;            }</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;        }</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;        qAux_.resize(N_sites+1);</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;=N_sites; ++loc)</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;        {</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;            qAux_[loc].clear();</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;            <span class="keywordflow">for</span>(std::size_t k=0; k&lt;qAuxVec_[loc].size(); ++k)</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;            {</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;                qAux_[loc].push_back(qAuxVec_[loc][k],qAuxVec_deg_[loc][k]);</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;            }</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;        }</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160; </div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;        </div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;        {</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;            std::stringstream ss_size;</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;            ss_size &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,size&quot;</span>;</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;            std::size_t size;</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;            source.load_scalar(size,ss_size.str(),<span class="stringliteral">&quot;qOp&quot;</span>+powerstring);</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;            qOp_[loc].resize(size);</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;            <span class="keywordflow">for</span>(std::size_t t=0; t&lt;qOp_[loc].size(); ++t)</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;            {</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;                <span class="keywordflow">for</span>(std::size_t nq=0; nq&lt;Symmetry::Nq; ++nq)</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;                {</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;                    std::stringstream ss;</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                    ss &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,t=&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;,nq=&quot;</span> &lt;&lt; nq;</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;                    source.load_scalar((qOp_[loc][t])[nq],ss.str(),<span class="stringliteral">&quot;qOp&quot;</span>+powerstring);</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;                }</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;            }</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;        }</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;        </div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;        <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;        {</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;            W_[loc].resize(hilbert_dimension[loc]);</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;            <span class="keywordflow">for</span>(std::size_t m=0; m&lt;hilbert_dimension[loc]; ++m)</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;            {</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                W_[loc][m].resize(hilbert_dimension[loc]);</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                <span class="keywordflow">for</span>(std::size_t n=0; n&lt;hilbert_dimension[loc]; ++n)</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;                {</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;                    W_[loc][m][n].resize(qOp_[loc].size());</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;                    <span class="keywordflow">for</span>(std::size_t t=0; t&lt;qOp_[loc].size(); ++t)</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;                    {</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;                        <a class="code" href="structBiped.html">Biped&lt;Symmetry,MatrixType&gt;</a>&amp; bip = W_[loc][m][n][t];</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;                        Eigen::Matrix&lt;std::size_t, Eigen::Dynamic, Eigen::Dynamic&gt; entries;</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;                        std::stringstream ss_entries;</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;                        ss_entries &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt; <span class="stringliteral">&quot;,m=&quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;,n=&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;,t=&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;,entries&quot;</span>;</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;                        source.load_matrix(entries,ss_entries.str(),<span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;                        <span class="keywordflow">for</span>(std::size_t i=0; i&lt;entries.rows(); ++i)</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;                        {</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;                            std::stringstream ss_mat;</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;                            ss_mat &lt;&lt; <span class="stringliteral">&quot;loc=&quot;</span> &lt;&lt; loc &lt;&lt;<span class="stringliteral">&quot;,m=&quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;,n=&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;,t=&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;,k&#39;=&quot;</span> &lt;&lt; entries(i,0) &lt;&lt; <span class="stringliteral">&quot;,k=&quot;</span> &lt;&lt; entries(i,1);</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;                            <span class="keywordflow">if</span> constexpr(std::is_same&lt;Scalar,std::complex&lt;double&gt;&gt;::value)</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;                            {</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;                                Eigen::Matrix&lt;double,Eigen::Dynamic,Eigen::Dynamic&gt; Real;</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;                                Eigen::Matrix&lt;double,Eigen::Dynamic,Eigen::Dynamic&gt; Imag;</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;                                source.load_matrix(Real,ss_mat.str()+<span class="stringliteral">&quot;,Re&quot;</span>,<span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;                                source.load_matrix(Imag,ss_mat.str()+<span class="stringliteral">&quot;,Im&quot;</span>,<span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;                                bip.<a class="code" href="structBiped.html#a65bd241c1bb94f08f116f2975c8c891e">push_back</a>(qAuxVec_[loc][entries(i,0)],qAuxVec_[loc+1][entries(i,1)],(Real+1.i*Imag).sparseView());</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;                            }</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;                            {</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;                                Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt; mat;</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;                                source.load_matrix(mat,ss_mat.str(),<span class="stringliteral">&quot;W&quot;</span>+powerstring);</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;                                bip.<a class="code" href="structBiped.html#a65bd241c1bb94f08f116f2975c8c891e">push_back</a>(qAuxVec_[loc][entries(i,0)],qAuxVec_[loc+1][entries(i,1)],mat.sparseView());</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;                            }</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;                        }</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;                    }</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;                }</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;            }</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;        }</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    }</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;    GOT_QOP = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    GOT_QAUX = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;    GOT_W = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    source.close();</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;    fill_O_from_W();</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;}</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160; </div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160; </div>
<div class="line"><a name="l04735"></a><span class="lineno"><a class="line" href="classMpoTerms.html#a0e72f5a682eff4715e74e192733743c5"> 4735</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Scalar&gt; <span class="keywordtype">void</span> <a class="code" href="classMpoTerms.html#a0e72f5a682eff4715e74e192733743c5">MpoTerms&lt;Symmetry,Scalar&gt;::</a></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;<a class="code" href="classMpoTerms.html#a0e72f5a682eff4715e74e192733743c5">fill_O_from_W</a> ()</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;{</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;    auxdim.resize(N_sites+1);</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;    O.resize(N_sites);</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;    std::map&lt;qType,OperatorType&gt; empty_op_map;</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;    <span class="keywordflow">for</span>(std::size_t k=0; k&lt;qAux[0].data_.size(); ++k)</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;    {</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;        auxdim[0].insert({std::get&lt;0&gt;(qAux[0].data_[k]),std::get&lt;2&gt;(qAux[0].data_[k]).size()});</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;    }</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;    <span class="keywordflow">for</span>(std::size_t loc=0; loc&lt;N_sites; ++loc)</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;    {</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;        std::size_t hd = hilbert_dimension[loc];</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;        std::size_t od = qOp[loc].size();</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;        <span class="keywordflow">for</span>(std::size_t k=0; k&lt;qAux[loc+1].data_.size(); ++k)</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;        {</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;            auxdim[loc+1].insert({std::get&lt;0&gt;(qAux[loc+1].data_[k]),std::get&lt;2&gt;(qAux[loc+1].data_[k]).size()});</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;        }</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qIn,rows] : auxdim[loc])</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;        {</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;            std::map&lt;std::array&lt;qType, 2&gt;,std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt;&gt; O_loc;</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[qOut,cols] : auxdim[loc+1])</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;            {</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt; temp_col(cols,empty_op_map);</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                std::vector&lt;std::vector&lt;std::map&lt;qType,OperatorType&gt;&gt;&gt; temp_ops(rows,temp_col);</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;                </div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;                std::vector&lt;Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;&gt; operator_entries_Qs(od, Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;::Zero(hd,hd));</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;                std::vector&lt;std::vector&lt;Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;&gt;&gt; operator_entries_col(cols,operator_entries_Qs);</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;                std::vector&lt;std::vector&lt;std::vector&lt;Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt;&gt;&gt;&gt; operator_entries(rows,operator_entries_col);</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;                </div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;                <span class="keywordflow">for</span>(std::size_t m=0; m&lt;hd; ++m)</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;                {</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                    <span class="keywordflow">for</span>(std::size_t n=0; n&lt;hd; ++n)</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;                    {</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;                        <span class="keywordflow">for</span>(std::size_t t=0; t&lt;od; ++t)</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;                        {</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;                            <span class="keyword">auto</span> it = W[loc][m][n][t].dict.find({qIn,qOut});</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;                            <span class="keywordflow">if</span>(it != W[loc][m][n][t].dict.end())</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;                            {</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;                                Eigen::Matrix&lt;Scalar,Eigen::Dynamic,Eigen::Dynamic&gt; mat = W[loc][m][n][t].block[it-&gt;second];</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;                                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;                                {</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;                                    <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;                                    {</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;                                        (operator_entries[row][col][t]).coeffRef(m,n) = mat(row,col);</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;                                    }</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;                                }</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;                            }</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;                        }</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;                    }</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;                }</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;                </div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;                <span class="keywordflow">for</span>(std::size_t row=0; row&lt;rows; ++row)</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;                {</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;                    <span class="keywordflow">for</span>(std::size_t col=0; col&lt;cols; ++col)</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;                    {</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;                        <span class="keywordflow">for</span>(std::size_t t=0; t&lt;od; ++t)</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;                        {</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;                            <span class="keywordflow">if</span>(operator_entries[row][col][t].<a class="code" href="DmrgPivotMatrix0_8h.html#a0c09fc9551162052524fc669ea7364a2">norm</a>() &gt; ::mynumeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;                            {</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;                                <a class="code" href="structSiteOperator.html">SiteOperator&lt;Symmetry,Scalar&gt;</a> op;</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;                                op.<a class="code" href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">data</a> = operator_entries[row][col][t].sparseView();</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                                op.<a class="code" href="structSiteOperator.html#a8e83604df485e170d2c7a01d7fc3229f">Q</a> = qOp[loc][t];</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;                                temp_ops[row][col].insert({qOp[loc][t], op});</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;                            }</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                        }</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                    }</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                }</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                O[loc].insert({{qIn,qOut},temp_ops});</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;            }</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;        }</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;    }</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;}</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160; </div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aBiped_8h_html"><div class="ttname"><a href="Biped_8h.html">Biped.h</a></div></div>
<div class="ttc" id="aDmrgPivotMatrix0_8h_html_a0c09fc9551162052524fc669ea7364a2"><div class="ttname"><a href="DmrgPivotMatrix0_8h.html#a0c09fc9551162052524fc669ea7364a2">norm</a></div><div class="ttdeci">double norm(const PivotMatrix0&lt; Symmetry, Scalar, MpoScalar &gt; &amp;H)</div><div class="ttdef"><b>Definition:</b> <a href="DmrgPivotMatrix0_8h_source.html#l00114">DmrgPivotMatrix0.h:114</a></div></div>
<div class="ttc" id="aDmrgPivotMatrix0_8h_html_ac760052180d1fbf13b02bad23dd42699"><div class="ttname"><a href="DmrgPivotMatrix0_8h.html#ac760052180d1fbf13b02bad23dd42699">dim</a></div><div class="ttdeci">size_t dim(const PivotMatrix0&lt; Symmetry, Scalar, MpoScalar &gt; &amp;H)</div><div class="ttdef"><b>Definition:</b> <a href="DmrgPivotMatrix0_8h_source.html#l00107">DmrgPivotMatrix0.h:107</a></div></div>
<div class="ttc" id="aDmrgTypedefs_8h_html_a6e1412fca31cbd35d0f50f12fcc70b0f"><div class="ttname"><a href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a></div><div class="ttdeci">BC</div><div class="ttdef"><b>Definition:</b> <a href="DmrgTypedefs_8h_source.html#l00160">DmrgTypedefs.h:161</a></div></div>
<div class="ttc" id="aDmrgTypedefs_8h_html_a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae"><div class="ttname"><a href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa0e0143636c29971736eab47415868eae">OPEN</a></div><div class="ttdeci">@ OPEN</div><div class="ttdef"><b>Definition:</b> <a href="DmrgTypedefs_8h_source.html#l00163">DmrgTypedefs.h:163</a></div></div>
<div class="ttc" id="aDmrgTypedefs_8h_html_a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb"><div class="ttname"><a href="DmrgTypedefs_8h.html#a6e1412fca31cbd35d0f50f12fcc70b0fa6a1459101774b7f68e084098fa8bacbb">INFINITE</a></div><div class="ttdeci">@ INFINITE</div><div class="ttdef"><b>Definition:</b> <a href="DmrgTypedefs_8h_source.html#l00164">DmrgTypedefs.h:164</a></div></div>
<div class="ttc" id="aMpoTerms_8h_html_a5b138ca20fd685462fbb27038ee41fd2"><div class="ttname"><a href="MpoTerms_8h.html#a5b138ca20fd685462fbb27038ee41fd2">MAX_SUMPROD_STRINGLENGTH</a></div><div class="ttdeci">#define MAX_SUMPROD_STRINGLENGTH</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00009">MpoTerms.h:9</a></div></div>
<div class="ttc" id="aQbasis_8h_html"><div class="ttname"><a href="Qbasis_8h.html">Qbasis.h</a></div></div>
<div class="ttc" id="aSiteOperator_8h_html"><div class="ttname"><a href="SiteOperator_8h.html">SiteOperator.h</a></div></div>
<div class="ttc" id="aclassMpoTerms_html"><div class="ttname"><a href="classMpoTerms.html">MpoTerms</a></div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00034">MpoTerms.h:35</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a00badfef5e19dbd049ec106dabfe5690"><div class="ttname"><a href="classMpoTerms.html#a00badfef5e19dbd049ec106dabfe5690">MpoTerms::calc_W</a></div><div class="ttdeci">void calc_W()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01175">MpoTerms.h:1176</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a01cd59d39dd7afefbd450c1a34072080"><div class="ttname"><a href="classMpoTerms.html#a01cd59d39dd7afefbd450c1a34072080">MpoTerms::prod</a></div><div class="ttdeci">static MpoTerms&lt; Symmetry, Scalar &gt; prod(const MpoTerms&lt; Symmetry, Scalar &gt; &amp;top, const MpoTerms&lt; Symmetry, Scalar &gt; &amp;bottom, const qType &amp;qTot, const double tolerance=::mynumeric_limits&lt; double &gt;::epsilon())</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03288">MpoTerms.h:3289</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a037a5789f20cfbb4e76fa33d62529269"><div class="ttname"><a href="classMpoTerms.html#a037a5789f20cfbb4e76fa33d62529269">MpoTerms::decrement_auxdim</a></div><div class="ttdeci">void decrement_auxdim(const std::size_t loc, const qType &amp;q)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02424">MpoTerms.h:2425</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a04ecb67148ea52990e63db37c2256d99"><div class="ttname"><a href="classMpoTerms.html#a04ecb67148ea52990e63db37c2256d99">MpoTerms::MpoTerms</a></div><div class="ttdeci">MpoTerms(const std::size_t L=0, const BC boundary_condition_in=BC::OPEN, const qType &amp;qTot_in=Symmetry::qvacuum(), const DMRG::VERBOSITY::OPTION &amp;VERB_in=DMRG::VERBOSITY::OPTION::SILENT)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00731">MpoTerms.h:732</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a056cc8e2dd6c915ca6112b9eab5eb73e"><div class="ttname"><a href="classMpoTerms.html#a056cc8e2dd6c915ca6112b9eab5eb73e">MpoTerms::get_qAux_power</a></div><div class="ttdeci">const std::vector&lt; Qbasis&lt; Symmetry &gt; &gt; &amp; get_qAux_power(std::size_t power) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02811">MpoTerms.h:2812</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a065ff86f35239f072106349fe9135923"><div class="ttname"><a href="classMpoTerms.html#a065ff86f35239f072106349fe9135923">MpoTerms::hilbert_dimension</a></div><div class="ttdeci">std::vector&lt; int &gt; hilbert_dimension</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00092">MpoTerms.h:92</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a08d290a1f3029772b6b38dc559558099"><div class="ttname"><a href="classMpoTerms.html#a08d290a1f3029772b6b38dc559558099">MpoTerms::renormalize</a></div><div class="ttdeci">void renormalize()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l04119">MpoTerms.h:4120</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a0ab89f88f49f0d527f0fad63909d774d"><div class="ttname"><a href="classMpoTerms.html#a0ab89f88f49f0d527f0fad63909d774d">MpoTerms::GOT_QPHYS</a></div><div class="ttdeci">std::vector&lt; bool &gt; GOT_QPHYS</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00133">MpoTerms.h:133</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a0bce043e816b8f72b464bc0a0c5fd094"><div class="ttname"><a href="classMpoTerms.html#a0bce043e816b8f72b464bc0a0c5fd094">MpoTerms::show</a></div><div class="ttdeci">void show() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01033">MpoTerms.h:1034</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a0e72f5a682eff4715e74e192733743c5"><div class="ttname"><a href="classMpoTerms.html#a0e72f5a682eff4715e74e192733743c5">MpoTerms::fill_O_from_W</a></div><div class="ttdeci">void fill_O_from_W()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l04735">MpoTerms.h:4736</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a0f625a2568ae261d1e4e81579b046181"><div class="ttname"><a href="classMpoTerms.html#a0f625a2568ae261d1e4e81579b046181">MpoTerms::info</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::string &gt; &gt; info</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00086">MpoTerms.h:86</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a178a1447995cfdc9d86dc62514630af5"><div class="ttname"><a href="classMpoTerms.html#a178a1447995cfdc9d86dc62514630af5">MpoTerms::N_phys</a></div><div class="ttdeci">std::size_t N_phys</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00400">MpoTerms.h:400</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a180a7c6214981fdabc5336bba164d1e2"><div class="ttname"><a href="classMpoTerms.html#a180a7c6214981fdabc5336bba164d1e2">MpoTerms::GOT_QOP</a></div><div class="ttdeci">bool GOT_QOP</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00117">MpoTerms.h:117</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a18385263bb36606962eff5cf32648fc1"><div class="ttname"><a href="classMpoTerms.html#a18385263bb36606962eff5cf32648fc1">MpoTerms::set_Zero</a></div><div class="ttdeci">void set_Zero()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l04026">MpoTerms.h:4027</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a189b70d9830c29164b4c3299a78e33b2"><div class="ttname"><a href="classMpoTerms.html#a189b70d9830c29164b4c3299a78e33b2">MpoTerms::finalize</a></div><div class="ttdeci">void finalize(const bool COMPRESS=true, const std::size_t power=1, const double tolerance=::mynumeric_limits&lt; double &gt;::epsilon())</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01280">MpoTerms.h:1281</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a1c78886865dac407c7520d8da860b1c5"><div class="ttname"><a href="classMpoTerms.html#a1c78886865dac407c7520d8da860b1c5">MpoTerms::set_verbosity</a></div><div class="ttdeci">void set_verbosity(const DMRG::VERBOSITY::OPTION VERB_in)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00880">MpoTerms.h:881</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a1c9edb59beb0e03483cc8865ab648b92"><div class="ttname"><a href="classMpoTerms.html#a1c9edb59beb0e03483cc8865ab648b92">MpoTerms::get_pos_qTot</a></div><div class="ttdeci">const std::size_t get_pos_qTot() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00589">MpoTerms.h:589</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a1ed760f886a0cfe1399b7cda6a0f6507"><div class="ttname"><a href="classMpoTerms.html#a1ed760f886a0cfe1399b7cda6a0f6507">MpoTerms::get_O</a></div><div class="ttdeci">const std::vector&lt; std::map&lt; std::array&lt; qType, 2 &gt;, std::vector&lt; std::vector&lt; std::map&lt; qType, OperatorType &gt; &gt; &gt; &gt; &gt; &amp; get_O() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00526">MpoTerms.h:526</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a200f69501503c2c27655acc1d2757179"><div class="ttname"><a href="classMpoTerms.html#a200f69501503c2c27655acc1d2757179">MpoTerms::outBasis</a></div><div class="ttdeci">const Qbasis&lt; Symmetry &gt; &amp; outBasis(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00708">MpoTerms.h:708</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a205386f3179d65eb729b47d18a2d3e1a"><div class="ttname"><a href="classMpoTerms.html#a205386f3179d65eb729b47d18a2d3e1a">MpoTerms::get_qOp</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; qType &gt; &gt; &amp; get_qOp() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00541">MpoTerms.h:541</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a208e6a069fa706142dcc5a9784f03a44"><div class="ttname"><a href="classMpoTerms.html#a208e6a069fa706142dcc5a9784f03a44">MpoTerms::N_sites</a></div><div class="ttdeci">std::size_t N_sites</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00395">MpoTerms.h:395</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a22d6f4fe971d81465f2dc32b95ec0e4c"><div class="ttname"><a href="classMpoTerms.html#a22d6f4fe971d81465f2dc32b95ec0e4c">MpoTerms::get_info</a></div><div class="ttdeci">std::vector&lt; std::string &gt; get_info() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02754">MpoTerms.h:2755</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a23510dbe37f8461238e022c7fac76997"><div class="ttname"><a href="classMpoTerms.html#a23510dbe37f8461238e022c7fac76997">MpoTerms::sparsity</a></div><div class="ttdeci">double sparsity(bool USE_SQUARE, bool PER_MATRIX) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00722">MpoTerms.h:722</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a240574966a2d46584d23e3e4da2ec8e0"><div class="ttname"><a href="classMpoTerms.html#a240574966a2d46584d23e3e4da2ec8e0">MpoTerms::scale</a></div><div class="ttdeci">void scale(const Scalar factor, const Scalar offset=0., const std::size_t power=0ul, const double tolerance=1.e-14)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02856">MpoTerms.h:2857</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a240777a5c1097a3f8f047614c9e6f8e0"><div class="ttname"><a href="classMpoTerms.html#a240777a5c1097a3f8f047614c9e6f8e0">MpoTerms::check_SQUARE</a></div><div class="ttdeci">const bool check_SQUARE() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00721">MpoTerms.h:721</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a252f0e3ea06be953db7c3d2c7e7bfd91"><div class="ttname"><a href="classMpoTerms.html#a252f0e3ea06be953db7c3d2c7e7bfd91">MpoTerms::O</a></div><div class="ttdeci">std::vector&lt; std::map&lt; std::array&lt; qType, 2 &gt;, std::vector&lt; std::vector&lt; std::map&lt; qType, OperatorType &gt; &gt; &gt; &gt; &gt; O</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00047">MpoTerms.h:47</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a28235dd806b9a3c110477f756cb08cbe"><div class="ttname"><a href="classMpoTerms.html#a28235dd806b9a3c110477f756cb08cbe">MpoTerms::qPhys</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; qType &gt; &gt; qPhys</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00366">MpoTerms.h:366</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a2ae5c2f5b161751796f20ee3eb56c95d"><div class="ttname"><a href="classMpoTerms.html#a2ae5c2f5b161751796f20ee3eb56c95d">MpoTerms::check_qPhys</a></div><div class="ttdeci">bool check_qPhys() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02842">MpoTerms.h:2843</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a2fdc3c86a0ca19b84275cb722c25b7d5"><div class="ttname"><a href="classMpoTerms.html#a2fdc3c86a0ca19b84275cb722c25b7d5">MpoTerms::got_update</a></div><div class="ttdeci">void got_update()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03279">MpoTerms.h:3280</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a32621141cb84e784d538736646f1ed0a"><div class="ttname"><a href="classMpoTerms.html#a32621141cb84e784d538736646f1ed0a">MpoTerms::save</a></div><div class="ttdeci">void save(std::string filename)</div></div>
<div class="ttc" id="aclassMpoTerms_html_a3409266b67e4c85251ce814fd035627e"><div class="ttname"><a href="classMpoTerms.html#a3409266b67e4c85251ce814fd035627e">MpoTerms::locBasis</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; qType &gt; &gt; &amp; locBasis() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00702">MpoTerms.h:702</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a3668d13dd1ce3b725b8ba006bb5e11fa"><div class="ttname"><a href="classMpoTerms.html#a3668d13dd1ce3b725b8ba006bb5e11fa">MpoTerms::locBasis</a></div><div class="ttdeci">const std::vector&lt; qType &gt; &amp; locBasis(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00703">MpoTerms.h:703</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a36b1b28b4959923dc6a376466d145fb8"><div class="ttname"><a href="classMpoTerms.html#a36b1b28b4959923dc6a376466d145fb8">MpoTerms::W_full</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &gt; &gt; &gt; &amp; W_full() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00700">MpoTerms.h:700</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a36e9956082a09f9fb2d56120de38be16"><div class="ttname"><a href="classMpoTerms.html#a36e9956082a09f9fb2d56120de38be16">MpoTerms::assert_hilbert</a></div><div class="ttdeci">void assert_hilbert(const std::size_t loc, const std::size_t dim)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02727">MpoTerms.h:2728</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a385a411bda8bbd9c574828d3839b4321"><div class="ttname"><a href="classMpoTerms.html#a385a411bda8bbd9c574828d3839b4321">MpoTerms::VERB</a></div><div class="ttdeci">DMRG::VERBOSITY::OPTION VERB</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00102">MpoTerms.h:102</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a3daa5410ec1ecda6e1acaecc8042bac7"><div class="ttname"><a href="classMpoTerms.html#a3daa5410ec1ecda6e1acaecc8042bac7">MpoTerms::sum</a></div><div class="ttdeci">static MpoTerms&lt; Symmetry, Scalar &gt; sum(const MpoTerms&lt; Symmetry, Scalar &gt; &amp;top, const MpoTerms&lt; Symmetry, Scalar &gt; &amp;bottom, const double tolerance=::mynumeric_limits&lt; double &gt;::epsilon())</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03665">MpoTerms.h:3666</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a3fa0beed5916fb8a2e89567405f72d92"><div class="ttname"><a href="classMpoTerms.html#a3fa0beed5916fb8a2e89567405f72d92">MpoTerms::push</a></div><div class="ttdeci">virtual void push(const std::size_t loc, const std::vector&lt; OperatorType &gt; &amp;opList, const std::vector&lt; qType &gt; &amp;qList, const Scalar lambda=1.0)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00892">MpoTerms.h:893</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a429582958c5afc31bdd51abac890785c"><div class="ttname"><a href="classMpoTerms.html#a429582958c5afc31bdd51abac890785c">MpoTerms::qAux</a></div><div class="ttdeci">std::vector&lt; Qbasis&lt; Symmetry &gt; &gt; qAux</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00360">MpoTerms.h:360</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a444847ac22aff7cca40686ff04d96160"><div class="ttname"><a href="classMpoTerms.html#a444847ac22aff7cca40686ff04d96160">MpoTerms::memory</a></div><div class="ttdeci">double memory(MEMUNIT memunit=kB) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l04216">MpoTerms.h:4217</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a44602dd987188ff21fedb0031cdfacc2"><div class="ttname"><a href="classMpoTerms.html#a44602dd987188ff21fedb0031cdfacc2">MpoTerms::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00610">MpoTerms.h:610</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a48be912d55d82e2e076d0dfacce41e8a"><div class="ttname"><a href="classMpoTerms.html#a48be912d55d82e2e076d0dfacce41e8a">MpoTerms::qVac</a></div><div class="ttdeci">qType qVac</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00065">MpoTerms.h:65</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a49308f057c4dc419d4c0301be82e5e70"><div class="ttname"><a href="classMpoTerms.html#a49308f057c4dc419d4c0301be82e5e70">MpoTerms::pos_qVac</a></div><div class="ttdeci">std::size_t pos_qVac</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00075">MpoTerms.h:75</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a4c7aa950b1c1be6f9b7db8f933c86c7f"><div class="ttname"><a href="classMpoTerms.html#a4c7aa950b1c1be6f9b7db8f933c86c7f">MpoTerms::GOT_W</a></div><div class="ttdeci">bool GOT_W</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00127">MpoTerms.h:127</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a503fd03635ba7f298c3e5f04a04ee7dd"><div class="ttname"><a href="classMpoTerms.html#a503fd03635ba7f298c3e5f04a04ee7dd">MpoTerms::eliminate_linearlyDependent_rows</a></div><div class="ttdeci">bool eliminate_linearlyDependent_rows(const std::size_t loc, const qType &amp;qIn, const double tolerance)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01592">MpoTerms.h:1593</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a50686e5f9fb163156350c4804cc3f630"><div class="ttname"><a href="classMpoTerms.html#a50686e5f9fb163156350c4804cc3f630">MpoTerms::decrement_first_auxdim_OBC</a></div><div class="ttdeci">void decrement_first_auxdim_OBC(const qType &amp;qIn)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02585">MpoTerms.h:2586</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a528fcd33e93b7ed7e6042ed9f93bd52d"><div class="ttname"><a href="classMpoTerms.html#a528fcd33e93b7ed7e6042ed9f93bd52d">MpoTerms::get_verbosity</a></div><div class="ttdeci">DMRG::VERBOSITY::OPTION get_verbosity() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00693">MpoTerms.h:693</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a52f993c8c9004988c5b50b21955b4d26"><div class="ttname"><a href="classMpoTerms.html#a52f993c8c9004988c5b50b21955b4d26">MpoTerms::status</a></div><div class="ttdeci">MPO_STATUS::OPTION status</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00097">MpoTerms.h:97</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a540eb7909387ae88971a5d0dda1032be"><div class="ttname"><a href="classMpoTerms.html#a540eb7909387ae88971a5d0dda1032be">MpoTerms::add_to_row</a></div><div class="ttdeci">void add_to_row(const std::size_t loc, const qType &amp;qIn, const std::size_t row, const std::map&lt; qType, std::vector&lt; std::map&lt; qType, OperatorType &gt;&gt;&gt; &amp;ops, const Scalar factor)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01911">MpoTerms.h:1912</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a55d4a727504ca0b6304f75b6620d4cdf"><div class="ttname"><a href="classMpoTerms.html#a55d4a727504ca0b6304f75b6620d4cdf">MpoTerms::qOp</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; qType &gt; &gt; qOp</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00354">MpoTerms.h:354</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a55f9d59da99162840fae7c9d8f14e345"><div class="ttname"><a href="classMpoTerms.html#a55f9d59da99162840fae7c9d8f14e345">MpoTerms::setLocBasis</a></div><div class="ttdeci">void setLocBasis(const std::vector&lt; std::vector&lt; qType &gt;&gt; &amp;q)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00715">MpoTerms.h:715</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a5748dfe248c279695d8757de3e789f13"><div class="ttname"><a href="classMpoTerms.html#a5748dfe248c279695d8757de3e789f13">MpoTerms::auxBasis</a></div><div class="ttdeci">const Qbasis&lt; Symmetry &gt; &amp; auxBasis(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00706">MpoTerms.h:706</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a577476278e71c7940de0d52a0f1c3bec"><div class="ttname"><a href="classMpoTerms.html#a577476278e71c7940de0d52a0f1c3bec">MpoTerms::opBasis</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; qType &gt; &gt; &amp; opBasis() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00710">MpoTerms.h:710</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a57f642700bd2019c1af509fb7aa23295"><div class="ttname"><a href="classMpoTerms.html#a57f642700bd2019c1af509fb7aa23295">MpoTerms::auxBasis</a></div><div class="ttdeci">const std::vector&lt; Qbasis&lt; Symmetry &gt; &gt; &amp; auxBasis() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00705">MpoTerms.h:705</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a5859cf057a9ecec4f6a758e6a63d6ee6"><div class="ttname"><a href="classMpoTerms.html#a5859cf057a9ecec4f6a758e6a63d6ee6">MpoTerms::prod_swap_IBC</a></div><div class="ttdeci">static void prod_swap_IBC(std::vector&lt; std::map&lt; std::array&lt; qType, 2 &gt;, std::vector&lt; std::vector&lt; std::map&lt; qType, OperatorType &gt;&gt;&gt;&gt;&gt; &amp;O_out, std::vector&lt; std::size_t &gt; &amp;row_qVac, std::vector&lt; std::size_t &gt; &amp;col_qVac, std::vector&lt; std::size_t &gt; &amp;row_qTot, std::vector&lt; std::size_t &gt; &amp;col_qTot)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03921">MpoTerms.h:3922</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a59899fcbfc527f4491651b5220b59916"><div class="ttname"><a href="classMpoTerms.html#a59899fcbfc527f4491651b5220b59916">MpoTerms::eliminate_linearlyDependent_cols</a></div><div class="ttdeci">bool eliminate_linearlyDependent_cols(const std::size_t loc, const qType &amp;qOut, const double tolerance)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01751">MpoTerms.h:1752</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a5a81f45495e41845da352d1985f05400"><div class="ttname"><a href="classMpoTerms.html#a5a81f45495e41845da352d1985f05400">MpoTerms::calc_qAux</a></div><div class="ttdeci">void calc_qAux()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01264">MpoTerms.h:1265</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a5c4107fa9c652e41ba014d2f7b8c9f04"><div class="ttname"><a href="classMpoTerms.html#a5c4107fa9c652e41ba014d2f7b8c9f04">MpoTerms::compress</a></div><div class="ttdeci">void compress(const double tolerance)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01437">MpoTerms.h:1438</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a5d2fc99aa633ae6ae176d8ea01eadaac"><div class="ttname"><a href="classMpoTerms.html#a5d2fc99aa633ae6ae176d8ea01eadaac">MpoTerms::setQtarget</a></div><div class="ttdeci">void setQtarget(const qType &amp;q)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00725">MpoTerms.h:725</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a5def179250b990da0d480300e771571e"><div class="ttname"><a href="classMpoTerms.html#a5def179250b990da0d480300e771571e">MpoTerms::cast</a></div><div class="ttdeci">MpoTerms&lt; Symmetry, OtherScalar &gt; cast()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03075">MpoTerms.h:3076</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a645187bf0bc3264e628ce5cc91c010bc"><div class="ttname"><a href="classMpoTerms.html#a645187bf0bc3264e628ce5cc91c010bc">MpoTerms::get_W</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &gt; &gt; &gt; &amp; get_W() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00531">MpoTerms.h:531</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a651fdcd8a197db16ef17c0908e43de0a"><div class="ttname"><a href="classMpoTerms.html#a651fdcd8a197db16ef17c0908e43de0a">MpoTerms::push</a></div><div class="ttdeci">void push(const std::size_t loc, const std::vector&lt; OperatorType &gt; &amp;opList, const Scalar lambda=1.0)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00455">MpoTerms.h:455</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a666f0aa6a2f44a1343f3ab2311f752e0"><div class="ttname"><a href="classMpoTerms.html#a666f0aa6a2f44a1343f3ab2311f752e0">MpoTerms::pos_qTot</a></div><div class="ttdeci">std::size_t pos_qTot</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00070">MpoTerms.h:70</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a667998716a1b7e21e0234d4fde7157cc"><div class="ttname"><a href="classMpoTerms.html#a667998716a1b7e21e0234d4fde7157cc">MpoTerms::qOp_powers</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; qType &gt; &gt; &gt; qOp_powers</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00378">MpoTerms.h:378</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a6b5bb8791d64458c41be2650e28a5e3f"><div class="ttname"><a href="classMpoTerms.html#a6b5bb8791d64458c41be2650e28a5e3f">MpoTerms::calc_TwoSiteData</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TwoSiteData&lt; Symmetry, Scalar &gt; &gt; &gt; calc_TwoSiteData() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03195">MpoTerms.h:3196</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a6c56def08f549bc74c30cdbe0a6402f4"><div class="ttname"><a href="classMpoTerms.html#a6c56def08f549bc74c30cdbe0a6402f4">MpoTerms::Qtarget</a></div><div class="ttdeci">const qType &amp; Qtarget() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00713">MpoTerms.h:713</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a6cde3a3f485a4f4300c7b54b6674efc4"><div class="ttname"><a href="classMpoTerms.html#a6cde3a3f485a4f4300c7b54b6674efc4">MpoTerms::clear_opLabels</a></div><div class="ttdeci">void clear_opLabels()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l04165">MpoTerms.h:4166</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a72acc8fe854f6a6d3c07c0ca5cd954d1"><div class="ttname"><a href="classMpoTerms.html#a72acc8fe854f6a6d3c07c0ca5cd954d1">MpoTerms::auxdim</a></div><div class="ttdeci">std::vector&lt; std::map&lt; qType, std::size_t &gt; &gt; auxdim</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00055">MpoTerms.h:55</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a7732332da5839d9c1aa15d02f436c1d8"><div class="ttname"><a href="classMpoTerms.html#a7732332da5839d9c1aa15d02f436c1d8">MpoTerms::calc</a></div><div class="ttdeci">void calc(const std::size_t power)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01134">MpoTerms.h:1135</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a794ee8e64c1f477b6e8768b55fdbdf98"><div class="ttname"><a href="classMpoTerms.html#a794ee8e64c1f477b6e8768b55fdbdf98">MpoTerms::W</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &gt; &gt; &gt; W</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00372">MpoTerms.h:372</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a7a0082821841c3ced7eb87042e34b8a2"><div class="ttname"><a href="classMpoTerms.html#a7a0082821841c3ced7eb87042e34b8a2">MpoTerms::inBasis</a></div><div class="ttdeci">const Qbasis&lt; Symmetry &gt; &amp; inBasis(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00707">MpoTerms.h:707</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a7c33ddf3be037c23bfec8176ab739c58"><div class="ttname"><a href="classMpoTerms.html#a7c33ddf3be037c23bfec8176ab739c58">MpoTerms::set_qPhys</a></div><div class="ttdeci">void set_qPhys(const std::size_t loc, const std::vector&lt; qType &gt; &amp;qPhys_in)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00500">MpoTerms.h:500</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a80e4efbe7d2892340b6531e508a34bc0"><div class="ttname"><a href="classMpoTerms.html#a80e4efbe7d2892340b6531e508a34bc0">MpoTerms::current_power</a></div><div class="ttdeci">std::size_t current_power</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00112">MpoTerms.h:112</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a81f461a56543a78c0a8f03fcca9b5de9"><div class="ttname"><a href="classMpoTerms.html#a81f461a56543a78c0a8f03fcca9b5de9">MpoTerms::decrement_last_auxdim_OBC</a></div><div class="ttdeci">void decrement_last_auxdim_OBC(const qType &amp;qOut)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02642">MpoTerms.h:2643</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a82c026d1a3a6c4e42e59320a76bb9f44"><div class="ttname"><a href="classMpoTerms.html#a82c026d1a3a6c4e42e59320a76bb9f44">MpoTerms::get_W_power</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &gt; &gt; &gt; &amp; get_W_power(std::size_t power) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02796">MpoTerms.h:2797</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a833ba2c8a6a46bb177a72a2a9e828efc"><div class="ttname"><a href="classMpoTerms.html#a833ba2c8a6a46bb177a72a2a9e828efc">MpoTerms::detect_and_remove_power</a></div><div class="ttdeci">static std::pair&lt; std::string, std::size_t &gt; detect_and_remove_power(const std::string &amp;name_w_power)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03616">MpoTerms.h:3617</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a85aacd1b959b22425cc05989adabcd9a"><div class="ttname"><a href="classMpoTerms.html#a85aacd1b959b22425cc05989adabcd9a">MpoTerms::get_name</a></div><div class="ttdeci">const std::string get_name() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00476">MpoTerms.h:476</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a86c195dde004a0acd459408dbac1d64f"><div class="ttname"><a href="classMpoTerms.html#a86c195dde004a0acd459408dbac1d64f">MpoTerms::power_to_string</a></div><div class="ttdeci">static std::string power_to_string(std::size_t power)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03647">MpoTerms.h:3648</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a895a038b7849a71e8b067a1405c8d83b"><div class="ttname"><a href="classMpoTerms.html#a895a038b7849a71e8b067a1405c8d83b">MpoTerms::initialize</a></div><div class="ttdeci">void initialize(const std::size_t L, const BC boundary_condition_in, const qType &amp;qTot_in)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00801">MpoTerms.h:802</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a89d4a7d72e78c0e62b2c26fc154b91eb"><div class="ttname"><a href="classMpoTerms.html#a89d4a7d72e78c0e62b2c26fc154b91eb">MpoTerms::get_qOp_power</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; qType &gt; &gt; &amp; get_qOp_power(std::size_t power) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02827">MpoTerms.h:2828</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a8b4e0db8ee01609d13a7e1666fc7bcfa"><div class="ttname"><a href="classMpoTerms.html#a8b4e0db8ee01609d13a7e1666fc7bcfa">MpoTerms::qAux_powers</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Qbasis&lt; Symmetry &gt; &gt; &gt; qAux_powers</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00384">MpoTerms.h:384</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a8b7aab9c8f59a6e6c9144e41e89da921"><div class="ttname"><a href="classMpoTerms.html#a8b7aab9c8f59a6e6c9144e41e89da921">MpoTerms::prod_delZeroCols_OBC</a></div><div class="ttdeci">static void prod_delZeroCols_OBC(std::map&lt; std::array&lt; qType, 2 &gt;, std::vector&lt; std::vector&lt; std::map&lt; qType, OperatorType &gt;&gt;&gt;&gt; &amp;O_last, Qbasis&lt; Symmetry &gt; &amp;qAux_last, Qbasis&lt; Symmetry &gt; &amp;qAux_prev, const qType &amp;qTot, const std::size_t col_qTot)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03895">MpoTerms.h:3896</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a8fb6d1b6202c928edf48a9c507334c68"><div class="ttname"><a href="classMpoTerms.html#a8fb6d1b6202c928edf48a9c507334c68">MpoTerms::transform_base</a></div><div class="ttdeci">void transform_base(const qType &amp;qShift, const bool PRINT=false, const int factor=-1, const std::size_t powre=0ul)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03112">MpoTerms.h:3113</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a911e788216f70effdc742fedf110fbb8"><div class="ttname"><a href="classMpoTerms.html#a911e788216f70effdc742fedf110fbb8">MpoTerms::Wsq_at</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; std::vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &gt; &gt; &amp; Wsq_at(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00718">MpoTerms.h:718</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a941abe425b94a71a86790f00d0809256"><div class="ttname"><a href="classMpoTerms.html#a941abe425b94a71a86790f00d0809256">MpoTerms::get_boundary_condition</a></div><div class="ttdeci">BC get_boundary_condition() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00574">MpoTerms.h:574</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a944d0323c6ad445cdf217445b86a9216"><div class="ttname"><a href="classMpoTerms.html#a944d0323c6ad445cdf217445b86a9216">MpoTerms::get_auxdim</a></div><div class="ttdeci">std::size_t get_auxdim(const std::size_t loc, const qType &amp;q) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02704">MpoTerms.h:2705</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_a9807df589a9e1d516e51af88fd25c2e5"><div class="ttname"><a href="classMpoTerms.html#a9807df589a9e1d516e51af88fd25c2e5">MpoTerms::load</a></div><div class="ttdeci">void load(std::string filename)</div></div>
<div class="ttc" id="aclassMpoTerms_html_a98dba4d651c5b97ef847e185b80ff6b1"><div class="ttname"><a href="classMpoTerms.html#a98dba4d651c5b97ef847e185b80ff6b1">MpoTerms::delete_row</a></div><div class="ttdeci">std::map&lt; qType, std::vector&lt; std::map&lt; qType, OperatorType &gt; &gt; &gt; delete_row(const std::size_t loc, const qType &amp;qIn, const std::size_t row_to_delete, const bool SAMESITE)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01989">MpoTerms.h:1990</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aa59b26f9503f57f2301d553890408bba"><div class="ttname"><a href="classMpoTerms.html#aa59b26f9503f57f2301d553890408bba">MpoTerms::opBasisSq</a></div><div class="ttdeci">const std::vector&lt; qType &gt; &amp; opBasisSq(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00719">MpoTerms.h:719</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aa5bc766ce63a2bb0d672ccaf189970a1"><div class="ttname"><a href="classMpoTerms.html#aa5bc766ce63a2bb0d672ccaf189970a1">MpoTerms::calc_qOp</a></div><div class="ttdeci">void calc_qOp()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01235">MpoTerms.h:1236</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aa68f98dab48c889cdb823956f77b6805"><div class="ttname"><a href="classMpoTerms.html#aa68f98dab48c889cdb823956f77b6805">MpoTerms::is_finalized</a></div><div class="ttdeci">bool is_finalized() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00521">MpoTerms.h:521</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aa82d1c4d3b8494ccbc28dcd89c730aeb"><div class="ttname"><a href="classMpoTerms.html#aa82d1c4d3b8494ccbc28dcd89c730aeb">MpoTerms::W_at</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; std::vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &gt; &gt; &amp; W_at(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00699">MpoTerms.h:699</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aaa75b0496265c0f41405a8656ca10d8c"><div class="ttname"><a href="classMpoTerms.html#aaa75b0496265c0f41405a8656ca10d8c">MpoTerms::get_qVac</a></div><div class="ttdeci">const qType &amp; get_qVac() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00579">MpoTerms.h:579</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aaf0099f6c77d8937a59e264b1fde3d8c"><div class="ttname"><a href="classMpoTerms.html#aaf0099f6c77d8937a59e264b1fde3d8c">MpoTerms::set_name</a></div><div class="ttdeci">void set_name(const std::string &amp;label_in)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00471">MpoTerms.h:471</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ab0190ae4ed852060d798cad92fa5d9df"><div class="ttname"><a href="classMpoTerms.html#ab0190ae4ed852060d798cad92fa5d9df">MpoTerms::check_power</a></div><div class="ttdeci">bool check_power(std::size_t power) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00600">MpoTerms.h:600</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ab272bda05dff2faf3fe1be9a276eefd3"><div class="ttname"><a href="classMpoTerms.html#ab272bda05dff2faf3fe1be9a276eefd3">MpoTerms::before_verb_set</a></div><div class="ttdeci">std::string before_verb_set</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00107">MpoTerms.h:107</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ab2cbbcb24ec78394626aeb1a5e38e466"><div class="ttname"><a href="classMpoTerms.html#ab2cbbcb24ec78394626aeb1a5e38e466">MpoTerms::get_qPhys</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; qType &gt; &gt; &amp; get_qPhys() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00546">MpoTerms.h:546</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ab35260ea2a95a6b9f48c47b89bb65aaa"><div class="ttname"><a href="classMpoTerms.html#ab35260ea2a95a6b9f48c47b89bb65aaa">MpoTerms::qType</a></div><div class="ttdeci">Symmetry::qType qType</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00038">MpoTerms.h:38</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ab7be76c72cfd76e91404ffd0b0563a76"><div class="ttname"><a href="classMpoTerms.html#ab7be76c72cfd76e91404ffd0b0563a76">MpoTerms::MatrixType</a></div><div class="ttdeci">Eigen::SparseMatrix&lt; Scalar, Eigen::ColMajor, EIGEN_DEFAULT_SPARSE_INDEX_TYPE &gt; MatrixType</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00039">MpoTerms.h:39</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ab86cc4389a72e7493e9c97a3099a105a"><div class="ttname"><a href="classMpoTerms.html#ab86cc4389a72e7493e9c97a3099a105a">MpoTerms::maxPower</a></div><div class="ttdeci">std::size_t maxPower() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00605">MpoTerms.h:605</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aba05431e89e486dbc4c57592ed0bc715"><div class="ttname"><a href="classMpoTerms.html#aba05431e89e486dbc4c57592ed0bc715">MpoTerms::set_Identity</a></div><div class="ttdeci">void set_Identity(const typename Symmetry::qType &amp;Q=Symmetry::qvacuum())</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l03999">MpoTerms.h:4000</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_abb789c2353b3afb0bc86c9c84a7580e3"><div class="ttname"><a href="classMpoTerms.html#abb789c2353b3afb0bc86c9c84a7580e3">MpoTerms::GOT_QAUX</a></div><div class="ttdeci">bool GOT_QAUX</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00122">MpoTerms.h:122</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ac5809d1b22b1f8f5ad1e222a80de9cdb"><div class="ttname"><a href="classMpoTerms.html#ac5809d1b22b1f8f5ad1e222a80de9cdb">MpoTerms::opBasis</a></div><div class="ttdeci">const std::vector&lt; qType &gt; &amp; opBasis(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00711">MpoTerms.h:711</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ac77ed69cd6d0b71193358faba4ce23e9"><div class="ttname"><a href="classMpoTerms.html#ac77ed69cd6d0b71193358faba4ce23e9">MpoTerms::increment_last_auxdim_OBC</a></div><div class="ttdeci">void increment_last_auxdim_OBC(const qType &amp;qOut)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02362">MpoTerms.h:2363</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ac7a18a0e931b11eb5bd258665a1dc29a"><div class="ttname"><a href="classMpoTerms.html#ac7a18a0e931b11eb5bd258665a1dc29a">MpoTerms::base_order_IBC</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; qType, std::size_t &gt; &gt; base_order_IBC(const std::size_t power=1) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l04053">MpoTerms.h:4054</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_acb033ecc518224cc12a53b9db315a823"><div class="ttname"><a href="classMpoTerms.html#acb033ecc518224cc12a53b9db315a823">MpoTerms::OperatorType</a></div><div class="ttdeci">SiteOperator&lt; Symmetry, Scalar &gt; OperatorType</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00037">MpoTerms.h:37</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_acd023265ae6218668c30d75e6ba2cdc3"><div class="ttname"><a href="classMpoTerms.html#acd023265ae6218668c30d75e6ba2cdc3">MpoTerms::auxdim_infos</a></div><div class="ttdeci">std::tuple&lt; std::size_t, std::size_t, std::size_t, std::size_t &gt; auxdim_infos() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l04186">MpoTerms.h:4187</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aceccbf3195f9b4298c0b02ab4ca7e73d"><div class="ttname"><a href="classMpoTerms.html#aceccbf3195f9b4298c0b02ab4ca7e73d">MpoTerms::reversed</a></div><div class="ttdeci">reversedData reversed</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00409">MpoTerms.h:409</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_acee3fb16d4a6c8fbf825221c6d049c08"><div class="ttname"><a href="classMpoTerms.html#acee3fb16d4a6c8fbf825221c6d049c08">MpoTerms::calc_qList</a></div><div class="ttdeci">std::vector&lt; qType &gt; calc_qList(const std::vector&lt; OperatorType &gt; &amp;opList)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00961">MpoTerms.h:962</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_acf9fa7121f8720860d44179a898be76d"><div class="ttname"><a href="classMpoTerms.html#acf9fa7121f8720860d44179a898be76d">MpoTerms::increment_auxdim</a></div><div class="ttdeci">void increment_auxdim(const std::size_t loc, const qType &amp;q)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02105">MpoTerms.h:2106</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ad4af68f18ba1cd31be54f7a456c78286"><div class="ttname"><a href="classMpoTerms.html#ad4af68f18ba1cd31be54f7a456c78286">MpoTerms::increment_first_auxdim_OBC</a></div><div class="ttdeci">void increment_first_auxdim_OBC(const qType &amp;qIn)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02302">MpoTerms.h:2303</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ada00ad294f429b62b093ea45c6ea62d2"><div class="ttname"><a href="classMpoTerms.html#ada00ad294f429b62b093ea45c6ea62d2">MpoTerms::add</a></div><div class="ttdeci">void add(const std::size_t loc, const OperatorType &amp;op, const qType &amp;qIn, const qType &amp;qOut, const std::size_t IndexIn, const std::size_t IndexOut)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02073">MpoTerms.h:2074</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ada165954c8f586180a7e259d9cf535b3"><div class="ttname"><a href="classMpoTerms.html#ada165954c8f586180a7e259d9cf535b3">MpoTerms::reconstruct</a></div><div class="ttdeci">void reconstruct(const std::vector&lt; std::map&lt; std::array&lt; qType, 2 &gt;, std::vector&lt; std::vector&lt; std::map&lt; qType, OperatorType &gt;&gt;&gt;&gt;&gt; &amp;O_in, const std::vector&lt; Qbasis&lt; Symmetry &gt;&gt; &amp;qAux_in, const std::vector&lt; std::vector&lt; qType &gt;&gt; &amp;qPhys_in, const bool FINALIZED_IN, const BC boundary_condition_in, const qType &amp;qTot_in=Symmetry::qvacuum())</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00810">MpoTerms.h:811</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_adb2a09be541f434ab3cb0f2d64f5efc0"><div class="ttname"><a href="classMpoTerms.html#adb2a09be541f434ab3cb0f2d64f5efc0">MpoTerms::save_label</a></div><div class="ttdeci">void save_label(const std::size_t loc, const std::string &amp;info_label)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02744">MpoTerms.h:2745</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_add854992d23948930619568033a7c150"><div class="ttname"><a href="classMpoTerms.html#add854992d23948930619568033a7c150">MpoTerms::W_powers</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &gt; &gt; &gt; &gt; W_powers</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00390">MpoTerms.h:390</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ae07da19132e5cd2a583ecd43f6e3457a"><div class="ttname"><a href="classMpoTerms.html#ae07da19132e5cd2a583ecd43f6e3457a">MpoTerms::setLocBasis</a></div><div class="ttdeci">void setLocBasis(const std::vector&lt; qType &gt; &amp;q, std::size_t loc)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00716">MpoTerms.h:716</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ae0c7cb90f5804956acaccbca94be1085"><div class="ttname"><a href="classMpoTerms.html#ae0c7cb90f5804956acaccbca94be1085">MpoTerms::initialize</a></div><div class="ttdeci">void initialize()</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00741">MpoTerms.h:742</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ae2eabda65dd0f8e96246cad195349c45"><div class="ttname"><a href="classMpoTerms.html#ae2eabda65dd0f8e96246cad195349c45">MpoTerms::delete_col</a></div><div class="ttdeci">std::map&lt; qType, std::vector&lt; std::map&lt; qType, OperatorType &gt; &gt; &gt; delete_col(const std::size_t loc, const qType &amp;qOut, const std::size_t col_to_delete, const bool SAMESITE)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l02031">MpoTerms.h:2032</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ae9d45842873eed41211b64c2ed1fe192"><div class="ttname"><a href="classMpoTerms.html#ae9d45842873eed41211b64c2ed1fe192">MpoTerms::qTot</a></div><div class="ttdeci">qType qTot</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00060">MpoTerms.h:60</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_ae9eb311478eea71a8163422cbf581f56"><div class="ttname"><a href="classMpoTerms.html#ae9eb311478eea71a8163422cbf581f56">MpoTerms::get_qTot</a></div><div class="ttdeci">const qType &amp; get_qTot() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00584">MpoTerms.h:584</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aed405248ce8b76b63451b039f9d812c7"><div class="ttname"><a href="classMpoTerms.html#aed405248ce8b76b63451b039f9d812c7">MpoTerms::boundary_condition</a></div><div class="ttdeci">BC boundary_condition</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00080">MpoTerms.h:80</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_af017aefebdff6bd775d6f12109233144"><div class="ttname"><a href="classMpoTerms.html#af017aefebdff6bd775d6f12109233144">MpoTerms::add_to_col</a></div><div class="ttdeci">void add_to_col(const std::size_t loc, const qType &amp;qOut, const std::size_t col, const std::map&lt; qType, std::vector&lt; std::map&lt; qType, OperatorType &gt;&gt;&gt; &amp;ops, const Scalar factor)</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l01950">MpoTerms.h:1951</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_af0b4b67186dc1b45be38db47d61c5160"><div class="ttname"><a href="classMpoTerms.html#af0b4b67186dc1b45be38db47d61c5160">MpoTerms::opBasisSq</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; qType &gt; &gt; &amp; opBasisSq() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00720">MpoTerms.h:720</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_af455c480190a643faa584ad8509452e0"><div class="ttname"><a href="classMpoTerms.html#af455c480190a643faa584ad8509452e0">MpoTerms::label</a></div><div class="ttdeci">std::string label</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00615">MpoTerms.h:615</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_af9467e059bedd0b94cf403dc7aaf9ee2"><div class="ttname"><a href="classMpoTerms.html#af9467e059bedd0b94cf403dc7aaf9ee2">MpoTerms::get_qAux</a></div><div class="ttdeci">const std::vector&lt; Qbasis&lt; Symmetry &gt; &gt; &amp; get_qAux() const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00536">MpoTerms.h:536</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_afb40c100052ed367f53ac2d5b5cf13c5"><div class="ttname"><a href="classMpoTerms.html#afb40c100052ed367f53ac2d5b5cf13c5">MpoTerms::get_hilbert_dimension</a></div><div class="ttdeci">std::size_t get_hilbert_dimension(const std::size_t loc) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00569">MpoTerms.h:569</a></div></div>
<div class="ttc" id="aclassMpoTerms_html_aff82dccf68884809ab15105b8a835f00"><div class="ttname"><a href="classMpoTerms.html#aff82dccf68884809ab15105b8a835f00">MpoTerms::sparsity</a></div><div class="ttdeci">double sparsity(const std::size_t power=1, const bool PER_MATRIX=false) const</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l04341">MpoTerms.h:4342</a></div></div>
<div class="ttc" id="aclassQbasis_html"><div class="ttname"><a href="classQbasis.html">Qbasis</a></div><div class="ttdef"><b>Definition:</b> <a href="Qbasis_8h_source.html#l00023">Qbasis.h:21</a></div></div>
<div class="ttc" id="aclassQbasis_html_a08aa1430102e29bfdab544222a768043"><div class="ttname"><a href="classQbasis.html#a08aa1430102e29bfdab544222a768043">Qbasis::push_back</a></div><div class="ttdeci">void push_back(const std::tuple&lt; qType, Eigen::Index, std::vector&lt; std::string &gt; &gt; &amp;state)</div><div class="ttdef"><b>Definition:</b> <a href="Qbasis_8h_source.html#l00213">Qbasis.h:214</a></div></div>
<div class="ttc" id="aclassQbasis_html_a5b08b155c5907090ed8174785a650c6e"><div class="ttname"><a href="classQbasis.html#a5b08b155c5907090ed8174785a650c6e">Qbasis::inner_num</a></div><div class="ttdeci">Eigen::Index inner_num(const Eigen::Index &amp;outer_num) const</div><div class="ttdef"><b>Definition:</b> <a href="Qbasis_8h_source.html#l00334">Qbasis.h:335</a></div></div>
<div class="ttc" id="aclassQbasis_html_a641b3c1198713e784d80894d7d988bb9"><div class="ttname"><a href="classQbasis.html#a641b3c1198713e784d80894d7d988bb9">Qbasis::combine</a></div><div class="ttdeci">Qbasis&lt; Symmetry &gt; combine(const Qbasis&lt; Symmetry &gt; &amp;other, bool FLIP=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Qbasis_8h_source.html#l00685">Qbasis.h:686</a></div></div>
<div class="ttc" id="aclassQbasis_html_a6facb7c84d9574dded4d3fcb0cd11eba"><div class="ttname"><a href="classQbasis.html#a6facb7c84d9574dded4d3fcb0cd11eba">Qbasis::leftOffset</a></div><div class="ttdeci">Eigen::Index leftOffset(const qType &amp;qnew, const std::array&lt; qType, 2 &gt; &amp;qold, const std::array&lt; Eigen::Index, 2 &gt; &amp;plain_old) const</div><div class="ttdef"><b>Definition:</b> <a href="Qbasis_8h_source.html#l00439">Qbasis.h:440</a></div></div>
<div class="ttc" id="aclassQbasis_html_a73c16f8f52623975bcf7340ecaa44d9d"><div class="ttname"><a href="classQbasis.html#a73c16f8f52623975bcf7340ecaa44d9d">Qbasis::pullData</a></div><div class="ttdeci">void pullData(const vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &amp;A, const Eigen::Index &amp;leg)</div><div class="ttdef"><b>Definition:</b> <a href="Qbasis_8h_source.html#l00485">Qbasis.h:486</a></div></div>
<div class="ttc" id="aclassQbasis_html_af737d717c947bb79f4540bb0a07e3851"><div class="ttname"><a href="classQbasis.html#af737d717c947bb79f4540bb0a07e3851">Qbasis::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="Qbasis_8h_source.html#l00147">Qbasis.h:147</a></div></div>
<div class="ttc" id="aclassQbasis_html_afd17e65eb19e217c14ec7adff1ea3405"><div class="ttname"><a href="classQbasis.html#afd17e65eb19e217c14ec7adff1ea3405">Qbasis::outer_num</a></div><div class="ttdeci">Eigen::Index outer_num(const qType &amp;q) const</div><div class="ttdef"><b>Definition:</b> <a href="Qbasis_8h_source.html#l00377">Qbasis.h:378</a></div></div>
<div class="ttc" id="anamespaceMPO__STATUS_html"><div class="ttname"><a href="namespaceMPO__STATUS.html">MPO_STATUS</a></div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00029">MpoTerms.h:30</a></div></div>
<div class="ttc" id="anamespaceMPO__STATUS_html_aa8595aad4ea519984f260f1ff58b5c1a"><div class="ttname"><a href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1a">MPO_STATUS::OPTION</a></div><div class="ttdeci">OPTION</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00031">MpoTerms.h:31</a></div></div>
<div class="ttc" id="anamespaceMPO__STATUS_html_aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5"><div class="ttname"><a href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aa75dda7c7019fc9e5c14a804d10a19bc5">MPO_STATUS::ALTERABLE</a></div><div class="ttdeci">@ ALTERABLE</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00031">MpoTerms.h:31</a></div></div>
<div class="ttc" id="anamespaceMPO__STATUS_html_aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583"><div class="ttname"><a href="namespaceMPO__STATUS.html#aa8595aad4ea519984f260f1ff58b5c1aad7c1b6be6bad943af5d2086a74e36583">MPO_STATUS::FINALIZED</a></div><div class="ttdeci">@ FINALIZED</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00031">MpoTerms.h:31</a></div></div>
<div class="ttc" id="anamespacePROP_html_a0b137b212cc14cfd6de6339c67ff4df6"><div class="ttname"><a href="namespacePROP.html#a0b137b212cc14cfd6de6339c67ff4df6">PROP::COMPRESS</a></div><div class="ttdeci">const bool COMPRESS</div><div class="ttdef"><b>Definition:</b> <a href="DmrgTypedefs_8h_source.html#l00499">DmrgTypedefs.h:499</a></div></div>
<div class="ttc" id="anamespaceSym_html_a359c8465d27b791d515bfbc2554ec963a1e979858f0a754fa28202934a5e6787d"><div class="ttname"><a href="namespaceSym.html#a359c8465d27b791d515bfbc2554ec963a1e979858f0a754fa28202934a5e6787d">Sym::S</a></div><div class="ttdeci">@ S</div><div class="ttdef"><b>Definition:</b> <a href="DmrgTypedefs_8h_source.html#l00110">DmrgTypedefs.h:110</a></div></div>
<div class="ttc" id="anamespaceSym_html_a359c8465d27b791d515bfbc2554ec963a711a78bef49adbb12d22ff554c97ab79"><div class="ttname"><a href="namespaceSym.html#a359c8465d27b791d515bfbc2554ec963a711a78bef49adbb12d22ff554c97ab79">Sym::T</a></div><div class="ttdeci">@ T</div><div class="ttdef"><b>Definition:</b> <a href="DmrgTypedefs_8h_source.html#l00110">DmrgTypedefs.h:110</a></div></div>
<div class="ttc" id="anamespaceSym_html_abcb3d8e8d7c7b79db78814d5b71d6163"><div class="ttname"><a href="namespaceSym.html#abcb3d8e8d7c7b79db78814d5b71d6163">Sym::initialize</a></div><div class="ttdeci">void initialize(int maxJ=1, std::string f_3j=&quot;&quot;, std::string f_6j=&quot;&quot;, std::string f_9j=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="functions_8h_source.html#l00110">functions.h:110</a></div></div>
<div class="ttc" id="aqarray_8h_html"><div class="ttname"><a href="qarray_8h.html">qarray.h</a></div></div>
<div class="ttc" id="astructBiped_html"><div class="ttname"><a href="structBiped.html">Biped&lt; Symmetry, MatrixType &gt;</a></div></div>
<div class="ttc" id="astructBiped_html_a21a7e07b013de243c92ba88c20879336"><div class="ttname"><a href="structBiped.html#a21a7e07b013de243c92ba88c20879336">Biped::block</a></div><div class="ttdeci">std::vector&lt; MatrixType_ &gt; block</div><div class="ttdef"><b>Definition:</b> <a href="Biped_8h_source.html#l00096">Biped.h:96</a></div></div>
<div class="ttc" id="astructBiped_html_a41624c550f8f19cb4ac1e07474dd04c3"><div class="ttname"><a href="structBiped.html#a41624c550f8f19cb4ac1e07474dd04c3">Biped::in</a></div><div class="ttdeci">std::vector&lt; qType &gt; in</div><div class="ttdef"><b>Definition:</b> <a href="Biped_8h_source.html#l00087">Biped.h:87</a></div></div>
<div class="ttc" id="astructBiped_html_a65bd241c1bb94f08f116f2975c8c891e"><div class="ttname"><a href="structBiped.html#a65bd241c1bb94f08f116f2975c8c891e">Biped::push_back</a></div><div class="ttdeci">void push_back(qType qin, qType qout, const MatrixType_ &amp;M)</div><div class="ttdef"><b>Definition:</b> <a href="Biped_8h_source.html#l00528">Biped.h:529</a></div></div>
<div class="ttc" id="astructBiped_html_ae14468a902960038b011cf7969170c6a"><div class="ttname"><a href="structBiped.html#ae14468a902960038b011cf7969170c6a">Biped::dim</a></div><div class="ttdeci">std::size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="Biped_8h_source.html#l00082">Biped.h:82</a></div></div>
<div class="ttc" id="astructBiped_html_aeac8db26eb6318041ee03501f6e2c8db"><div class="ttname"><a href="structBiped.html#aeac8db26eb6318041ee03501f6e2c8db">Biped::out</a></div><div class="ttdeci">std::vector&lt; qType &gt; out</div><div class="ttdef"><b>Definition:</b> <a href="Biped_8h_source.html#l00090">Biped.h:90</a></div></div>
<div class="ttc" id="astructDMRG_1_1VERBOSITY_html_ac5c659e3de4b1d140c663929f46474ba"><div class="ttname"><a href="structDMRG_1_1VERBOSITY.html#ac5c659e3de4b1d140c663929f46474ba">DMRG::VERBOSITY::OPTION</a></div><div class="ttdeci">OPTION</div><div class="ttdef"><b>Definition:</b> <a href="DmrgTypedefs_8h_source.html#l00276">DmrgTypedefs.h:277</a></div></div>
<div class="ttc" id="astructMpoTerms_1_1reversedData_html"><div class="ttname"><a href="structMpoTerms_1_1reversedData.html">MpoTerms::reversedData</a></div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00402">MpoTerms.h:403</a></div></div>
<div class="ttc" id="astructMpoTerms_1_1reversedData_html_a1c688e402d0fdca9d3e3773fac34c113"><div class="ttname"><a href="structMpoTerms_1_1reversedData.html#a1c688e402d0fdca9d3e3773fac34c113">MpoTerms::reversedData::SET</a></div><div class="ttdeci">bool SET</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00406">MpoTerms.h:406</a></div></div>
<div class="ttc" id="astructMpoTerms_1_1reversedData_html_a9fa81f6dfa8a350b62cccf5931dcd403"><div class="ttname"><a href="structMpoTerms_1_1reversedData.html#a9fa81f6dfa8a350b62cccf5931dcd403">MpoTerms::reversedData::qAux</a></div><div class="ttdeci">std::vector&lt; Qbasis&lt; Symmetry &gt; &gt; qAux</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00405">MpoTerms.h:405</a></div></div>
<div class="ttc" id="astructMpoTerms_1_1reversedData_html_ac45b5a25c9d0ed175fb16c941fc49cd2"><div class="ttname"><a href="structMpoTerms_1_1reversedData.html#ac45b5a25c9d0ed175fb16c941fc49cd2">MpoTerms::reversedData::W</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; Biped&lt; Symmetry, MatrixType &gt; &gt; &gt; &gt; &gt; W</div><div class="ttdef"><b>Definition:</b> <a href="MpoTerms_8h_source.html#l00404">MpoTerms.h:404</a></div></div>
<div class="ttc" id="astructSiteOperator_html"><div class="ttname"><a href="structSiteOperator.html">SiteOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="SiteOperator_8h_source.html#l00031">SiteOperator.h:32</a></div></div>
<div class="ttc" id="astructSiteOperator_html_a5975883be6a205e7b60a72725673410a"><div class="ttname"><a href="structSiteOperator.html#a5975883be6a205e7b60a72725673410a">SiteOperator::label</a></div><div class="ttdeci">std::string label</div><div class="ttdef"><b>Definition:</b> <a href="SiteOperator_8h_source.html#l00071">SiteOperator.h:71</a></div></div>
<div class="ttc" id="astructSiteOperator_html_a6962e076ba06175feddb70b701719ba4"><div class="ttname"><a href="structSiteOperator.html#a6962e076ba06175feddb70b701719ba4">SiteOperator::data</a></div><div class="ttdeci">Eigen::SparseMatrix&lt; Scalar_ &gt; data</div><div class="ttdef"><b>Definition:</b> <a href="SiteOperator_8h_source.html#l00041">SiteOperator.h:41</a></div></div>
<div class="ttc" id="astructSiteOperator_html_a8e83604df485e170d2c7a01d7fc3229f"><div class="ttname"><a href="structSiteOperator.html#a8e83604df485e170d2c7a01d7fc3229f">SiteOperator::Q</a></div><div class="ttdeci">Symmetry::qType Q</div><div class="ttdef"><b>Definition:</b> <a href="SiteOperator_8h_source.html#l00040">SiteOperator.h:40</a></div></div>
<div class="ttc" id="astructTwoSiteData_html"><div class="ttname"><a href="structTwoSiteData.html">TwoSiteData</a></div><div class="ttdef"><b>Definition:</b> <a href="DmrgTypedefs_8h_source.html#l00474">DmrgTypedefs.h:475</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="MpoTerms_8h.html">MpoTerms.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
<script type="text/javascript">
  // script for doxygen 1.9.2
  $(function() {
      toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
      toggleButton.title = "Toggle Light/Dark Mode"
      $(document).ready(function(){
          document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
      })
      $(window).resize(function(){
          document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
      })
  })
</script>
</body>
</html>
